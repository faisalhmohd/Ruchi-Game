var cr={};cr.plugins_={},cr.behaviors={},"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(t){return t.__proto__}:function(t){return t.constructor.prototype}),function(){function t(t,e){this.x=t,this.y=e,cr.seal(this)}function e(t,e,i,s){this.set(t,e,i,s),cr.seal(this)}function i(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,cr.seal(this)}function s(t,e,i,s){e>t?s>i?(p=i>t?t:i,d=e>s?e:s):(p=s>t?t:s,d=e>i?e:i):s>i?(p=i>e?e:i,d=t>s?t:s):(p=s>e?e:s,d=t>i?t:i)}function n(){this.s=null,this.items=null,this.item_count=0,v&&(this.s=new Set),this.values_cache=[],this.cache_valid=!0,cr.seal(this)}function r(t){b[x++]=t}function o(){this.c=0,this.y=0,this.t=0,this.sum=0,cr.seal(this)}function a(t){this.pts_cache=[],this.bboxLeft=0,this.bboxTop=0,this.bboxRight=0,this.bboxBottom=0,this.convexpolys=null,this.set_pts(t),cr.seal(this)}function h(t,e){this.cellwidth=t,this.cellheight=e,this.cells={}}function c(t,e,i){var s;return h.prototype.totalCellCount++,S.length?(s=S.pop(),s.grid=t,s.x=e,s.y=i,s):new cr.GridCell(t,e,i)}function l(t){h.prototype.totalCellCount--,t.objects.clear(),S.length<1e3&&S.push(t)}function u(t,e,i){this.grid=t,this.x=e,this.y=i,this.objects=new cr.ObjectSet}cr.logexport=function(t){window.console&&window.console.log&&window.console.log(t)},cr.seal=function(t){return t},cr.freeze=function(t){return t},cr.is_undefined=function(t){return"undefined"==typeof t},cr.is_number=function(t){return"number"==typeof t},cr.is_string=function(t){return"string"==typeof t},cr.isPOT=function(t){return t>0&&0===(t-1&t)},cr.nextHighestPowerOfTwo=function(t){--t;for(var e=1;32>e;e<<=1)t|=t>>e;return t+1},cr.abs=function(t){return 0>t?-t:t},cr.max=function(t,e){return t>e?t:e},cr.min=function(t,e){return e>t?t:e},cr.PI=Math.PI,cr.round=function(t){return t+.5|0},cr.floor=function(t){return t>=0?0|t:(0|t)-1},cr.ceil=function(t){var e=0|t;return e===t?e:e+1},t.prototype.offset=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.mul=function(t,e){return this.x*=t,this.y*=e,this},cr.vector2=t,cr.segments_intersect=function(t,e,i,s,n,r,o,a){var h,c,l,u,p,d,f,g;if(i>t?(c=t,h=i):(c=i,h=t),o>n?(d=n,p=o):(d=o,p=n),d>h||c>p)return!1;if(s>e?(u=e,l=s):(u=s,l=e),a>r?(g=r,f=a):(g=a,f=r),g>l||u>f)return!1;var m=n-t+o-i,y=r-e+a-s,_=i-t,v=s-e,b=o-n,x=a-r,w=cr.abs(v*b-x*_),S=b*y-x*m;if(cr.abs(S)>w)return!1;var T=_*y-v*m;return cr.abs(T)<=w},e.prototype.set=function(t,e,i,s){this.left=t,this.top=e,this.right=i,this.bottom=s},e.prototype.copy=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},e.prototype.width=function(){return this.right-this.left},e.prototype.height=function(){return this.bottom-this.top},e.prototype.offset=function(t,e){return this.left+=t,this.top+=e,this.right+=t,this.bottom+=e,this},e.prototype.normalize=function(){var t=0;this.left>this.right&&(t=this.left,this.left=this.right,this.right=t),this.top>this.bottom&&(t=this.top,this.top=this.bottom,this.bottom=t)},e.prototype.intersects_rect=function(t){return!(t.right<this.left||t.bottom<this.top||t.left>this.right||t.top>this.bottom)},e.prototype.intersects_rect_off=function(t,e,i){return!(t.right+e<this.left||t.bottom+i<this.top||t.left+e>this.right||t.top+i>this.bottom)},e.prototype.contains_pt=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},e.prototype.equals=function(t){return this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom},cr.rect=e,i.prototype.set_from_rect=function(t){this.tlx=t.left,this.tly=t.top,this.trx=t.right,this.try_=t.top,this.brx=t.right,this.bry=t.bottom,this.blx=t.left,this.bly=t.bottom},i.prototype.set_from_rotated_rect=function(t,e){if(0===e)this.set_from_rect(t);else{var i=Math.sin(e),s=Math.cos(e),n=t.left*i,r=t.top*i,o=t.right*i,a=t.bottom*i,h=t.left*s,c=t.top*s,l=t.right*s,u=t.bottom*s;this.tlx=h-r,this.tly=c+n,this.trx=l-r,this.try_=c+o,this.brx=l-a,this.bry=u+o,this.blx=h-a,this.bly=u+n}},i.prototype.offset=function(t,e){return this.tlx+=t,this.tly+=e,this.trx+=t,this.try_+=e,this.brx+=t,this.bry+=e,this.blx+=t,this.bly+=e,this};var p=0,d=0;i.prototype.bounding_box=function(t){s(this.tlx,this.trx,this.brx,this.blx),t.left=p,t.right=d,s(this.tly,this.try_,this.bry,this.bly),t.top=p,t.bottom=d},i.prototype.contains_pt=function(t,e){var i=this.trx-this.tlx,s=this.try_-this.tly,n=this.brx-this.tlx,r=this.bry-this.tly,o=t-this.tlx,a=e-this.tly,h=i*i+s*s,c=i*n+s*r,l=i*o+s*a,u=n*n+r*r,p=n*o+r*a,d=1/(h*u-c*c),f=(u*l-c*p)*d,g=(h*p-c*l)*d;if(f>=0&&g>0&&1>f+g)return!0;i=this.blx-this.tlx,s=this.bly-this.tly;var h=i*i+s*s,c=i*n+s*r,l=i*o+s*a;return d=1/(h*u-c*c),f=(u*l-c*p)*d,g=(h*p-c*l)*d,f>=0&&g>0&&1>f+g},i.prototype.at=function(t,e){if(e)switch(t){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(t){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}},i.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},i.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},i.prototype.intersects_segment=function(t,e,i,s){if(this.contains_pt(t,e)||this.contains_pt(i,s))return!0;var n,r,o,a,h;for(h=0;4>h;h++)if(n=this.at(h,!0),r=this.at(h,!1),o=this.at(h+1,!0),a=this.at(h+1,!1),cr.segments_intersect(t,e,i,s,n,r,o,a))return!0;return!1},i.prototype.intersects_quad=function(t){var e=t.midX(),i=t.midY();if(this.contains_pt(e,i))return!0;if(e=this.midX(),i=this.midY(),t.contains_pt(e,i))return!0;var s,n,r,o,a,h,c,l,u,p;for(u=0;4>u;u++)for(p=0;4>p;p++)if(s=this.at(u,!0),n=this.at(u,!1),r=this.at(u+1,!0),o=this.at(u+1,!1),a=t.at(p,!0),h=t.at(p,!1),c=t.at(p+1,!0),l=t.at(p+1,!1),cr.segments_intersect(s,n,r,o,a,h,c,l))return!0;return!1},cr.quad=i,cr.RGB=function(t,e,i){return Math.max(Math.min(t,255),0)|Math.max(Math.min(e,255),0)<<8|Math.max(Math.min(i,255),0)<<16},cr.GetRValue=function(t){return 255&t},cr.GetGValue=function(t){return(65280&t)>>8},cr.GetBValue=function(t){return(16711680&t)>>16},cr.shallowCopy=function(t,e){var i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},cr.arrayRemove=function(t,e){var i,s;if(e=cr.floor(e),!(0>e||e>=t.length)){for(i=e,s=t.length-1;s>i;i++)t[i]=t[i+1];t.length=s}},cr.shallowAssignArray=function(t,e){t.length=e.length;var i,s;for(i=0,s=e.length;s>i;i++)t[i]=e[i]},cr.appendArray=function(t,e){t.push.apply(t,e)},cr.fastIndexOf=function(t,e){var i,s;for(i=0,s=t.length;s>i;++i)if(t[i]===e)return i;return-1},cr.arrayFindRemove=function(t,e){var i=cr.fastIndexOf(t,e);-1!==i&&cr.arrayRemove(t,i)},cr.clamp=function(t,e,i){return e>t?e:t>i?i:t},cr.to_radians=function(t){return t/(180/cr.PI)},cr.to_degrees=function(t){return t*(180/cr.PI)},cr.clamp_angle_degrees=function(t){return t%=360,0>t&&(t+=360),t},cr.clamp_angle=function(t){return t%=2*cr.PI,0>t&&(t+=2*cr.PI),t},cr.to_clamped_degrees=function(t){return cr.clamp_angle_degrees(cr.to_degrees(t))},cr.to_clamped_radians=function(t){return cr.clamp_angle(cr.to_radians(t))},cr.angleTo=function(t,e,i,s){var n=i-t,r=s-e;return Math.atan2(r,n)},cr.angleDiff=function(t,e){if(t===e)return 0;var i=Math.sin(t),s=Math.cos(t),n=Math.sin(e),r=Math.cos(e),o=i*n+s*r;return o>=1?0:-1>=o?cr.PI:Math.acos(o)},cr.angleRotate=function(t,e,i){var s=Math.sin(t),n=Math.cos(t),r=Math.sin(e),o=Math.cos(e);return cr.clamp_angle(Math.acos(s*r+n*o)>i?n*r-s*o>0?t+i:t-i:e)},cr.angleClockwise=function(t,e){var i=Math.sin(t),s=Math.cos(t),n=Math.sin(e),r=Math.cos(e);return 0>=s*n-i*r},cr.rotatePtAround=function(t,e,i,s,n,r){if(0===i)return r?t:e;var o=Math.sin(i),a=Math.cos(i);t-=s,e-=n;var h=t*o,c=e*o,l=t*a,u=e*a;return t=l-c,e=u+h,t+=s,e+=n,r?t:e},cr.distanceTo=function(t,e,i,s){var n=i-t,r=s-e;return Math.sqrt(n*n+r*r)},cr.xor=function(t,e){return!t!=!e},cr.lerp=function(t,e,i){return t+(e-t)*i},cr.unlerp=function(t,e,i){return t===e?0:(i-t)/(e-t)},cr.anglelerp=function(t,e,i){var s=cr.angleDiff(t,e);return cr.angleClockwise(e,t)?t+s*i:t-s*i},cr.qarp=function(t,e,i,s){return cr.lerp(cr.lerp(t,e,s),cr.lerp(e,i,s),s)},cr.cubic=function(t,e,i,s,n){return cr.lerp(cr.qarp(t,e,i,n),cr.qarp(e,i,s,n),n)},cr.cosp=function(t,e,i){return(t+e+(t-e)*Math.cos(i*Math.PI))/2},cr.hasAnyOwnProperty=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return!0;return!1},cr.wipe=function(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e]};var f=+new Date;cr.performance_now=function(){if("undefined"!=typeof window.performance){var t=window.performance;if("undefined"!=typeof t.now)return t.now();if("undefined"!=typeof t.webkitNow)return t.webkitNow();if("undefined"!=typeof t.mozNow)return t.mozNow();if("undefined"!=typeof t.msNow)return t.msNow()}return Date.now()-f};var g=!1,m=!1,y=!1,_=!1;"undefined"!=typeof window&&(g=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),m=!g&&/safari/i.test(navigator.userAgent),y=/(iphone|ipod|ipad)/i.test(navigator.userAgent),_=window.c2ejecta);var v=!m&&!_&&!y&&"undefined"!=typeof Set&&"undefined"!=typeof Set.prototype.forEach;n.prototype.contains=function(t){return this.isEmpty()?!1:v?this.s.has(t):this.items&&this.items.hasOwnProperty(t)},n.prototype.add=function(t){if(v)this.s.has(t)||(this.s.add(t),this.cache_valid=!1);else{var e=t.toString(),i=this.items;i?i.hasOwnProperty(e)||(i[e]=t,this.item_count++,this.cache_valid=!1):(this.items={},this.items[e]=t,this.item_count=1,this.cache_valid=!1)}},n.prototype.remove=function(t){if(!this.isEmpty())if(v)this.s.has(t)&&(this.s["delete"](t),this.cache_valid=!1);else if(this.items){var e=t.toString(),i=this.items;i.hasOwnProperty(e)&&(delete i[e],this.item_count--,this.cache_valid=!1)}},n.prototype.clear=function(){this.isEmpty()||(v?this.s.clear():(this.items=null,this.item_count=0),this.values_cache.length=0,this.cache_valid=!0)},n.prototype.isEmpty=function(){return 0===this.count()},n.prototype.count=function(){return v?this.s.size:this.item_count};var b=null,x=0;n.prototype.update_cache=function(){if(!this.cache_valid){if(v)this.values_cache.length=this.s.size,b=this.values_cache,x=0,this.s.forEach(r),b=null,x=0;else{var t=this.values_cache;t.length=this.item_count;var e,i=0,s=this.items;if(s)for(e in s)s.hasOwnProperty(e)&&(t[i++]=s[e])}this.cache_valid=!0}},n.prototype.valuesRef=function(){return this.update_cache(),this.values_cache},cr.ObjectSet=n;var w=new cr.ObjectSet;cr.removeArrayDuplicates=function(t){var e,i;for(e=0,i=t.length;i>e;++e)w.add(t[e]);cr.shallowAssignArray(t,w.valuesRef()),w.clear()},o.prototype.add=function(t){this.y=t-this.c,this.t=this.sum+this.y,this.c=this.t-this.sum-this.y,this.sum=this.t},o.prototype.reset=function(){this.c=0,this.y=0,this.t=0,this.sum=0},cr.KahanAdder=o,cr.regexp_escape=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},a.prototype.set_pts=function(t){this.pts_array=t,this.pts_count=t.length/2,this.pts_cache.length=t.length,this.cache_width=-1,this.cache_height=-1,this.cache_angle=0},a.prototype.is_empty=function(){return!this.pts_array.length},a.prototype.update_bbox=function(){for(var t,e,i,s=this.pts_cache,n=s[0],r=n,o=s[1],a=o,h=1,c=this.pts_count;c>h;++h)i=2*h,t=s[i],e=s[i+1],n>t&&(n=t),t>r&&(r=t),o>e&&(o=e),e>a&&(a=e);this.bboxLeft=n,this.bboxRight=r,this.bboxTop=o,this.bboxBottom=a},a.prototype.set_from_rect=function(t,e,i){this.pts_cache.length=8,this.pts_count=4;var s=this.pts_cache;s[0]=t.left-e,s[1]=t.top-i,s[2]=t.right-e,s[3]=t.top-i,s[4]=t.right-e,s[5]=t.bottom-i,s[6]=t.left-e,s[7]=t.bottom-i,this.cache_width=t.right-t.left,this.cache_height=t.bottom-t.top,this.update_bbox()},a.prototype.set_from_quad=function(t,e,i,s,n){this.pts_cache.length=8,this.pts_count=4;var r=this.pts_cache;r[0]=t.tlx-e,r[1]=t.tly-i,r[2]=t.trx-e,r[3]=t.try_-i,r[4]=t.brx-e,r[5]=t.bry-i,r[6]=t.blx-e,r[7]=t.bly-i,this.cache_width=s,this.cache_height=n,this.update_bbox()},a.prototype.set_from_poly=function(t){this.pts_count=t.pts_count,cr.shallowAssignArray(this.pts_cache,t.pts_cache),this.bboxLeft=t.bboxLeft,this.bboxTop-t.bboxTop,this.bboxRight=t.bboxRight,this.bboxBottom=t.bboxBottom},a.prototype.cache_poly=function(t,e,i){if(this.cache_width!==t||this.cache_height!==e||this.cache_angle!==i){this.cache_width=t,this.cache_height=e,this.cache_angle=i;var s,n,r,o,a,h,c=0,l=1,u=this.pts_array,p=this.pts_cache;for(0!==i&&(c=Math.sin(i),l=Math.cos(i)),s=0,o=this.pts_count;o>s;s++)n=2*s,r=n+1,a=u[n]*t,h=u[r]*e,p[n]=a*l-h*c,p[r]=h*l+a*c;this.update_bbox()}},a.prototype.contains_pt=function(t,e){var i=this.pts_cache;if(t===i[0]&&e===i[1])return!0;var s,n,r,o,a,h,c,l=this.pts_count,u=this.bboxLeft-110,p=this.bboxTop-101,d=this.bboxRight+131,f=this.bboxBottom+120,g=0,m=0;for(s=0;l>s;s++)n=2*s,r=(s+1)%l*2,o=i[n],a=i[n+1],h=i[r],c=i[r+1],cr.segments_intersect(u,p,t,e,o,a,h,c)&&g++,cr.segments_intersect(d,f,t,e,o,a,h,c)&&m++;return g%2===1||m%2===1},a.prototype.intersects_poly=function(t,e,i){var s=t.pts_cache,n=this.pts_cache;if(this.contains_pt(s[0]+e,s[1]+i))return!0;if(t.contains_pt(n[0]-e,n[1]-i))return!0;var r,o,a,h,c,l,u,p,d,f,g,m,y,_,v,b;for(r=0,h=this.pts_count;h>r;r++)for(o=2*r,a=(r+1)%h*2,d=n[o],f=n[o+1],g=n[a],m=n[a+1],c=0,p=t.pts_count;p>c;c++)if(l=2*c,u=(c+1)%p*2,y=s[l]+e,_=s[l+1]+i,v=s[u]+e,b=s[u+1]+i,cr.segments_intersect(d,f,g,m,y,_,v,b))return!0;return!1},a.prototype.intersects_segment=function(t,e,i,s,n,r){var o=this.pts_cache;if(this.contains_pt(i-t,s-e))return!0;var a,h,c,l,u,p,d,f;for(a=0,h=this.pts_count;h>a;a++)if(c=2*a,l=(a+1)%h*2,u=o[c]+t,p=o[c+1]+e,d=o[l]+t,f=o[l+1]+e,cr.segments_intersect(i,s,n,r,u,p,d,f))return!0;return!1},a.prototype.mirror=function(t){var e,i,s;for(e=0,i=this.pts_count;i>e;++e)s=2*e,this.pts_cache[s]=2*t-this.pts_cache[s]},a.prototype.flip=function(t){var e,i,s;for(e=0,i=this.pts_count;i>e;++e)s=2*e+1,this.pts_cache[s]=2*t-this.pts_cache[s]},a.prototype.diag=function(){var t,e,i,s,n;for(t=0,e=this.pts_count;e>t;++t)i=2*t,s=i+1,n=this.pts_cache[i],this.pts_cache[i]=this.pts_cache[s],this.pts_cache[s]=n},cr.CollisionPoly=a,h.prototype.totalCellCount=0,h.prototype.getCell=function(t,e,i){var s,n=this.cells[t];return n?(s=n[e],s?s:i?(s=c(this,t,e),this.cells[t][e]=s,s):null):i?(s=c(this,t,e),this.cells[t]={},this.cells[t][e]=s,s):null},h.prototype.XToCell=function(t){return cr.floor(t/this.cellwidth)},h.prototype.YToCell=function(t){return cr.floor(t/this.cellheight)},h.prototype.update=function(t,e,i){var s,n,r,o,a;if(e)for(s=e.left,n=e.right;n>=s;++s)for(r=e.top,o=e.bottom;o>=r;++r)i&&i.contains_pt(s,r)||(a=this.getCell(s,r,!1),a&&(a.remove(t),a.isEmpty()&&(l(a),this.cells[s][r]=null)));if(i)for(s=i.left,n=i.right;n>=s;++s)for(r=i.top,o=i.bottom;o>=r;++r)e&&e.contains_pt(s,r)||this.getCell(s,r,!0).insert(t)},h.prototype.queryRange=function(t,e){var i,s,n,r,o,a;for(i=this.XToCell(t.left),n=this.YToCell(t.top),s=this.XToCell(t.right),o=this.YToCell(t.bottom);s>=i;++i)for(r=n;o>=r;++r)a=this.getCell(i,r,!1),a&&a.dump(e)},cr.SparseGrid=h;var S=[];u.prototype.isEmpty=function(){return this.objects.isEmpty()},u.prototype.insert=function(t){this.objects.add(t)},u.prototype.remove=function(t){this.objects.remove(t)},u.prototype.dump=function(t){cr.appendArray(t,this.objects.valuesRef())},cr.GridCell=u;var T=["lighter","xor","copy","destination-over","source-in","destination-in","source-out","destination-out","source-atop","destination-atop"];cr.effectToCompositeOp=function(t){return 0>=t||t>=11?"source-over":T[t-1]},cr.setGLBlend=function(t,e,i){if(i)switch(t.srcBlend=i.ONE,t.destBlend=i.ONE_MINUS_SRC_ALPHA,e){case 1:t.srcBlend=i.ONE,t.destBlend=i.ONE;break;case 2:break;case 3:t.srcBlend=i.ONE,t.destBlend=i.ZERO;break;case 4:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ONE;break;case 5:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ZERO;break;case 6:t.srcBlend=i.ZERO,t.destBlend=i.SRC_ALPHA;break;case 7:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ZERO;break;case 8:t.srcBlend=i.ZERO,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 9:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 10:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.SRC_ALPHA}},cr.round6dp=function(t){return Math.round(1e6*t)/1e6},cr.equals_nocase=function(t,e){return"string"!=typeof t||"string"!=typeof e?!1:t.length!==e.length?!1:t===e?!0:t.toLowerCase()===e.toLowerCase()},cr.isCanvasInputEvent=function(t){var e=t.target;return e?e===document||e===window?!0:document&&document.body&&e===document.body?!0:cr.equals_nocase(e.tagName,"canvas")?!0:!1:!0}}();var MatrixArray="undefined"!=typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(t){var e=new MatrixArray(3);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2]),e},vec3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},vec3.add=function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t)},vec3.subtract=function(t,e,i){return i&&t!==i?(i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i):(t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t)},vec3.negate=function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},vec3.scale=function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t)},vec3.normalize=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=Math.sqrt(i*i+s*s+n*n);return r?1===r?(e[0]=i,e[1]=s,e[2]=n,e):(r=1/r,e[0]=i*r,e[1]=s*r,e[2]=n*r,e):(e[0]=0,e[1]=0,e[2]=0,e)},vec3.cross=function(t,e,i){i||(i=t);var s=t[0],n=t[1],t=t[2],r=e[0],o=e[1],e=e[2];return i[0]=n*e-t*o,i[1]=t*r-s*e,i[2]=s*o-n*r,i},vec3.length=function(t){var e=t[0],i=t[1],t=t[2];return Math.sqrt(e*e+i*i+t*t)},vec3.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},vec3.direction=function(t,e,i){i||(i=t);var s=t[0]-e[0],n=t[1]-e[1],t=t[2]-e[2],e=Math.sqrt(s*s+n*n+t*t);return e?(e=1/e,i[0]=s*e,i[1]=n*e,i[2]=t*e,i):(i[0]=0,i[1]=0,i[2]=0,i)},vec3.lerp=function(t,e,i,s){return s||(s=t),s[0]=t[0]+i*(e[0]-t[0]),s[1]=t[1]+i*(e[1]-t[1]),s[2]=t[2]+i*(e[2]-t[2]),s},vec3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+"]"},mat3.create=function(t){var e=new MatrixArray(9);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]),e},mat3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},mat3.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3.transpose=function(t,e){if(!e||t===e){var i=t[1],s=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=i,t[5]=t[7],t[6]=s,t[7]=n,t}return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e},mat3.toMat4=function(t,e){return e||(e=mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},mat3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+"]"},mat4.create=function(t){var e=new MatrixArray(16);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e},mat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},mat4.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4.transpose=function(t,e){if(!e||t===e){var i=t[1],s=t[2],n=t[3],r=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=s,t[9]=r,t[11]=t[14],t[12]=n,t[13]=o,t[14]=a,t}return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},mat4.determinant=function(t){var e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],h=t[7],c=t[8],l=t[9],u=t[10],p=t[11],d=t[12],f=t[13],g=t[14],t=t[15];return d*l*a*n-c*f*a*n-d*o*u*n+r*f*u*n+c*o*g*n-r*l*g*n-d*l*s*h+c*f*s*h+d*i*u*h-e*f*u*h-c*i*g*h+e*l*g*h+d*o*s*p-r*f*s*p-d*i*a*p+e*f*a*p+r*i*g*p-e*o*g*p-c*o*s*t+r*l*s*t+c*i*a*t-e*l*a*t-r*i*u*t+e*o*u*t},mat4.inverse=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=t[9],p=t[10],d=t[11],f=t[12],g=t[13],m=t[14],y=t[15],_=i*a-s*o,v=i*h-n*o,b=i*c-r*o,x=s*h-n*a,w=s*c-r*a,S=n*c-r*h,T=l*g-u*f,k=l*m-p*f,C=l*y-d*f,O=u*m-p*g,A=u*y-d*g,E=p*y-d*m,P=1/(_*E-v*A+b*O+x*C-w*k+S*T);return e[0]=(a*E-h*A+c*O)*P,e[1]=(-s*E+n*A-r*O)*P,e[2]=(g*S-m*w+y*x)*P,e[3]=(-u*S+p*w-d*x)*P,e[4]=(-o*E+h*C-c*k)*P,e[5]=(i*E-n*C+r*k)*P,e[6]=(-f*S+m*b-y*v)*P,e[7]=(l*S-p*b+d*v)*P,e[8]=(o*A-a*C+c*T)*P,e[9]=(-i*A+s*C-r*T)*P,e[10]=(f*w-g*b+y*_)*P,e[11]=(-l*w+u*b-d*_)*P,e[12]=(-o*O+a*k-h*T)*P,e[13]=(i*O-s*k+n*T)*P,e[14]=(-f*x+g*v-m*_)*P,e[15]=(l*x-u*v+p*_)*P,e},mat4.toRotationMat=function(t,e){return e||(e=mat4.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},mat4.toMat3=function(t,e){return e||(e=mat3.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},mat4.toInverseMat3=function(t,e){var i=t[0],s=t[1],n=t[2],r=t[4],o=t[5],a=t[6],h=t[8],c=t[9],l=t[10],u=l*o-a*c,p=-l*r+a*h,d=c*r-o*h,f=i*u+s*p+n*d;return f?(f=1/f,e||(e=mat3.create()),e[0]=u*f,e[1]=(-l*s+n*c)*f,e[2]=(a*s-n*o)*f,e[3]=p*f,e[4]=(l*i-n*h)*f,e[5]=(-a*i+n*r)*f,e[6]=d*f,e[7]=(-c*i+s*h)*f,e[8]=(o*i-s*r)*f,e):null},mat4.multiply=function(t,e,i){i||(i=t);var s=t[0],n=t[1],r=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],u=t[8],p=t[9],d=t[10],f=t[11],g=t[12],m=t[13],y=t[14],t=t[15],_=e[0],v=e[1],b=e[2],x=e[3],w=e[4],S=e[5],T=e[6],k=e[7],C=e[8],O=e[9],A=e[10],E=e[11],P=e[12],B=e[13],R=e[14],e=e[15];return i[0]=_*s+v*a+b*u+x*g,i[1]=_*n+v*h+b*p+x*m,i[2]=_*r+v*c+b*d+x*y,i[3]=_*o+v*l+b*f+x*t,i[4]=w*s+S*a+T*u+k*g,i[5]=w*n+S*h+T*p+k*m,i[6]=w*r+S*c+T*d+k*y,i[7]=w*o+S*l+T*f+k*t,i[8]=C*s+O*a+A*u+E*g,i[9]=C*n+O*h+A*p+E*m,i[10]=C*r+O*c+A*d+E*y,i[11]=C*o+O*l+A*f+E*t,i[12]=P*s+B*a+R*u+e*g,i[13]=P*n+B*h+R*p+e*m,i[14]=P*r+B*c+R*d+e*y,i[15]=P*o+B*l+R*f+e*t,i},mat4.multiplyVec3=function(t,e,i){i||(i=e);var s=e[0],n=e[1],e=e[2];return i[0]=t[0]*s+t[4]*n+t[8]*e+t[12],i[1]=t[1]*s+t[5]*n+t[9]*e+t[13],i[2]=t[2]*s+t[6]*n+t[10]*e+t[14],i},mat4.multiplyVec4=function(t,e,i){i||(i=e);var s=e[0],n=e[1],r=e[2],e=e[3];return i[0]=t[0]*s+t[4]*n+t[8]*r+t[12]*e,i[1]=t[1]*s+t[5]*n+t[9]*r+t[13]*e,i[2]=t[2]*s+t[6]*n+t[10]*r+t[14]*e,i[3]=t[3]*s+t[7]*n+t[11]*r+t[15]*e,i},mat4.translate=function(t,e,i){var s,n,r,o,a,h,c,l,u,p,d,f,g=e[0],m=e[1],e=e[2];return i&&t!==i?(s=t[0],n=t[1],r=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],u=t[8],p=t[9],d=t[10],f=t[11],i[0]=s,i[1]=n,i[2]=r,i[3]=o,i[4]=a,i[5]=h,i[6]=c,i[7]=l,i[8]=u,i[9]=p,i[10]=d,i[11]=f,i[12]=s*g+a*m+u*e+t[12],i[13]=n*g+h*m+p*e+t[13],i[14]=r*g+c*m+d*e+t[14],i[15]=o*g+l*m+f*e+t[15],i):(t[12]=t[0]*g+t[4]*m+t[8]*e+t[12],t[13]=t[1]*g+t[5]*m+t[9]*e+t[13],t[14]=t[2]*g+t[6]*m+t[10]*e+t[14],t[15]=t[3]*g+t[7]*m+t[11]*e+t[15],t)},mat4.scale=function(t,e,i){var s=e[0],n=e[1],e=e[2];return i&&t!==i?(i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*e,i[9]=t[9]*e,i[10]=t[10]*e,i[11]=t[11]*e,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i):(t[0]*=s,t[1]*=s,t[2]*=s,t[3]*=s,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e,t)},mat4.rotate=function(t,e,i,s){var n,r,o,a,h,c,l,u,p,d,f,g,m,y,_,v,b,x,w,S,T=i[0],k=i[1],i=i[2],C=Math.sqrt(T*T+k*k+i*i);return C?(1!==C&&(C=1/C,T*=C,k*=C,i*=C),n=Math.sin(e),r=Math.cos(e),o=1-r,e=t[0],C=t[1],a=t[2],h=t[3],c=t[4],l=t[5],u=t[6],p=t[7],d=t[8],f=t[9],g=t[10],m=t[11],y=T*T*o+r,_=k*T*o+i*n,v=i*T*o-k*n,b=T*k*o-i*n,x=k*k*o+r,w=i*k*o+T*n,S=T*i*o+k*n,T=k*i*o-T*n,k=i*i*o+r,s?t!==s&&(s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]):s=t,s[0]=e*y+c*_+d*v,s[1]=C*y+l*_+f*v,s[2]=a*y+u*_+g*v,s[3]=h*y+p*_+m*v,s[4]=e*b+c*x+d*w,s[5]=C*b+l*x+f*w,s[6]=a*b+u*x+g*w,s[7]=h*b+p*x+m*w,s[8]=e*S+c*T+d*k,s[9]=C*S+l*T+f*k,s[10]=a*S+u*T+g*k,s[11]=h*S+p*T+m*k,s):null},mat4.rotateX=function(t,e,i){var s=Math.sin(e),e=Math.cos(e),n=t[4],r=t[5],o=t[6],a=t[7],h=t[8],c=t[9],l=t[10],u=t[11];return i?t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[4]=n*e+h*s,i[5]=r*e+c*s,i[6]=o*e+l*s,i[7]=a*e+u*s,i[8]=n*-s+h*e,i[9]=r*-s+c*e,i[10]=o*-s+l*e,i[11]=a*-s+u*e,i},mat4.rotateY=function(t,e,i){var s=Math.sin(e),e=Math.cos(e),n=t[0],r=t[1],o=t[2],a=t[3],h=t[8],c=t[9],l=t[10],u=t[11];return i?t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*e+h*-s,i[1]=r*e+c*-s,i[2]=o*e+l*-s,i[3]=a*e+u*-s,i[8]=n*s+h*e,i[9]=r*s+c*e,i[10]=o*s+l*e,i[11]=a*s+u*e,i},mat4.rotateZ=function(t,e,i){var s=Math.sin(e),e=Math.cos(e),n=t[0],r=t[1],o=t[2],a=t[3],h=t[4],c=t[5],l=t[6],u=t[7];return i?t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*e+h*s,i[1]=r*e+c*s,i[2]=o*e+l*s,i[3]=a*e+u*s,i[4]=n*-s+h*e,i[5]=r*-s+c*e,i[6]=o*-s+l*e,i[7]=a*-s+u*e,i},mat4.frustum=function(t,e,i,s,n,r,o){o||(o=mat4.create());var a=e-t,h=s-i,c=r-n;return o[0]=2*n/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/h,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(s+i)/h,o[10]=-(r+n)/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(r*n*2)/c,o[15]=0,o},mat4.perspective=function(t,e,i,s,n){return t=i*Math.tan(t*Math.PI/360),e*=t,mat4.frustum(-e,e,-t,t,i,s,n)},mat4.ortho=function(t,e,i,s,n,r,o){o||(o=mat4.create());var a=e-t,h=s-i,c=r-n;return o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/c,o[11]=0,o[12]=-(t+e)/a,o[13]=-(s+i)/h,o[14]=-(r+n)/c,o[15]=1,o},mat4.lookAt=function(t,e,i,s){s||(s=mat4.create());var n,r,o,a,h,c,l,u,p=t[0],d=t[1],t=t[2];return r=i[0],o=i[1],n=i[2],i=e[1],c=e[2],p===e[0]&&d===i&&t===c?mat4.identity(s):(i=p-e[0],c=d-e[1],l=t-e[2],u=1/Math.sqrt(i*i+c*c+l*l),i*=u,c*=u,l*=u,e=o*l-n*c,n=n*i-r*l,r=r*c-o*i,(u=Math.sqrt(e*e+n*n+r*r))?(u=1/u,e*=u,n*=u,r*=u):r=n=e=0,o=c*r-l*n,a=l*e-i*r,h=i*n-c*e,(u=Math.sqrt(o*o+a*a+h*h))?(u=1/u,o*=u,a*=u,h*=u):h=a=o=0,s[0]=e,s[1]=o,s[2]=i,s[3]=0,s[4]=n,s[5]=a,s[6]=c,s[7]=0,s[8]=r,s[9]=h,s[10]=l,s[11]=0,s[12]=-(e*p+n*d+r*t),s[13]=-(o*p+a*d+h*t),s[14]=-(i*p+c*d+l*t),s[15]=1,s)},mat4.fromRotationTranslation=function(t,e,i){i||(i=mat4.create());var s=t[0],n=t[1],r=t[2],o=t[3],a=s+s,h=n+n,c=r+r,t=s*a,l=s*h;s*=c;var u=n*h;return n*=c,r*=c,a*=o,h*=o,o*=c,i[0]=1-(u+r),i[1]=l+o,i[2]=s-h,i[3]=0,i[4]=l-o,i[5]=1-(t+r),i[6]=n+a,i[7]=0,i[8]=s+h,i[9]=n-a,i[10]=1-(t+u),i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i},mat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"]"},quat4.create=function(t){var e=new MatrixArray(4);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e},quat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},quat4.calculateW=function(t,e){var i=t[0],s=t[1],n=t[2];return e&&t!==e?(e[0]=i,e[1]=s,e[2]=n,e[3]=-Math.sqrt(Math.abs(1-i*i-s*s-n*n)),e):(t[3]=-Math.sqrt(Math.abs(1-i*i-s*s-n*n)),t)},quat4.inverse=function(t,e){return e&&t!==e?(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e):(t[0]*=-1,t[1]*=-1,t[2]*=-1,t)},quat4.length=function(t){var e=t[0],i=t[1],s=t[2],t=t[3];return Math.sqrt(e*e+i*i+s*s+t*t)},quat4.normalize=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=t[3],o=Math.sqrt(i*i+s*s+n*n+r*r);return 0===o?(e[0]=0,e[1]=0,e[2]=0,e[3]=0,e):(o=1/o,e[0]=i*o,e[1]=s*o,e[2]=n*o,e[3]=r*o,e)},quat4.multiply=function(t,e,i){i||(i=t);var s=t[0],n=t[1],r=t[2],t=t[3],o=e[0],a=e[1],h=e[2],e=e[3];return i[0]=s*e+t*o+n*h-r*a,i[1]=n*e+t*a+r*o-s*h,i[2]=r*e+t*h+s*a-n*o,i[3]=t*e-s*o-n*a-r*h,i},quat4.multiplyVec3=function(t,e,i){i||(i=e);var s=e[0],n=e[1],r=e[2],e=t[0],o=t[1],a=t[2],t=t[3],h=t*s+o*r-a*n,c=t*n+a*s-e*r,l=t*r+e*n-o*s,s=-e*s-o*n-a*r;return i[0]=h*t+s*-e+c*-a-l*-o,i[1]=c*t+s*-o+l*-e-h*-a,i[2]=l*t+s*-a+h*-o-c*-e,i},quat4.toMat3=function(t,e){e||(e=mat3.create());var i=t[0],s=t[1],n=t[2],r=t[3],o=i+i,a=s+s,h=n+n,c=i*o,l=i*a;i*=h;var u=s*a;return s*=h,n*=h,o*=r,a*=r,r*=h,e[0]=1-(u+n),e[1]=l+r,e[2]=i-a,e[3]=l-r,e[4]=1-(c+n),e[5]=s+o,e[6]=i+a,e[7]=s-o,e[8]=1-(c+u),e},quat4.toMat4=function(t,e){e||(e=mat4.create());var i=t[0],s=t[1],n=t[2],r=t[3],o=i+i,a=s+s,h=n+n,c=i*o,l=i*a;i*=h;var u=s*a;return s*=h,n*=h,o*=r,a*=r,r*=h,e[0]=1-(u+n),e[1]=l+r,e[2]=i-a,e[3]=0,e[4]=l-r,e[5]=1-(c+n),e[6]=s+o,e[7]=0,e[8]=i+a,e[9]=s-o,e[10]=1-(c+u),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},quat4.slerp=function(t,e,i,s){s||(s=t);var n,r,o=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];return Math.abs(o)>=1?(s!==t&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3]),s):(n=Math.acos(o),r=Math.sqrt(1-o*o),Math.abs(r)<.001?(s[0]=.5*t[0]+.5*e[0],s[1]=.5*t[1]+.5*e[1],s[2]=.5*t[2]+.5*e[2],s[3]=.5*t[3]+.5*e[3],s):(o=Math.sin((1-i)*n)/r,i=Math.sin(i*n)/r,s[0]=t[0]*o+e[0]*i,s[1]=t[1]*o+e[1]*i,s[2]=t[2]*o+e[2]*i,s[3]=t[3]*o+e[3]*i,s))},quat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"},function(){function t(t){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent),this.width=0,this.height=0,this.cam=vec3.create([0,0,100]),this.look=vec3.create([0,0,0]),this.up=vec3.create([0,1,0]),this.worldScale=vec3.create([1,1,1]),this.enable_mipmaps=!0,this.matP=mat4.create(),this.matMV=mat4.create(),this.lastMV=mat4.create(),this.currentMV=mat4.create(),this.gl=t,this.initState()}function e(t,e,i){this.gl=t,this.shaderProgram=e,this.name=i,this.locAPos=t.getAttribLocation(e,"aPos"),this.locATex=t.getAttribLocation(e,"aTex"),this.locMatP=t.getUniformLocation(e,"matP"),this.locMatMV=t.getUniformLocation(e,"matMV"),this.locOpacity=t.getUniformLocation(e,"opacity"),this.locSamplerFront=t.getUniformLocation(e,"samplerFront"),this.locSamplerBack=t.getUniformLocation(e,"samplerBack"),this.locDestStart=t.getUniformLocation(e,"destStart"),this.locDestEnd=t.getUniformLocation(e,"destEnd"),this.locSeconds=t.getUniformLocation(e,"seconds"),this.locPixelWidth=t.getUniformLocation(e,"pixelWidth"),this.locPixelHeight=t.getUniformLocation(e,"pixelHeight"),this.locLayerScale=t.getUniformLocation(e,"layerScale"),this.locLayerAngle=t.getUniformLocation(e,"layerAngle"),this.locViewOrigin=t.getUniformLocation(e,"viewOrigin"),this.hasAnyOptionalUniforms=!!(this.locPixelWidth||this.locPixelHeight||this.locSeconds||this.locSamplerBack||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle||this.locViewOrigin),this.lpPixelWidth=-999,this.lpPixelHeight=-999,this.lpOpacity=1,this.lpDestStartX=0,this.lpDestStartY=0,this.lpDestEndX=1,this.lpDestEndY=1,this.lpLayerScale=1,this.lpLayerAngle=0,this.lpViewOriginX=0,this.lpViewOriginY=0,this.lastCustomParams=[],this.lpMatMV=mat4.create(),this.locOpacity&&t.uniform1f(this.locOpacity,1),this.locSamplerFront&&t.uniform1i(this.locSamplerFront,0),this.locSamplerBack&&t.uniform1i(this.locSamplerBack,1),this.locDestStart&&t.uniform2f(this.locDestStart,0,0),this.locDestEnd&&t.uniform2f(this.locDestEnd,1,1),this.locLayerScale&&t.uniform1f(this.locLayerScale,1),this.locLayerAngle&&t.uniform1f(this.locLayerAngle,0),this.locViewOrigin&&t.uniform2f(this.locViewOrigin,0,0),this.hasCurrentMatMV=!1}function i(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function s(t,e){this.type=t,this.glwrap=e,this.gl=e.gl,this.opacityParam=0,this.startIndex=0,this.indexCount=0,this.texParam=null,this.mat4param=null,this.shaderParams=[],cr.seal(this)}var n=8e3,r=n/2*3,o=8e3,a=4,h=0,c=1,l=2,u=3,p=4,d=5,f=6,g=7,m=8,y=9,_=10;t.prototype.initState=function(){var t,e,i=this.gl;
for(this.lastOpacity=1,this.lastTexture0=null,this.lastTexture1=null,this.currentOpacity=1,i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),this.lastSrcBlend=i.ONE,this.lastDestBlend=i.ONE_MINUS_SRC_ALPHA,this.pointBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.pointBuffer),this.vertexBuffers=new Array(a),this.texcoordBuffers=new Array(a),t=0;a>t;t++)this.vertexBuffers[t]=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffers[t]),this.texcoordBuffers[t]=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.texcoordBuffers[t]);this.curBuffer=0,this.indexBuffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.vertexData=new Float32Array(2*n),this.texcoordData=new Float32Array(2*n),this.pointData=new Float32Array(4*o);var s=new Uint16Array(r);t=0,e=r;for(var h=0;e>t;)s[t++]=h,s[t++]=h+1,s[t++]=h+2,s[t++]=h,s[t++]=h+2,s[t++]=h+3,h+=4;i.bufferData(i.ELEMENT_ARRAY_BUFFER,s,i.STATIC_DRAW),this.vertexPtr=0,this.pointPtr=0;var c,l;this.shaderPrograms=[],c=["varying mediump vec2 vTex;","uniform lowp float opacity;","uniform lowp sampler2D samplerFront;","void main(void) {","	gl_FragColor = texture2D(samplerFront, vTex);","	gl_FragColor *= opacity;","}"].join("\n"),l=["attribute highp vec2 aPos;","attribute mediump vec2 aTex;","varying mediump vec2 vTex;","uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","	gl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","	vTex = aTex;","}"].join("\n");var u=this.createShaderProgram({src:c},l,"<default>");this.shaderPrograms.push(u),c=["uniform mediump sampler2D samplerFront;","varying lowp float opacity;","void main(void) {","	gl_FragColor = texture2D(samplerFront, gl_PointCoord);","	gl_FragColor *= opacity;","}"].join("\n");var p=["attribute vec4 aPos;","varying float opacity;","uniform mat4 matP;","uniform mat4 matMV;","void main(void) {","	gl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","	gl_PointSize = aPos.z;","	opacity = aPos.w;","}"].join("\n");u=this.createShaderProgram({src:c},p,"<point>"),this.shaderPrograms.push(u);for(var d in cr.shaders)cr.shaders.hasOwnProperty(d)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[d],l,d));i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,null),this.batch=[],this.batchPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.lastProgram=-1,this.currentProgram=-1,this.currentShader=null,this.fbo=i.createFramebuffer(),this.renderToTex=null,this.tmpVec3=vec3.create([0,0,0]);var f=i.getParameter(i.ALIASED_POINT_SIZE_RANGE);this.minPointSize=f[0],this.maxPointSize=f[1],this.maxPointSize>2048&&(this.maxPointSize=2048),this.switchProgram(0),cr.seal(this)},e.prototype.updateMatMV=function(t){i(this.lpMatMV,t)||(mat4.set(t,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,t))},t.prototype.createShaderProgram=function(t,i,s){var n=this.gl,r=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(r,t.src),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))return n.deleteShader(r),null;var o=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(o,i),n.compileShader(o),!n.getShaderParameter(o,n.COMPILE_STATUS))return n.deleteShader(r),n.deleteShader(o),null;var a=n.createProgram();if(n.attachShader(a,r),n.attachShader(a,o),n.linkProgram(a),!n.getProgramParameter(a,n.LINK_STATUS))return n.deleteShader(r),n.deleteShader(o),n.deleteProgram(a),null;n.useProgram(a),n.deleteShader(r),n.deleteShader(o);var h=new e(n,a,s);h.extendBoxHorizontal=t.extendBoxHorizontal||0,h.extendBoxVertical=t.extendBoxVertical||0,h.crossSampling=!!t.crossSampling,h.animated=!!t.animated,h.parameters=t.parameters||[];var c,l;for(c=0,l=h.parameters.length;l>c;c++)h.parameters[c][1]=n.getUniformLocation(a,h.parameters[c][0]),h.lastCustomParams.push(0),n.uniform1f(h.parameters[c][1],0);return cr.seal(h),h},t.prototype.getShaderIndex=function(t){var e,i;for(e=0,i=this.shaderPrograms.length;i>e;e++)if(this.shaderPrograms[e].name===t)return e;return-1},t.prototype.project=function(t,e,i){var s=this.matMV,n=this.matP,r=[0,0,0,0,0,0,0,0];r[0]=s[0]*t+s[4]*e+s[12],r[1]=s[1]*t+s[5]*e+s[13],r[2]=s[2]*t+s[6]*e+s[14],r[3]=s[3]*t+s[7]*e+s[15],r[4]=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12]*r[3],r[5]=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13]*r[3],r[6]=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14]*r[3],r[7]=-r[2],0!==r[7]&&(r[7]=1/r[7],r[4]*=r[7],r[5]*=r[7],r[6]*=r[7],i[0]=(.5*r[4]+.5)*this.width,i[1]=(.5*r[5]+.5)*this.height)},t.prototype.setSize=function(t,e,i){if(this.width!==t||this.height!==e||i){this.endBatch(),this.width=t,this.height=e,this.gl.viewport(0,0,t,e),mat4.perspective(45,t/e,1,1e3,this.matP),mat4.lookAt(this.cam,this.look,this.up,this.matMV);var s=[0,0],n=[0,0];this.project(0,0,s),this.project(1,1,n),this.worldScale[0]=1/(n[0]-s[0]),this.worldScale[1]=-1/(n[1]-s[1]);var r,o,a;for(r=0,o=this.shaderPrograms.length;o>r;r++)a=this.shaderPrograms[r],a.hasCurrentMatMV=!1,a.locMatP&&(this.gl.useProgram(a.shaderProgram),this.gl.uniformMatrix4fv(a.locMatP,!1,this.matP));this.gl.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture0=null,this.lastTexture1=null}},t.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV),mat4.scale(this.matMV,this.worldScale)},t.prototype.translate=function(t,e){(0!==t||0!==e)&&(this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3))},t.prototype.scale=function(t,e){(1!==t||1!==e)&&(this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=1,mat4.scale(this.matMV,this.tmpVec3))},t.prototype.rotateZ=function(t){0!==t&&mat4.rotateZ(this.matMV,t)},t.prototype.updateModelView=function(){for(var t=!1,e=0;16>e;e++)if(this.lastMV[e]!==this.matMV[e]){t=!0;break}if(t){var i=this.pushBatch();i.type=d,i.mat4param?mat4.set(this.matMV,i.mat4param):i.mat4param=mat4.create(this.matMV),mat4.set(this.matMV,this.lastMV),this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},s.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)},s.prototype.doSetTexture1=function(){var t=this.gl;t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.texParam),t.activeTexture(t.TEXTURE0)},s.prototype.doSetOpacity=function(){var t=this.opacityParam,e=this.glwrap;e.currentOpacity=t;var i=e.currentShader;i.locOpacity&&i.lpOpacity!==t&&(i.lpOpacity=t,this.gl.uniform1f(i.locOpacity,t))},s.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,2*this.startIndex)},s.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)},s.prototype.doUpdateModelView=function(){var t,e,i,s=this.glwrap.shaderPrograms,n=this.glwrap.currentProgram;for(t=0,e=s.length;e>t;t++)i=s[t],t===n&&i.locMatMV?(i.updateMatMV(this.mat4param),i.hasCurrentMatMV=!0):i.hasCurrentMatMV=!1;mat4.set(this.mat4param,this.glwrap.currentMV)},s.prototype.doRenderToTexture=function(){var t=this.gl,e=this.glwrap;this.texParam?(e.lastTexture1===this.texParam&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),e.lastTexture1=null,t.activeTexture(t.TEXTURE0)),t.bindFramebuffer(t.FRAMEBUFFER,e.fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texParam,0)):(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.bindFramebuffer(t.FRAMEBUFFER,null))},s.prototype.doClear=function(){var t=this.gl;0===this.startIndex?(t.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clear(t.COLOR_BUFFER_BIT)):(t.enable(t.SCISSOR_TEST),t.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clearColor(0,0,0,0),t.clear(this.gl.COLOR_BUFFER_BIT),t.disable(t.SCISSOR_TEST))},s.prototype.doPoints=function(){var t=this.gl,e=this.glwrap,i=e.shaderPrograms[1];t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV&&(i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0),t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.pointBuffer),t.vertexAttribPointer(i.locAPos,4,t.FLOAT,!1,0,0),t.drawArrays(t.POINTS,this.startIndex/4,this.indexCount),i=e.currentShader,t.useProgram(i.shaderProgram),i.locAPos>=0&&(t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,2,t.FLOAT,!1,0,0)),i.locATex>=0&&(t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0))},s.prototype.doSetProgram=function(){var t=this.gl,e=this.glwrap,i=e.shaderPrograms[this.startIndex];e.currentProgram=this.startIndex,e.currentShader=i,t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV&&(i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0),i.locOpacity&&i.lpOpacity!==e.currentOpacity&&(i.lpOpacity=e.currentOpacity,t.uniform1f(i.locOpacity,e.currentOpacity)),i.locAPos>=0&&(t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,2,t.FLOAT,!1,0,0)),i.locATex>=0&&(t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0))},s.prototype.doSetProgramParameters=function(){var t,e,i=this.glwrap.currentShader,s=this.gl,n=this.mat4param;i.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,s.activeTexture(s.TEXTURE0));var r,o=n[0];if(i.locPixelWidth&&o!==i.lpPixelWidth&&(i.lpPixelWidth=o,s.uniform1f(i.locPixelWidth,o)),o=n[1],i.locPixelHeight&&o!==i.lpPixelHeight&&(i.lpPixelHeight=o,s.uniform1f(i.locPixelHeight,o)),o=n[2],r=n[3],!i.locDestStart||o===i.lpDestStartX&&r===i.lpDestStartY||(i.lpDestStartX=o,i.lpDestStartY=r,s.uniform2f(i.locDestStart,o,r)),o=n[4],r=n[5],!i.locDestEnd||o===i.lpDestEndX&&r===i.lpDestEndY||(i.lpDestEndX=o,i.lpDestEndY=o,s.uniform2f(i.locDestEnd,o,r)),o=n[6],i.locLayerScale&&o!==i.lpLayerScale&&(i.lpLayerScale=o,s.uniform1f(i.locLayerScale,o)),o=n[7],i.locLayerAngle&&o!==i.lpLayerAngle&&(i.lpLayerAngle=o,s.uniform1f(i.locLayerAngle,o)),o=n[8],r=n[9],!i.locViewOrigin||o===i.lpViewOriginX&&o===i.lpViewOriginY||(i.lpViewOriginX=o,i.lpViewOriginY=r,s.uniform2f(i.locViewOrigin,o,r)),i.locSeconds&&s.uniform1f(i.locSeconds,cr.performance_now()/1e3),i.parameters.length)for(t=0,e=i.parameters.length;e>t;t++)o=this.shaderParams[t],o!==i.lastCustomParams[t]&&(i.lastCustomParams[t]=o,s.uniform1f(i.parameters[t][1],o))},t.prototype.pushBatch=function(){return this.batchPtr===this.batch.length&&this.batch.push(new s(h,this)),this.batch[this.batchPtr++]},t.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){var t=this.gl;if(this.pointPtr>0&&(t.bindBuffer(t.ARRAY_BUFFER,this.pointBuffer),t.bufferData(t.ARRAY_BUFFER,this.pointData.subarray(0,this.pointPtr),t.STREAM_DRAW),e&&e.locAPos>=0&&"<point>"===e.name&&t.vertexAttribPointer(e.locAPos,4,t.FLOAT,!1,0,0)),this.vertexPtr>0){var e=this.currentShader;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]),t.bufferData(t.ARRAY_BUFFER,this.vertexData.subarray(0,this.vertexPtr),t.STREAM_DRAW),e&&e.locAPos>=0&&"<point>"!==e.name&&t.vertexAttribPointer(e.locAPos,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]),t.bufferData(t.ARRAY_BUFFER,this.texcoordData.subarray(0,this.vertexPtr),t.STREAM_DRAW),e&&e.locATex>=0&&"<point>"!==e.name&&t.vertexAttribPointer(e.locATex,2,t.FLOAT,!1,0,0)}var i,s,n;for(i=0,s=this.batchPtr;s>i;i++)switch(n=this.batch[i],n.type){case 1:n.doQuad();break;case 2:n.doSetTexture();break;case 3:n.doSetOpacity();break;case 4:n.doSetBlend();break;case 5:n.doUpdateModelView();break;case 6:n.doRenderToTexture();break;case 7:n.doClear();break;case 8:n.doPoints();break;case 9:n.doSetProgram();break;case 10:n.doSetProgramParameters();break;case 11:n.doSetTexture1()}this.batchPtr=0,this.vertexPtr=0,this.pointPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.curBuffer++,this.curBuffer>=a&&(this.curBuffer=0)}},t.prototype.setOpacity=function(t){if(t!==this.lastOpacity){var e=this.pushBatch();e.type=u,e.opacityParam=t,this.lastOpacity=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.setTexture=function(t){if(t!==this.lastTexture0){var e=this.pushBatch();e.type=l,e.texParam=t,this.lastTexture0=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.setBlend=function(t,e){if(t!==this.lastSrcBlend||e!==this.lastDestBlend){var i=this.pushBatch();i.type=p,i.startIndex=t,i.indexCount=e,this.lastSrcBlend=t,this.lastDestBlend=e,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA},t.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)},t.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};var v=2*n-8;t.prototype.quad=function(t,e,i,s,n,r,o,a){this.vertexPtr>=v&&this.endBatch();var h=this.vertexPtr,l=this.vertexData,u=this.texcoordData;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var p=this.pushBatch();p.type=c,p.startIndex=h/4*3,p.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}l[h]=t,u[h++]=0,l[h]=e,u[h++]=0,l[h]=i,u[h++]=1,l[h]=s,u[h++]=0,l[h]=n,u[h++]=1,l[h]=r,u[h++]=1,l[h]=o,u[h++]=0,l[h]=a,u[h++]=1,this.vertexPtr=h},t.prototype.quadTex=function(t,e,i,s,n,r,o,a,h){this.vertexPtr>=v&&this.endBatch();var l=this.vertexPtr,u=this.vertexData,p=this.texcoordData;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var d=this.pushBatch();d.type=c,d.startIndex=l/4*3,d.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}var f=h.left,g=h.top,m=h.right,y=h.bottom;u[l]=t,p[l++]=f,u[l]=e,p[l++]=g,u[l]=i,p[l++]=m,u[l]=s,p[l++]=g,u[l]=n,p[l++]=m,u[l]=r,p[l++]=y,u[l]=o,p[l++]=f,u[l]=a,p[l++]=y,this.vertexPtr=l},t.prototype.quadTexUV=function(t,e,i,s,n,r,o,a,h,l,u,p,d,f,g,m){this.vertexPtr>=v&&this.endBatch();var y=this.vertexPtr,_=this.vertexData,b=this.texcoordData;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var x=this.pushBatch();x.type=c,x.startIndex=y/4*3,x.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}_[y]=t,b[y++]=h,_[y]=e,b[y++]=l,_[y]=i,b[y++]=u,_[y]=s,b[y++]=p,_[y]=n,b[y++]=d,_[y]=r,b[y++]=f,_[y]=o,b[y++]=g,_[y]=a,b[y++]=m,this.vertexPtr=y},t.prototype.convexPoly=function(t){var e,i,s,n,r,o,a,h,c=t.length/2,l=c-2,u=l-1,p=t[0],d=t[1];for(e=0;l>e;e+=2)i=2*e,s=t[i+2],n=t[i+3],r=t[i+4],o=t[i+5],e===u?this.quad(p,d,s,n,r,o,r,o):(a=t[i+6],h=t[i+7],this.quad(p,d,s,n,r,o,a,h))};var b=o-4;t.prototype.point=function(t,e,i,s){this.pointPtr>=b&&this.endBatch();var n=this.pointPtr,r=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var o=this.pushBatch();o.type=m,o.startIndex=n,o.indexCount=1,this.hasPointBatchTop=!0,this.hasQuadBatchTop=!1}r[n++]=t,r[n++]=e,r[n++]=i,r[n++]=s,this.pointPtr=n},t.prototype.switchProgram=function(t){if(this.lastProgram!==t){var e=this.shaderPrograms[t];if(!e){if(0===this.lastProgram)return;t=0,e=this.shaderPrograms[0]}var i=this.pushBatch();i.type=y,i.startIndex=t,this.lastProgram=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.programUsesDest=function(t){var e=this.shaderPrograms[t];return!(!e.locDestStart&&!e.locDestEnd)},t.prototype.programUsesCrossSampling=function(t){var e=this.shaderPrograms[t];return!!(e.locDestStart||e.locDestEnd||e.crossSampling)},t.prototype.programExtendsBox=function(t){var e=this.shaderPrograms[t];return 0!==e.extendBoxHorizontal||0!==e.extendBoxVertical},t.prototype.getProgramBoxExtendHorizontal=function(t){return this.shaderPrograms[t].extendBoxHorizontal},t.prototype.getProgramBoxExtendVertical=function(t){return this.shaderPrograms[t].extendBoxVertical},t.prototype.getProgramParameterType=function(t,e){return this.shaderPrograms[t].parameters[e][2]},t.prototype.programIsAnimated=function(t){return this.shaderPrograms[t].animated},t.prototype.setProgramParameters=function(t,e,i,s,n,r,o,a,h,c,l,u){var p,d,f,g,m,y=this.shaderPrograms[this.lastProgram];if(y.hasAnyOptionalUniforms||u.length){if(f=this.pushBatch(),f.type=_,f.mat4param?mat4.set(this.matMV,f.mat4param):f.mat4param=mat4.create(),g=f.mat4param,g[0]=e,g[1]=i,g[2]=s,g[3]=n,g[4]=r,g[5]=o,g[6]=a,g[7]=h,g[8]=c,g[9]=l,f.texParam=y.locSamplerBack?t:null,u.length)for(m=f.shaderParams,m.length=u.length,p=0,d=u.length;d>p;p++)m[p]=u[p];this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.clear=function(t,e,i,s){var n=this.pushBatch();n.type=g,n.startIndex=0,n.mat4param||(n.mat4param=mat4.create()),n.mat4param[0]=t,n.mat4param[1]=e,n.mat4param[2]=i,n.mat4param[3]=s,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.clearRect=function(t,e,i,s){if(!(0>i||0>s)){var n=this.pushBatch();n.type=g,n.startIndex=1,n.mat4param||(n.mat4param=mat4.create()),n.mat4param[0]=t,n.mat4param[1]=e,n.mat4param[2]=i,n.mat4param[3]=s,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.present=function(){this.endBatch(),this.gl.flush()};var x=[],w={};t.prototype.contextLost=function(){x.length=0,w={}};var S=1,T=2,k=3,C=4;t.prototype.loadTexture=function(t,e,i,s,n,r){e=!!e,i=!!i;var o=t.src+","+e+","+i+(e?","+n:""),a=null;if("undefined"!=typeof t.src&&w.hasOwnProperty(o))return a=w[o],a.c2refcount++,a;this.endBatch();var h=this.gl,c=cr.isPOT(t.width)&&cr.isPOT(t.height);a=h.createTexture(),h.bindTexture(h.TEXTURE_2D,a),h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var l=h.RGBA,u=h.RGBA,p=h.UNSIGNED_BYTE;if(s&&!this.isIE)switch(s){case S:l=h.RGB,u=h.RGB;break;case T:p=h.UNSIGNED_SHORT_4_4_4_4;break;case k:p=h.UNSIGNED_SHORT_5_5_5_1;break;case C:l=h.RGB,u=h.RGB,p=h.UNSIGNED_SHORT_5_6_5}if(!c&&e){var d=document.createElement("canvas");d.width=cr.nextHighestPowerOfTwo(t.width),d.height=cr.nextHighestPowerOfTwo(t.height);var f=d.getContext("2d");f.webkitImageSmoothingEnabled=i,f.mozImageSmoothingEnabled=i,f.msImageSmoothingEnabled=i,f.imageSmoothingEnabled=i,f.drawImage(t,0,0,t.width,t.height,0,0,d.width,d.height),h.texImage2D(h.TEXTURE_2D,0,l,u,p,d)}else h.texImage2D(h.TEXTURE_2D,0,l,u,p,t);return e?"repeat-x"===n?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE)):"repeat-y"===n?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT)):(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT)):(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE)),i?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),c&&this.enable_mipmaps&&!r?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR),h.generateMipmap(h.TEXTURE_2D)):h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR)):(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST)),h.bindTexture(h.TEXTURE_2D,null),this.lastTexture0=null,a.c2width=t.width,a.c2height=t.height,a.c2refcount=1,a.c2texkey=o,x.push(a),w[o]=a,a},t.prototype.createEmptyTexture=function(t,e,i,s,n){this.endBatch();var r=this.gl;this.isIE&&(s=!1);var o=r.createTexture();return r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,s?r.UNSIGNED_SHORT_4_4_4_4:r.UNSIGNED_BYTE,null),n?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,i?r.LINEAR:r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,null),this.lastTexture0=null,o.c2width=t,o.c2height=e,x.push(o),o},t.prototype.videoToTexture=function(t,e,i){this.endBatch();var s=this.gl;this.isIE&&(i=!1),s.bindTexture(s.TEXTURE_2D,e),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);try{s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,i?s.UNSIGNED_SHORT_4_4_4_4:s.UNSIGNED_BYTE,t)}catch(n){console&&console.error&&console.error("Error updating WebGL texture: ",n)}s.bindTexture(s.TEXTURE_2D,null),this.lastTexture0=null},t.prototype.deleteTexture=function(t){if(t){if("undefined"!=typeof t.c2refcount&&t.c2refcount>1)return void t.c2refcount--;this.endBatch(),t===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),t===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(x,t),"undefined"!=typeof t.c2texkey&&delete w[t.c2texkey],this.gl.deleteTexture(t)}},t.prototype.estimateVRAM=function(){var t,e,i,s=this.width*this.height*4*2;for(t=0,e=x.length;e>t;t++)i=x[t],s+=i.c2width*i.c2height*4;return s},t.prototype.textureCount=function(){return x.length},t.prototype.setRenderingToTexture=function(t){if(t!==this.renderToTex){var e=this.pushBatch();e.type=f,e.texParam=t,this.renderToTex=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},cr.GLWrap=t}(),function(){function t(){return"undefined"!=typeof jQuery?jQuery(window).width():window.innerWidth}function e(){return"undefined"!=typeof jQuery?jQuery(window).height():window.innerHeight}function i(i){if(i&&(i.getContext||i.dc)&&!i.c2runtime){i.c2runtime=this;var s=this;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"==typeof window.c2isCrosswalk||!window.c2isCrosswalk),this.isPhoneGap=this.isCrosswalk||"undefined"!=typeof window.device&&("undefined"!=typeof window.device.cordova||"undefined"!=typeof window.device.phonegap)||"undefined"!=typeof window.c2isphonegap&&window.c2isphonegap,this.isDirectCanvas=!!i.dc,this.isAppMobi="undefined"!=typeof window.AppMobi||this.isDirectCanvas,this.isCocoonJs=!!window.c2cocoonjs,this.isEjecta=!!window.c2ejecta,this.isCocoonJs&&(CocoonJS.App.onSuspended.addEventListener(function(){s.setSuspended(!0)}),CocoonJS.App.onActivated.addEventListener(function(){s.setSuspended(!1)})),this.isEjecta&&(document.addEventListener("pagehide",function(){s.setSuspended(!0)}),document.addEventListener("pageshow",function(){s.setSuspended(!1)}),document.addEventListener("resize",function(){s.setSize(window.innerWidth,window.innerHeight)})),this.isDomFree=this.isDirectCanvas||this.isCocoonJs||this.isEjecta,this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent),this.isTizen=/tizen/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE,this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE,this.isiPad=/ipad/i.test(navigator.userAgent),this.isiOS=this.isiPhone||this.isiPad||this.isEjecta,this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent),this.isChrome=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE,this.isWindows=/windows/i.test(navigator.userAgent),this.isNodeWebkit="undefined"!=typeof window.c2nodewebkit||/nodewebkit/i.test(navigator.userAgent),this.isArcade="undefined"!=typeof window.is_scirra_arcade,this.isWindows8App=!("undefined"==typeof window.c2isWindows8||!window.c2isWindows8),this.isWindows8Capable=!("undefined"==typeof window.c2isWindows8Capable||!window.c2isWindows8Capable),this.isWindowsPhone8=!("undefined"==typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8),this.isWindowsPhone81=!("undefined"==typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81),this.isWinJS=this.isWindows8App||this.isWindows8Capable||this.isWindowsPhone81,this.isBlackberry10=!("undefined"==typeof window.c2isBlackberry10||!window.c2isBlackberry10),this.isAndroidStockBrowser=!(!this.isAndroid||this.isChrome||this.isCrosswalk||this.isFirefox||this.isAmazonWebApp||this.isDomFree),this.devicePixelRatio=1,this.isMobile=this.isPhoneGap||this.isCrosswalk||this.isAppMobi||this.isCocoonJs||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen||this.isEjecta,this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent)),"undefined"==typeof cr_is_preview||this.isNodeWebkit||"?nw"!==window.location.search&&!/nodewebkit/i.test(navigator.userAgent)||(this.isNodeWebkit=!0),this.isDebug="undefined"!=typeof cr_is_preview&&window.location.search.indexOf("debug")>-1,this.canvas=i,this.canvasdiv=document.getElementById("c2canvasdiv"),this.gl=null,this.glwrap=null,this.ctx=null,this.fullscreenOldMarginCss="",this.firstInFullscreen=!1,this.oldWidth=0,this.oldHeight=0,this.canvas.oncontextmenu=function(t){return t.preventDefault&&t.preventDefault(),!1},this.canvas.onselectstart=function(t){return t.preventDefault&&t.preventDefault(),!1},this.isDirectCanvas&&(window.c2runtime=this),this.isNodeWebkit&&(window.ondragover=function(t){return t.preventDefault(),!1},window.ondrop=function(t){return t.preventDefault(),!1},require("nw.gui").App.clearCache()),this.isAndroidStockBrowser&&"undefined"!=typeof jQuery&&jQuery("canvas").parents("*").css("overflow","visible"),this.width=i.width,this.height=i.height,this.draw_width=this.width,this.draw_height=this.height,this.cssWidth=this.width,this.cssHeight=this.height,this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight,this.redraw=!0,this.isSuspended=!1,Date.now||(Date.now=function(){return+new Date}),this.plugins=[],this.types={},this.types_by_index=[],this.behaviors=[],this.layouts={},this.layouts_by_index=[],this.eventsheets={},this.eventsheets_by_index=[],this.wait_for_textures=[],this.triggers_to_postinit=[],this.all_global_vars=[],this.all_local_vars=[],this.solidBehavior=null,this.jumpthruBehavior=null,this.shadowcasterBehavior=null,this.deathRow=new cr.ObjectSet,this.isInClearDeathRow=!1,this.isInOnDestroy=0,this.isRunningEvents=!1,this.createRow=[],this.isLoadingState=!1,this.saveToSlot="",this.loadFromSlot="",this.loadFromJson="",this.lastSaveJson="",this.signalledContinuousPreview=!1,this.suspendDrawing=!1,this.dt=0,this.dt1=0,this.logictime=0,this.cpuutilisation=0,this.zeroDtCount=0,this.timescale=1,this.kahanTime=new cr.KahanAdder,this.wallTime=new cr.KahanAdder,this.last_tick_time=0,this.measuring_dt=!0,this.fps=0,this.last_fps_time=0,this.tickcount=0,this.execcount=0,this.framecount=0,this.objectcount=0,this.changelayout=null,this.destroycallbacks=[],this.event_stack=[],this.event_stack_index=-1,this.localvar_stack=[[]],this.localvar_stack_index=0,this.trigger_depth=0,this.pushEventStack(null),this.loop_stack=[],this.loop_stack_index=-1,this.next_uid=0,this.next_puid=0,this.layout_first_tick=!0,this.family_count=0,this.suspend_events=[],this.raf_id=-1,this.timeout_id=-1,this.isloading=!0,this.loadingprogress=0,this.isNodeFullscreen=!1,this.stackLocalCount=0,this.audioInstance=null,this.halfFramerateMode=!1,this.lastRafTime=0,this.ranLastRaf=!1,this.had_a_click=!1,this.isInUserInputEvent=!1,this.objects_to_pretick=new cr.ObjectSet,this.objects_to_tick=new cr.ObjectSet,this.objects_to_tick2=new cr.ObjectSet,this.registered_collisions=[],this.temp_poly=new cr.CollisionPoly([]),this.temp_poly2=new cr.CollisionPoly([]),this.allGroups=[],this.groups_by_name={},this.cndsBySid={},this.actsBySid={},this.varsBySid={},this.blocksBySid={},this.running_layout=null,this.layer_canvas=null,this.layer_ctx=null,this.layer_tex=null,this.layout_tex=null,this.layout_canvas=null,this.layout_ctx=null,this.is_WebGL_context_lost=!1,this.uses_background_blending=!1,this.fx_tex=[null,null],this.fullscreen_scaling=0,this.files_subfolder="",this.objectsByUid={},this.loaderlogo=null,this.snapshotCanvas=null,this.snapshotData="",this.load(),this.isRetina=(!this.isDomFree||this.isEjecta)&&this.useHighDpi&&!this.isAndroidStockBrowser,this.devicePixelRatio=this.isRetina?window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1:1,this.ClearDeathRow();var n,r=this.alphaBackground&&!(this.isNodeWebkit||this.isWinJS||this.isWindowsPhone8||this.isCrosswalk||this.isPhoneGap);this.fullscreen_mode>0&&this.setSize(t(),e(),!0);try{this.enableWebGL&&(this.isCocoonJs||this.isEjecta||!this.isDomFree)&&(n={alpha:r,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0},this.gl=i.getContext("webgl",n)||i.getContext("experimental-webgl",n))}catch(o){}if(this.gl){this.isDomFree||(this.overlay_canvas=document.createElement("canvas"),jQuery(this.overlay_canvas).appendTo(this.canvas.parentNode),this.overlay_canvas.oncontextmenu=function(){return!1},this.overlay_canvas.onselectstart=function(){return!1},this.overlay_canvas.width=this.cssWidth,this.overlay_canvas.height=this.cssHeight,jQuery(this.overlay_canvas).css({width:this.cssWidth+"px",height:this.cssHeight+"px"}),this.positionOverlayCanvas(),this.overlay_ctx=this.overlay_canvas.getContext("2d")),this.glwrap=new cr.GLWrap(this.gl,this.isMobile),this.glwrap.setSize(i.width,i.height),this.glwrap.enable_mipmaps=0!==this.downscalingQuality,this.ctx=null,this.canvas.addEventListener("webglcontextlost",function(t){t.preventDefault(),s.onContextLost(),console.log("[The Ruchi Game] WebGL context lost"),window.cr_setSuspended(!0)},!1),this.canvas.addEventListener("webglcontextrestored",function(){s.glwrap.initState(),s.glwrap.setSize(s.glwrap.width,s.glwrap.height,!0),s.layer_tex=null,s.layout_tex=null,s.fx_tex[0]=null,s.fx_tex[1]=null,s.onContextRestored(),s.redraw=!0,console.log("[The Ruchi Game] WebGL context restored"),window.cr_setSuspended(!1)},!1);var a,h,c,l,u,p,d,f,g,m;for(a=0,h=this.types_by_index.length;h>a;a++)for(d=this.types_by_index[a],c=0,l=d.effect_types.length;l>c;c++)f=d.effect_types[c],f.shaderindex=this.glwrap.getShaderIndex(f.id),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(f.shaderindex);for(a=0,h=this.layouts_by_index.length;h>a;a++){for(g=this.layouts_by_index[a],c=0,l=g.effect_types.length;l>c;c++)f=g.effect_types[c],f.shaderindex=this.glwrap.getShaderIndex(f.id);for(c=0,l=g.layers.length;l>c;c++)for(m=g.layers[c],u=0,p=m.effect_types.length;p>u;u++)f=m.effect_types[u],f.shaderindex=this.glwrap.getShaderIndex(f.id),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(f.shaderindex)}}else{if(this.fullscreen_mode>0&&this.isDirectCanvas){this.canvas=null,document.oncontextmenu=function(){return!1},document.onselectstart=function(){return!1},this.ctx=AppMobi.canvas.getContext("2d");try{this.ctx.samplingMode=this.linearSampling?"smooth":"sharp",this.ctx.globalScale=1,this.ctx.HTML5CompatibilityMode=!0,this.ctx.imageSmoothingEnabled=this.linearSampling}catch(o){}0!==this.width&&0!==this.height&&(this.ctx.width=this.width,this.ctx.height=this.height)}this.ctx||(this.isCocoonJs?(n={antialias:!!this.linearSampling,alpha:r},this.ctx=i.getContext("2d",n)):(n={alpha:r},this.ctx=i.getContext("2d",n)),this.ctx.webkitImageSmoothingEnabled=this.linearSampling,this.ctx.mozImageSmoothingEnabled=this.linearSampling,this.ctx.msImageSmoothingEnabled=this.linearSampling,this.ctx.imageSmoothingEnabled=this.linearSampling),this.overlay_canvas=null,this.overlay_ctx=null
}this.tickFunc=function(){s.tick(!1)},window==window.top||this.isDomFree||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0)),"undefined"!=typeof cr_is_preview&&(this.isCocoonJs&&console.log("[The Ruchi Game] In preview-over-wifi via CocoonJS mode"),window.location.search.indexOf("continuous")>-1&&(cr.logexport("Reloading for continuous preview"),this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(jQuery(window).focus(function(){s.setSuspended(!1)}),jQuery(window).blur(function(){s.setSuspended(!0)})));var y=function(t){cr.isCanvasInputEvent(t)&&document.activeElement&&document.activeElement.blur&&document.activeElement.blur()};window.navigator.pointerEnabled?document.addEventListener("pointerdown",y):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",y):document.addEventListener("touchstart",y),document.addEventListener("mousedown",y),0===this.fullscreen_mode&&this.isRetina&&this.devicePixelRatio>1&&this.setSize(this.original_width,this.original_height,!0),this.tryLockOrientation(),this.getready(),this.go(),this.extra={},cr.seal(this)}}function s(t){var e=t.target.result;e.createObjectStore("saves",{keyPath:"slot"})}function n(t,e,i,n){var r=indexedDB.open("_C2SaveStates");r.onupgradeneeded=s,r.onerror=n,r.onsuccess=function(s){var r=s.target.result;r.onerror=n;var o=r.transaction(["saves"],"readwrite"),a=o.objectStore("saves"),h=a.put({slot:t,data:e});h.onsuccess=i}}function r(t,e,i){var n=indexedDB.open("_C2SaveStates");n.onupgradeneeded=s,n.onerror=i,n.onsuccess=function(s){var n=s.target.result;n.onerror=i;var r=n.transaction(["saves"]),o=r.objectStore("saves"),a=o.get(t);a.onsuccess=function(){e(a.result?a.result.data:null)}}}function o(){cr.logexport("Reloading for continuous preview"),window.c2cocoonjs?CocoonJS.App.reload():window.location.search.indexOf("continuous")>-1?window.location.reload(!0):window.location=window.location+"?continuous"}function a(t){var e,i={};for(e in t)if(t.hasOwnProperty(e)){if(t[e]instanceof cr.ObjectSet)continue;if(t[e]&&"undefined"!=typeof t[e].c2userdata)continue;i[e]=t[e]}return i}i.prototype.setSize=function(t,e,i){var s=0,n=0,r=0,o=0,a=0,h=this.isiPhoneiOS6&&this.isSafari&&!navigator.standalone&&!this.isDomFree&&!this.isPhoneGap;if(h&&(e+=60),this.lastWindowWidth!==t||this.lastWindowHeight!==e||i){this.lastWindowWidth=t,this.lastWindowHeight=e;var c,l,u=this.fullscreen_mode,p=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isPhoneGap;if(p||0!==this.fullscreen_mode||i){p&&this.fullscreen_scaling>0&&(u=this.fullscreen_scaling);var d=this.devicePixelRatio;u>=4?(c=this.original_width/this.original_height,l=t/e,l>c?(r=e*c,5===u?(a=r*d/this.original_width,a>1?a=Math.floor(a):1>a&&(a=1/Math.ceil(1/a)),r=this.original_width*a/d,o=this.original_height*a/d,s=(t-r)/2,n=(e-o)/2,t=r,e=o):(s=(t-r)/2,t=r)):(o=t/c,5===u?(a=o*d/this.original_height,a>1?a=Math.floor(a):1>a&&(a=1/Math.ceil(1/a)),r=this.original_width*a/d,o=this.original_height*a/d,s=(t-r)/2,n=(e-o)/2,t=r,e=o):(n=(e-o)/2,e=o)),p&&!this.isNodeWebkit&&(s=0,n=0)):this.isNodeWebkit&&this.isNodeFullscreen&&0===this.fullscreen_mode_set&&(s=Math.floor((t-this.original_width)/2),n=Math.floor((e-this.original_height)/2),t=this.original_width,e=this.original_height),2>u&&(this.aspect_scale=d),this.isRetina&&this.isiPad&&d>1&&(t>=1024&&(t=1023),e>=1024&&(e=1023)),this.cssWidth=Math.round(t),this.cssHeight=Math.round(e),this.width=Math.round(t*d),this.height=Math.round(e*d),this.redraw=!0,this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===u?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===u?(c=this.original_width/this.original_height,l=this.lastWindowWidth/this.lastWindowHeight,c>l?this.draw_width=this.draw_height*l:l>c&&(this.draw_height=this.draw_width/l)):3===u&&(c=this.original_width/this.original_height,l=this.lastWindowWidth/this.lastWindowHeight,l>c?this.draw_width=this.draw_height*l:c>l&&(this.draw_height=this.draw_width/l))),this.canvasdiv&&!this.isDomFree&&(jQuery(this.canvasdiv).css({width:Math.round(t)+"px",height:Math.round(e)+"px","margin-left":Math.floor(s)+"px","margin-top":Math.floor(n)+"px"}),"undefined"!=typeof cr_is_preview&&jQuery("#borderwrap").css({width:Math.round(t)+"px",height:Math.round(e)+"px"})),this.canvas&&(this.canvas.width=Math.round(t*d),this.canvas.height=Math.round(e*d),this.isEjecta?(this.canvas.style.left=Math.floor(s)+"px",this.canvas.style.top=Math.floor(n)+"px",this.canvas.style.width=Math.round(t)+"px",this.canvas.style.height=Math.round(e)+"px"):this.isRetina&&!this.isDomFree&&jQuery(this.canvas).css({width:Math.round(t)+"px",height:Math.round(e)+"px"})),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(t),this.overlay_canvas.height=Math.round(e),jQuery(this.overlay_canvas).css({width:Math.round(t)+"px",height:Math.round(e)+"px"})),this.glwrap&&this.glwrap.setSize(Math.round(t*d),Math.round(e*d)),this.isDirectCanvas&&this.ctx&&(this.ctx.width=Math.round(t),this.ctx.height=Math.round(e)),this.ctx&&(this.ctx.webkitImageSmoothingEnabled=this.linearSampling,this.ctx.mozImageSmoothingEnabled=this.linearSampling,this.ctx.msImageSmoothingEnabled=this.linearSampling,this.ctx.imageSmoothingEnabled=this.linearSampling),this.tryLockOrientation(),this.isDomFree||!h&&!this.isiPhone||window.setTimeout(function(){window.scrollTo(0,1)},100)}}},i.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var t="portrait";2===this.orientations&&(t="landscape"),screen.lockOrientation?screen.lockOrientation(t):screen.webkitLockOrientation?screen.webkitLockOrientation(t):screen.mozLockOrientation?screen.mozLockOrientation(t):screen.msLockOrientation&&screen.msLockOrientation(t)}},i.prototype.onContextLost=function(){this.glwrap.contextLost(),this.is_WebGL_context_lost=!0;var t,e,i;for(t=0,e=this.types_by_index.length;e>t;t++)i=this.types_by_index[t],i.onLostWebGLContext&&i.onLostWebGLContext()},i.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var t,e,i;for(t=0,e=this.types_by_index.length;e>t;t++)i=this.types_by_index[t],i.onRestoreWebGLContext&&i.onRestoreWebGLContext()},i.prototype.positionOverlayCanvas=function(){if(!this.isDomFree){var t=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isPhoneGap,e=t?jQuery(this.canvas).offset():jQuery(this.canvas).position();e.position="absolute",jQuery(this.overlay_canvas).css(e)}};var h=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;i.prototype.setSuspended=function(t){var e,i;if(t&&!this.isSuspended)for(cr.logexport("[The Ruchi Game] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&h&&h(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),e=0,i=this.suspend_events.length;i>e;e++)this.suspend_events[e](!0);else if(!t&&this.isSuspended){for(cr.logexport("[The Ruchi Game] Resuming"),this.isSuspended=!1,this.last_tick_time=cr.performance_now(),this.last_fps_time=cr.performance_now(),this.framecount=0,this.logictime=0,e=0,i=this.suspend_events.length;i>e;e++)this.suspend_events[e](!1);this.tick(!1)}},i.prototype.addSuspendCallback=function(t){this.suspend_events.push(t)},i.prototype.load=function(){var t=cr.getProjectModel();this.name=t[0],this.first_layout=t[1],this.fullscreen_mode=t[12],this.fullscreen_mode_set=t[12],this.original_width=t[10],this.original_height=t[11],this.parallax_x_origin=this.original_width/2,this.parallax_y_origin=this.original_height/2,this.isDomFree&&!this.isEjecta&&(t[12]>=4||0===t[12])&&(cr.logexport("[The Ruchi Game] Letterbox scale fullscreen modes are not supported on this platform - falling back to 'Scale outer'"),this.fullscreen_mode=3,this.fullscreen_mode_set=3),this.uses_loader_layout=t[18],this.loaderstyle=t[19],0===this.loaderstyle&&(this.loaderlogo=new Image,this.loaderlogo.src="loading-logo.png"),this.next_uid=t[21],this.system=new cr.system_object(this);var e,i,s,n,r,o,a,h,c,l,u,p;for(e=0,i=t[2].length;i>e;e++)a=t[2][e],cr.add_common_aces(a),u=new a[0](this),u.singleglobal=a[1],u.is_world=a[2],u.must_predraw=a[9],u.onCreate&&u.onCreate(),cr.seal(u),this.plugins.push(u);for(t=cr.getProjectModel(),e=0,i=t[3].length;i>e;e++){for(a=t[3][e],p=a[1],u=null,s=0,n=this.plugins.length;n>s;s++)if(this.plugins[s]instanceof p){u=this.plugins[s];break}var d=new u.Type(u);for(d.name=a[0],d.is_family=a[2],d.instvar_sids=a[3].slice(0),d.vars_count=a[3].length,d.behs_count=a[4],d.fx_count=a[5],d.sid=a[11],d.is_family?(d.members=[],d.family_index=this.family_count++,d.families=null):(d.members=null,d.family_index=-1,d.families=[]),d.family_var_map=null,d.family_beh_map=null,d.family_fx_map=null,d.is_contained=!1,d.container=null,a[6]?(d.texture_file=a[6][0],d.texture_filesize=a[6][1],d.texture_pixelformat=a[6][2]):(d.texture_file=null,d.texture_filesize=0,d.texture_pixelformat=0),d.animations=a[7]?a[7]:null,d.index=e,d.instances=[],d.deadCache=[],d.solstack=[new cr.selection(d)],d.cur_sol=0,d.default_instance=null,d.default_layerindex=0,d.stale_iids=!0,d.updateIIDs=cr.type_updateIIDs,d.getFirstPicked=cr.type_getFirstPicked,d.getPairedInstance=cr.type_getPairedInstance,d.getCurrentSol=cr.type_getCurrentSol,d.pushCleanSol=cr.type_pushCleanSol,d.pushCopySol=cr.type_pushCopySol,d.popSol=cr.type_popSol,d.getBehaviorByName=cr.type_getBehaviorByName,d.getBehaviorIndexByName=cr.type_getBehaviorIndexByName,d.getEffectIndexByName=cr.type_getEffectIndexByName,d.applySolToContainer=cr.type_applySolToContainer,d.getInstanceByIID=cr.type_getInstanceByIID,d.collision_grid=new cr.SparseGrid(this.original_width,this.original_height),d.any_cell_changed=!0,d.any_instance_parallaxed=!1,d.extra={},d.toString=cr.type_toString,d.behaviors=[],s=0,n=a[8].length;n>s;s++){h=a[8][s];var f=h[1],g=null;for(r=0,o=this.behaviors.length;o>r;r++)if(this.behaviors[r]instanceof f){g=this.behaviors[r];break}g||(g=new f(this),g.my_types=[],g.my_instances=new cr.ObjectSet,g.onCreate&&g.onCreate(),cr.seal(g),this.behaviors.push(g),cr.behaviors.solid&&g instanceof cr.behaviors.solid&&(this.solidBehavior=g),cr.behaviors.jumpthru&&g instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=g),cr.behaviors.shadowcaster&&g instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=g)),-1===g.my_types.indexOf(d)&&g.my_types.push(d);var m=new g.Type(g,d);m.name=h[0],m.sid=h[2],m.onCreate(),cr.seal(m),d.behaviors.push(m)}for(d.global=a[9],d.isOnLoaderLayout=a[10],d.effect_types=[],s=0,n=a[12].length;n>s;s++)d.effect_types.push({id:a[12][s][0],name:a[12][s][1],shaderindex:-1,active:!0,index:s});if(d.tile_poly_data=a[13],(!this.uses_loader_layout||d.is_family||d.isOnLoaderLayout||!u.is_world)&&(d.onCreate(),cr.seal(d)),d.name&&(this.types[d.name]=d),this.types_by_index.push(d),u.singleglobal){var y=new u.Instance(d);y.uid=this.next_uid++,y.puid=this.next_puid++,y.iid=0,y.get_iid=cr.inst_get_iid,y.toString=cr.inst_toString,y.properties=a[14],y.onCreate(),cr.seal(y),d.instances.push(y),this.objectsByUid[y.uid.toString()]=y}}for(e=0,i=t[4].length;i>e;e++){var _,v=t[4][e],b=this.types_by_index[v[0]];for(s=1,n=v.length;n>s;s++)_=this.types_by_index[v[s]],_.families.push(b),b.members.push(_)}for(e=0,i=t[27].length;i>e;e++){var x=t[27][e],w=[];for(s=0,n=x.length;n>s;s++)w.push(this.types_by_index[x[s]]);for(s=0,n=w.length;n>s;s++)w[s].is_contained=!0,w[s].container=w}if(this.family_count>0)for(e=0,i=this.types_by_index.length;i>e;e++)if(c=this.types_by_index[e],!c.is_family&&c.families.length){c.family_var_map=new Array(this.family_count),c.family_beh_map=new Array(this.family_count),c.family_fx_map=new Array(this.family_count);var S=[],T=0,k=0,C=0;for(s=0,n=c.families.length;n>s;s++)for(l=c.families[s],c.family_var_map[l.family_index]=T,T+=l.vars_count,c.family_beh_map[l.family_index]=k,k+=l.behs_count,c.family_fx_map[l.family_index]=C,C+=l.fx_count,r=0,o=l.effect_types.length;o>r;r++)S.push(cr.shallowCopy({},l.effect_types[r]));for(c.effect_types=S.concat(c.effect_types),s=0,n=c.effect_types.length;n>s;s++)c.effect_types[s].index=s}for(e=0,i=t[5].length;i>e;e++){a=t[5][e];var O=new cr.layout(this,a);cr.seal(O),this.layouts[O.name]=O,this.layouts_by_index.push(O)}for(e=0,i=t[6].length;i>e;e++){a=t[6][e];var A=new cr.eventsheet(this,a);cr.seal(A),this.eventsheets[A.name]=A,this.eventsheets_by_index.push(A)}for(e=0,i=this.eventsheets_by_index.length;i>e;e++)this.eventsheets_by_index[e].postInit();for(e=0,i=this.eventsheets_by_index.length;i>e;e++)this.eventsheets_by_index[e].updateDeepIncludes();for(e=0,i=this.triggers_to_postinit.length;i>e;e++)this.triggers_to_postinit[e].postInit();this.triggers_to_postinit.length=0,this.audio_to_preload=t[7],this.files_subfolder=t[8],this.pixel_rounding=t[9],this.aspect_scale=1,this.enableWebGL=t[13],this.linearSampling=t[14],this.alphaBackground=t[15],this.versionstr=t[16],this.useHighDpi=t[17],this.orientations=t[20],this.autoLockOrientation=this.orientations>0,this.pauseOnBlur=t[22],this.wantFullscreenScalingQuality=t[23],this.fullscreenScalingQuality=this.wantFullscreenScalingQuality,this.downscalingQuality=t[24],this.preloadSounds=t[25],this.projectName=t[26],this.start_time=Date.now()};var c=!1;i.prototype.waitForImageLoad=function(t){t.onerror=function(e){t.c2error=!0,c=!0,console&&console.error&&console.error("Error loading image '"+t.src+"': ",e)},this.wait_for_textures.push(t)},i.prototype.findWaitingTexture=function(t){var e,i;for(e=0,i=this.wait_for_textures.length;i>e;e++)if(this.wait_for_textures[e].cr_src===t)return this.wait_for_textures[e];return null};var l=0,u=!1;i.prototype.getready=function(){this.audioInstance&&(l=this.audioInstance.setPreloadList(this.audio_to_preload))},i.prototype.areAllTexturesAndSoundsLoaded=function(){var t,e,i,s=l,n=0,r=0,o=!0;for(t=0,e=this.wait_for_textures.length;e>t;t++){i=this.wait_for_textures[t];var a=i.cr_filesize;(!a||0>=a)&&(a=5e4),s+=a,!i.complete&&!i.loaded||i.c2error?o=!1:n+=a}return o&&this.preloadSounds&&this.audioInstance&&(u||(this.audioInstance.startPreloads(),u=!0),r=this.audioInstance.getPreloadedSize(),n+=r,l>r&&(o=!1)),this.progress=0==s?0:n/s,o},i.prototype.go=function(){if(this.ctx||this.glwrap){var t=this.ctx||this.overlay_ctx;if(this.overlay_canvas&&this.positionOverlayCanvas(),this.progress=0,this.last_progress=-1,this.areAllTexturesAndSoundsLoaded())this.go_loading_finished();else{var e=Date.now()-this.start_time;if(t){var i=this.width,s=this.height,n=this.devicePixelRatio;if(this.overlay_canvas&&(i=this.cssWidth,s=this.cssHeight,n=1),3!==this.loaderstyle&&(this.isCocoonJs||e>=500&&this.last_progress!=this.progress)){t.clearRect(0,0,i,s);var r,o=i/2,a=s/2,h=0===this.loaderstyle&&this.loaderlogo.complete,l=40*n,u=0,p=80*n;if(h&&(p=this.loaderlogo.width*n,r=this.loaderlogo.height*n,l=p/2,u=r/2,t.drawImage(this.loaderlogo,cr.floor(o-l),cr.floor(a-u),p,r)),this.loaderstyle<=1)a+=u+(h?12*n:0),o-=l,o=cr.floor(o)+.5,a=cr.floor(a)+.5,t.fillStyle=c?"red":"DodgerBlue",t.fillRect(o,a,Math.floor(p*this.progress),6*n),t.strokeStyle="black",t.strokeRect(o,a,p,6*n),t.strokeStyle="white",t.strokeRect(o-1*n,a-1*n,p+2*n,8*n);else if(2===this.loaderstyle){t.font=this.isEjecta?"12pt ArialMT":"12pt Arial",t.fillStyle=c?"#f00":"#999",t.textBaseLine="middle";var d=Math.round(100*this.progress)+"%",f=t.measureText?t.measureText(d):null,g=f?f.width:0;t.fillText(d,o-g/2,a)}}this.last_progress=this.progress}setTimeout(function(t){return function(){t.go()}}(this),this.isCocoonJs?10:100)}}},i.prototype.go_loading_finished=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_ctx=null,this.overlay_canvas=null),this.start_time=Date.now(),this.last_fps_time=cr.performance_now();var t,e,i;if(this.uses_loader_layout)for(t=0,e=this.types_by_index.length;e>t;t++)i=this.types_by_index[t],i.is_family||i.isOnLoaderLayout||!i.plugin.is_world||(i.onCreate(),cr.seal(i));else this.isloading=!1;for(t=0,e=this.layouts_by_index.length;e>t;t++)this.layouts_by_index[t].createGlobalNonWorlds();if(this.fullscreen_mode>=2){var s=this.original_width/this.original_height,n=this.width/this.height;this.aspect_scale=2!==this.fullscreen_mode&&n>s||2===this.fullscreen_mode&&s>n?this.height/this.original_height:this.width/this.original_width}for(this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning(),this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null)),navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide(),t=0,e=this.types_by_index.length;e>t;t++)i=this.types_by_index[t],i.onAppBegin&&i.onAppBegin();this.tick(!1),this.isDirectCanvas&&AppMobi.webview.execute("onGameReady();")};var p=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;i.prototype.tick=function(i){if(this.running_layout){var s=cr.performance_now();if(this.halfFramerateMode&&this.ranLastRaf&&s-this.lastRafTime<29)return this.ranLastRaf=!1,this.lastRafTime=s,void(p?this.raf_id=p(this.tickFunc,this.canvas):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));this.ranLastRaf=!0,this.lastRafTime=s;var n=this.fullscreen_mode,r=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isPhoneGap;if((r||this.isNodeFullscreen)&&this.fullscreen_scaling>0&&(n=this.fullscreen_scaling),n>0&&(!this.isiOS||window.self!==window.top)){var o=window.innerWidth,a=window.innerHeight;(this.lastWindowWidth!==o||this.lastWindowHeight!==a)&&this.setSize(t(),e())}if(this.isDomFree||(r?(this.firstInFullscreen||(this.fullscreenOldMarginCss=jQuery(this.canvas).css("margin")||"0",this.firstInFullscreen=!0),this.isChrome||this.isNodeWebkit||jQuery(this.canvas).css({"margin-left":""+Math.floor((screen.width-this.width/this.devicePixelRatio)/2)+"px","margin-top":""+Math.floor((screen.height-this.height/this.devicePixelRatio)/2)+"px"})):this.firstInFullscreen?(this.isChrome||this.isNodeWebkit||jQuery(this.canvas).css("margin",this.fullscreenOldMarginCss),this.fullscreenOldMarginCss="",this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height)),this.isloading){var h=this.areAllTexturesAndSoundsLoaded();this.loadingprogress=this.progress,h&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null))}this.logic(),!this.redraw&&!this.isCocoonJs||this.is_WebGL_context_lost||this.suspendDrawing||i||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null)),this.hit_breakpoint||(this.tickcount++,this.execcount++,this.framecount++),this.logictime+=cr.performance_now()-s,this.isSuspended||i||(p?this.raf_id=p(this.tickFunc,this.canvas):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16))}},i.prototype.logic=function(){var t,e,i,s,n,r,o,a,h,c=cr.performance_now();if(c-this.last_fps_time>=1e3&&(this.last_fps_time+=1e3,this.fps=this.framecount,this.framecount=0,this.cpuutilisation=this.logictime,this.logictime=0),this.measuring_dt){if(0!==this.last_tick_time){var l=c-this.last_tick_time;0!==l||this.isDebug?(this.dt1=l/1e3,this.dt1>.5?this.dt1=0:this.dt1>.1&&(this.dt1=.1)):(this.zeroDtCount++,this.zeroDtCout>=10&&(this.measuring_dt=!1),this.dt1=1/60)}this.last_tick_time=c}this.dt=this.dt1*this.timescale,this.kahanTime.add(this.dt),this.wallTime.add(this.dt1);var u=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isPhoneGap;if(this.fullscreen_mode>=2||u&&this.fullscreen_scaling>0){var p=this.original_width/this.original_height,d=this.width/this.height,f=this.fullscreen_mode;u&&this.fullscreen_scaling>0&&(f=this.fullscreen_scaling),this.aspect_scale=2!==f&&d>p||2===f&&p>d?this.height/this.original_height:this.width/this.original_width,this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow(),this.isInOnDestroy++,this.system.runWaits(),this.isInOnDestroy--,this.ClearDeathRow(),this.isInOnDestroy++;var g=this.objects_to_pretick.valuesRef();for(t=0,e=g.length;e>t;t++)g[t].pretick();for(t=0,e=this.types_by_index.length;e>t;t++)if(o=this.types_by_index[t],!o.is_family&&(o.behaviors.length||o.families.length))for(i=0,s=o.instances.length;s>i;i++)for(a=o.instances[i],n=0,r=a.behavior_insts.length;r>n;n++)a.behavior_insts[n].tick();for(t=0,e=this.types_by_index.length;e>t;t++)if(o=this.types_by_index[t],!o.is_family&&(o.behaviors.length||o.families.length))for(i=0,s=o.instances.length;s>i;i++)for(a=o.instances[i],n=0,r=a.behavior_insts.length;r>n;n++)h=a.behavior_insts[n],h.posttick&&h.posttick();for(g=this.objects_to_tick.valuesRef(),t=0,e=g.length;e>t;t++)g[t].tick();for(this.isInOnDestroy--,this.handleSaveLoad(),t=0;this.changelayout&&t++<10;)this.doChangeLayout(this.changelayout);for(t=0,e=this.eventsheets_by_index.length;e>t;t++)this.eventsheets_by_index[t].hasRun=!1;for(this.running_layout.event_sheet&&this.running_layout.event_sheet.run(),this.registered_collisions.length=0,this.layout_first_tick=!1,this.isInOnDestroy++,t=0,e=this.types_by_index.length;e>t;t++)if(o=this.types_by_index[t],!o.is_family&&(o.behaviors.length||o.families.length))for(i=0,s=o.instances.length;s>i;i++){var a=o.instances[i];for(n=0,r=a.behavior_insts.length;r>n;n++)h=a.behavior_insts[n],h.tick2&&h.tick2()}for(g=this.objects_to_tick2.valuesRef(),t=0,e=g.length;e>t;t++)g[t].tick2();this.isInOnDestroy--},i.prototype.doChangeLayout=function(t){var e=this.running_layout;this.running_layout.stopRunning();var i,s,n,r,o,a,h,c,l;if(this.glwrap)for(i=0,s=this.types_by_index.length;s>i;i++)h=this.types_by_index[i],h.is_family||!h.unloadTextures||h.global&&0!==h.instances.length||-1!==t.initial_types.indexOf(h)||h.unloadTextures();for(e==t&&(this.system.waits.length=0),t.startRunning(),i=0,s=this.types_by_index.length;s>i;i++)if(h=this.types_by_index[i],h.global||h.plugin.singleglobal)for(n=0,r=h.instances.length;r>n;n++)if(c=h.instances[n],c.onLayoutChange&&c.onLayoutChange(),c.behavior_insts)for(o=0,a=c.behavior_insts.length;a>o;o++)l=c.behavior_insts[o],l.onLayoutChange&&l.onLayoutChange();this.redraw=!0,this.layout_first_tick=!0,this.ClearDeathRow()},i.prototype.pretickMe=function(t){this.objects_to_pretick.add(t)},i.prototype.unpretickMe=function(t){this.objects_to_pretick.remove(t)},i.prototype.tickMe=function(t){this.objects_to_tick.add(t)},i.prototype.untickMe=function(t){this.objects_to_tick.remove(t)},i.prototype.tick2Me=function(t){this.objects_to_tick2.add(t)},i.prototype.untick2Me=function(t){this.objects_to_tick2.remove(t)},i.prototype.getDt=function(t){return t&&-1!==t.my_timescale?this.dt1*t.my_timescale:this.dt},i.prototype.draw=function(){this.running_layout.draw(this.ctx),this.isDirectCanvas&&this.ctx.present()},i.prototype.drawGL=function(){this.running_layout.drawGL(this.glwrap),this.glwrap.present()},i.prototype.addDestroyCallback=function(t){t&&this.destroycallbacks.push(t)},i.prototype.removeDestroyCallback=function(t){cr.arrayFindRemove(this.destroycallbacks,t)},i.prototype.getObjectByUID=function(t){var e=t.toString();return this.objectsByUid.hasOwnProperty(e)?this.objectsByUid[e]:null},i.prototype.DestroyInstance=function(t){var e,i;if(!this.deathRow.contains(t)){if(this.deathRow.add(t),t.is_contained)for(e=0,i=t.siblings.length;i>e;e++)this.DestroyInstance(t.siblings[e]);this.isInClearDeathRow&&this.deathRow.values_cache.push(t),this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(t.type.plugin).cnds.OnDestroyed,t),this.isInOnDestroy--}},i.prototype.ClearDeathRow=function(){var t,e,i,s,n,r,o,a,h,c,l,u;for(this.isInClearDeathRow=!0,n=0,a=this.createRow.length;a>n;n++)for(t=this.createRow[n],e=t.type,e.instances.push(t),r=0,h=e.families.length;h>r;r++)e.families[r].instances.push(t),e.families[r].stale_iids=!0;this.createRow.length=0;var p=this.deathRow.valuesRef();for(n=0;n<p.length;n++){for(t=p[n],e=t.type,i=e.instances,r=0,h=this.destroycallbacks.length;h>r;r++)this.destroycallbacks[r](t);for(cr.arrayFindRemove(i,t),0===i.length&&(e.any_instance_parallaxed=!1),t.collcells&&e.collision_grid.update(t,t.collcells,null),t.layer&&(cr.arrayRemove(t.layer.instances,t.get_zindex()),t.layer.zindices_stale=!0),r=0,h=e.families.length;h>r;r++)cr.arrayFindRemove(e.families[r].instances,t),e.families[r].stale_iids=!0;if(t.behavior_insts)for(r=0,h=t.behavior_insts.length;h>r;r++)s=t.behavior_insts[r],s.onDestroy&&s.onDestroy(),s.behavior.my_instances.remove(t);for(this.objects_to_pretick.remove(t),this.objects_to_tick.remove(t),this.objects_to_tick2.remove(t),r=0,h=this.system.waits.length;h>r;r++)if(l=this.system.waits[r],l.sols.hasOwnProperty(e.index)&&cr.arrayFindRemove(l.sols[e.index].insts,t),!e.is_family)for(o=0,c=e.families.length;c>o;o++)u=e.families[o],l.sols.hasOwnProperty(u.index)&&cr.arrayFindRemove(l.sols[u.index].insts,t);t.onDestroy&&t.onDestroy(),this.objectsByUid.hasOwnProperty(t.uid.toString())&&delete this.objectsByUid[t.uid.toString()],this.objectcount--,e.deadCache.length<64&&e.deadCache.push(t),e.stale_iids=!0}this.deathRow.isEmpty()||(this.redraw=!0),this.deathRow.clear(),this.isInClearDeathRow=!1},i.prototype.createInstance=function(t,e,i,s){if(t.is_family){var n=cr.floor(Math.random()*t.members.length);return this.createInstance(t.members[n],e,i,s)}return t.default_instance?this.createInstanceFromInit(t.default_instance,e,!1,i,s,!1):null};var d=[];i.prototype.createInstanceFromInit=function(t,e,i,s,n,r){var o,a,h,c,l;if(!t)return null;var u=this.types_by_index[t[1]],p=u.plugin.is_world;if(this.isloading&&p&&!u.isOnLoaderLayout)return null;if(p&&!this.glwrap&&11===t[0][11])return null;var f=e;p||(e=null);var g;for(u.deadCache.length?(g=u.deadCache.pop(),g.recycled=!0,u.plugin.Instance.call(g,u)):(g=new u.plugin.Instance(u),g.recycled=!1),g.uid=i&&!r?t[2]:this.next_uid++,this.objectsByUid[g.uid.toString()]=g,g.puid=this.next_puid++,g.iid=u.instances.length,o=0,a=this.createRow.length;a>o;++o)this.createRow[o].type===u&&g.iid++;g.get_iid=cr.inst_get_iid;var m=t[3];if(g.recycled)cr.wipe(g.extra);else{if(g.extra={},"undefined"!=typeof cr_is_preview)for(g.instance_var_names=[],g.instance_var_names.length=m.length,o=0,a=m.length;a>o;o++)g.instance_var_names[o]=m[o][1];g.instance_vars=[],g.instance_vars.length=m.length}for(o=0,a=m.length;a>o;o++)g.instance_vars[o]=m[o][0];if(p){var y=t[0];if(g.x=cr.is_undefined(s)?y[0]:s,g.y=cr.is_undefined(n)?y[1]:n,g.z=y[2],g.width=y[3],g.height=y[4],g.depth=y[5],g.angle=y[6],g.opacity=y[7],g.hotspotX=y[8],g.hotspotY=y[9],g.blend_mode=y[10],l=y[11],!this.glwrap&&u.effect_types.length&&(g.blend_mode=l),g.compositeOp=cr.effectToCompositeOp(g.blend_mode),this.gl&&cr.setGLBlend(g,g.blend_mode,this.gl),g.recycled){for(o=0,a=y[12].length;a>o;o++)for(h=0,c=y[12][o].length;c>h;h++)g.effect_params[o][h]=y[12][o][h];g.bbox.set(0,0,0,0),g.collcells.set(0,0,-1,-1),g.bquad.set_from_rect(g.bbox),g.bbox_changed_callbacks.length=0}else{for(g.effect_params=y[12].slice(0),o=0,a=g.effect_params.length;a>o;o++)g.effect_params[o]=y[12][o].slice(0);g.active_effect_types=[],g.active_effect_flags=[],g.active_effect_flags.length=u.effect_types.length,g.bbox=new cr.rect(0,0,0,0),g.collcells=new cr.rect(0,0,-1,-1),g.bquad=new cr.quad,g.bbox_changed_callbacks=[],g.set_bbox_changed=cr.set_bbox_changed,g.add_bbox_changed_callback=cr.add_bbox_changed_callback,g.contains_pt=cr.inst_contains_pt,g.update_bbox=cr.update_bbox,g.update_collision_cell=cr.update_collision_cell,g.get_zindex=cr.inst_get_zindex}for(g.tilemap_exists=!1,g.tilemap_width=0,g.tilemap_height=0,g.tilemap_data=null,14===y.length&&(g.tilemap_exists=!0,g.tilemap_width=y[13][0],g.tilemap_height=y[13][1],g.tilemap_data=y[13][2]),o=0,a=u.effect_types.length;a>o;o++)g.active_effect_flags[o]=!0;g.updateActiveEffects=cr.inst_updateActiveEffects,g.updateActiveEffects(),g.uses_shaders=!!g.active_effect_types.length,g.bbox_changed=!0,g.cell_changed=!0,u.any_cell_changed=!0,g.visible=!0,g.my_timescale=-1,g.layer=e,g.zindex=e.instances.length,"undefined"==typeof g.collision_poly&&(g.collision_poly=null),g.collisionsEnabled=!0,this.redraw=!0}g.toString=cr.inst_toString;var _,v;for(d.length=0,o=0,a=u.families.length;a>o;o++)d.push.apply(d,u.families[o].behaviors);if(d.push.apply(d,u.behaviors),g.recycled)for(o=0,a=d.length;a>o;o++){var b=d[o];for(v=g.behavior_insts[o],v.recycled=!0,b.behavior.Instance.call(v,b,g),_=t[4][o],h=0,c=_.length;c>h;h++)v.properties[h]=_[h];v.onCreate(),b.behavior.my_instances.add(g)}else for(g.behavior_insts=[],o=0,a=d.length;a>o;o++){var b=d[o],v=new b.behavior.Instance(b,g);v.recycled=!1,v.properties=t[4][o].slice(0),v.onCreate(),cr.seal(v),g.behavior_insts.push(v),b.behavior.my_instances.add(g)}if(_=t[5],g.recycled)for(o=0,a=_.length;a>o;o++)g.properties[o]=_[o];else g.properties=_.slice(0);if(this.createRow.push(g),e&&(e.instances.push(g),(1!==e.parallaxX||1!==e.parallaxY)&&(u.any_instance_parallaxed=!0)),this.objectcount++,u.is_contained){if(g.is_contained=!0,g.recycled?g.siblings.length=0:g.siblings=[],!i&&!r){for(o=0,a=u.container.length;a>o;o++)if(u.container[o]!==u){if(!u.container[o].default_instance)return null;g.siblings.push(this.createInstanceFromInit(u.container[o].default_instance,f,!1,p?g.x:s,p?g.y:n,!0))}for(o=0,a=g.siblings.length;a>o;o++)for(g.siblings[o].siblings.push(g),h=0;a>h;h++)o!==h&&g.siblings[o].siblings.push(g.siblings[h])}}else g.is_contained=!1,g.siblings=null;for(g.onCreate(),g.recycled||cr.seal(g),o=0,a=g.behavior_insts.length;a>o;o++)g.behavior_insts[o].postCreate&&g.behavior_insts[o].postCreate();return g},i.prototype.getLayerByName=function(t){var e,i;for(e=0,i=this.running_layout.layers.length;i>e;e++){var s=this.running_layout.layers[e];if(cr.equals_nocase(s.name,t))return s}return null},i.prototype.getLayerByNumber=function(t){return t=cr.floor(t),0>t&&(t=0),t>=this.running_layout.layers.length&&(t=this.running_layout.layers.length-1),this.running_layout.layers[t]},i.prototype.getLayer=function(t){return cr.is_number(t)?this.getLayerByNumber(t):this.getLayerByName(t.toString())},i.prototype.clearSol=function(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].getCurrentSol().select_all=!0},i.prototype.pushCleanSol=function(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].pushCleanSol()},i.prototype.pushCopySol=function(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].pushCopySol()},i.prototype.popSol=function(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].popSol()},i.prototype.updateAllCells=function(t){if(t.any_cell_changed){var e,i,s=t.instances;for(e=0,i=s.length;i>e;++e)s[e].update_collision_cell();var n=this.createRow;for(e=0,i=n.length;i>e;++e)n[e].type===t&&n[e].update_collision_cell();t.any_cell_changed=!1}},i.prototype.getCollisionCandidates=function(t,e,i,s){var n,r,o,a=t?1!==t.parallaxX||1!==t.parallaxY:!1;if(e.is_family)for(n=0,r=e.members.length;r>n;++n)o=e.members[n],a||o.any_instance_parallaxed?cr.appendArray(s,o.instances):(this.updateAllCells(o),o.collision_grid.queryRange(i,s));
else a||e.any_instance_parallaxed?cr.appendArray(s,e.instances):(this.updateAllCells(e),e.collision_grid.queryRange(i,s))},i.prototype.getTypesCollisionCandidates=function(t,e,i,s){var n,r;for(n=0,r=e.length;r>n;++n)this.getCollisionCandidates(t,e[n],i,s)},i.prototype.getSolidCollisionCandidates=function(t,e,i){var s=this.getSolidBehavior();return s?void this.getTypesCollisionCandidates(t,s.my_types,e,i):null},i.prototype.getJumpthruCollisionCandidates=function(t,e,i){var s=this.getJumpthruBehavior();return s?void this.getTypesCollisionCandidates(t,s.my_types,e,i):null},i.prototype.testAndSelectCanvasPointOverlap=function(t,e,i,s){var n,r,o,a,h,c,l=t.getCurrentSol();if(l.select_all){for(s||(l.select_all=!1,l.instances.length=0),n=0,a=t.instances.length;a>n;n++)if(o=t.instances[n],o.update_bbox(),h=o.layer.canvasToLayer(e,i,!0),c=o.layer.canvasToLayer(e,i,!1),o.contains_pt(h,c)){if(s)return!1;l.instances.push(o)}}else{for(r=0,n=0,a=l.instances.length;a>n;n++)if(o=l.instances[n],o.update_bbox(),h=o.layer.canvasToLayer(e,i,!0),c=o.layer.canvasToLayer(e,i,!1),o.contains_pt(h,c)){if(s)return!1;l.instances[r]=l.instances[n],r++}s||(l.instances.length=r)}return t.applySolToContainer(),s?!0:l.hasObjects()},i.prototype.testOverlap=function(t,e){if(!(t&&e&&t!==e&&t.collisionsEnabled&&e.collisionsEnabled))return!1;t.update_bbox(),e.update_bbox();var i,s,n,r,o,a,h,c,l,u,p=t.layer,d=e.layer,f=p!==d&&(p.parallaxX!==d.parallaxX||d.parallaxY!==d.parallaxY||p.scale!==d.scale||p.angle!==d.angle||p.zoomRate!==d.zoomRate);if(f){for(h=t.collision_poly&&!t.collision_poly.is_empty(),c=e.collision_poly&&!e.collision_poly.is_empty(),h?(t.collision_poly.cache_poly(t.width,t.height,t.angle),this.temp_poly.set_from_poly(t.collision_poly)):this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height),l=this.temp_poly,c?(e.collision_poly.cache_poly(e.width,e.height,e.angle),this.temp_poly2.set_from_poly(e.collision_poly)):this.temp_poly2.set_from_quad(e.bquad,e.x,e.y,e.width,e.height),u=this.temp_poly2,i=0,s=l.pts_count;s>i;i++)n=2*i,r=n+1,o=l.pts_cache[n],a=l.pts_cache[r],l.pts_cache[n]=p.layerToCanvas(o+t.x,a+t.y,!0),l.pts_cache[r]=p.layerToCanvas(o+t.x,a+t.y,!1);for(l.update_bbox(),i=0,s=u.pts_count;s>i;i++)n=2*i,r=n+1,o=u.pts_cache[n],a=u.pts_cache[r],u.pts_cache[n]=d.layerToCanvas(o+e.x,a+e.y,!0),u.pts_cache[r]=d.layerToCanvas(o+e.x,a+e.y,!1);return u.update_bbox(),l.intersects_poly(u,0,0)}return t.bbox.intersects_rect(e.bbox)&&t.bquad.intersects_quad(e.bquad)?t.tilemap_exists&&e.tilemap_exists?!1:t.tilemap_exists?this.testTilemapOverlap(t,e):e.tilemap_exists?this.testTilemapOverlap(e,t):(h=t.collision_poly&&!t.collision_poly.is_empty(),c=e.collision_poly&&!e.collision_poly.is_empty(),h||c?(h?(t.collision_poly.cache_poly(t.width,t.height,t.angle),l=t.collision_poly):(this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height),l=this.temp_poly),c?(e.collision_poly.cache_poly(e.width,e.height,e.angle),u=e.collision_poly):(this.temp_poly.set_from_quad(e.bquad,e.x,e.y,e.width,e.height),u=this.temp_poly),l.intersects_poly(u,e.x-t.x,e.y-t.y)):!0):!1};var f=new cr.quad,g=new cr.rect(0,0,0,0),m=[];i.prototype.testTilemapOverlap=function(t,e){var i,s,n,r,o=e.bbox,a=t.x,h=t.y;t.getCollisionRectCandidates(o,m);var c=m,l=e.collision_poly&&!e.collision_poly.is_empty();for(i=0,s=c.length;s>i;++i)if(n=c[i],r=n.rc,o.intersects_rect_off(r,a,h)&&(f.set_from_rect(r),f.offset(a,h),f.intersects_quad(e.bquad)))if(l){if(e.collision_poly.cache_poly(e.width,e.height,e.angle),n.poly){if(n.poly.intersects_poly(e.collision_poly,e.x-(a+r.left),e.y-(h+r.top)))return m.length=0,!0}else if(this.temp_poly.set_from_quad(f,0,0,r.right-r.left,r.bottom-r.top),this.temp_poly.intersects_poly(e.collision_poly,e.x,e.y))return m.length=0,!0}else{if(!n.poly)return m.length=0,!0;if(this.temp_poly.set_from_quad(e.bquad,0,0,e.width,e.height),n.poly.intersects_poly(this.temp_poly,-(a+r.left),-(h+r.top)))return m.length=0,!0}return m.length=0,!1},i.prototype.testRectOverlap=function(t,e){if(!e||!e.collisionsEnabled)return!1;e.update_bbox();{var i;e.layer}if(!e.bbox.intersects_rect(t))return!1;if(e.tilemap_exists){e.getCollisionRectCandidates(t,m);var s,n,r,o,a=m,h=e.x,c=e.y;for(s=0,n=a.length;n>s;++s)if(r=a[s],o=r.rc,t.intersects_rect_off(o,h,c)){if(!r.poly)return m.length=0,!0;if(this.temp_poly.set_from_rect(t,0,0),r.poly.intersects_poly(this.temp_poly,-(h+o.left),-(c+o.top)))return m.length=0,!0}return m.length=0,!1}return f.set_from_rect(t),e.bquad.intersects_quad(f)?(i=e.collision_poly&&!e.collision_poly.is_empty())?(e.collision_poly.cache_poly(e.width,e.height,e.angle),f.offset(-t.left,-t.top),this.temp_poly.set_from_quad(f,0,0,1,1),e.collision_poly.intersects_poly(this.temp_poly,t.left-e.x,t.top-e.y)):!0:!1},i.prototype.testSegmentOverlap=function(t,e,i,s,n){if(!n||!n.collisionsEnabled)return!1;n.update_bbox();{var r;n.layer}if(g.set(cr.min(t,i),cr.min(e,s),cr.max(t,i),cr.max(e,s)),!n.bbox.intersects_rect(g))return!1;if(n.tilemap_exists){n.getCollisionRectCandidates(g,m);var o,a,h,c,l=m,u=n.x,p=n.y;for(o=0,a=l.length;a>o;++o)if(h=l[o],c=h.rc,g.intersects_rect_off(c,u,p)&&(f.set_from_rect(c),f.offset(u,p),f.intersects_segment(t,e,i,s))){if(!h.poly)return m.length=0,!0;if(h.poly.intersects_segment(u+c.left,p+c.top,t,e,i,s))return m.length=0,!0}return m.length=0,!1}return n.bquad.intersects_segment(t,e,i,s)?(r=n.collision_poly&&!n.collision_poly.is_empty())?(n.collision_poly.cache_poly(n.width,n.height,n.angle),n.collision_poly.intersects_segment(n.x,n.y,t,e,i,s)):!0:!1},i.prototype.typeHasBehavior=function(t,e){if(!e)return!1;var i,s,n,r,o;for(i=0,s=t.behaviors.length;s>i;i++)if(t.behaviors[i].behavior instanceof e)return!0;if(!t.is_family)for(i=0,s=t.families.length;s>i;i++)for(o=t.families[i],n=0,r=o.behaviors.length;r>n;n++)if(o.behaviors[n].behavior instanceof e)return!0;return!1},i.prototype.typeHasNoSaveBehavior=function(t){return this.typeHasBehavior(t,cr.behaviors.NoSave)},i.prototype.typeHasPersistBehavior=function(t){return this.typeHasBehavior(t,cr.behaviors.Persist)},i.prototype.getSolidBehavior=function(){return this.solidBehavior},i.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var y=[];i.prototype.testOverlapSolid=function(t){var e,i,s;for(t.update_bbox(),this.getSolidCollisionCandidates(t.layer,t.bbox,y),e=0,i=y.length;i>e;++e)if(s=y[e],s.extra.solidEnabled&&this.testOverlap(t,s))return y.length=0,s;return y.length=0,null},i.prototype.testRectOverlapSolid=function(t){var e,i,s;for(this.getSolidCollisionCandidates(null,t,y),e=0,i=y.length;i>e;++e)if(s=y[e],s.extra.solidEnabled&&this.testRectOverlap(t,s))return y.length=0,s;return y.length=0,null};var _=[];i.prototype.testOverlapJumpThru=function(t,e){var i=null;e&&(i=_,i.length=0),t.update_bbox(),this.getJumpthruCollisionCandidates(t.layer,t.bbox,y);var s,n,r;for(s=0,n=y.length;n>s;++s)if(r=y[s],r.extra.jumpthruEnabled&&this.testOverlap(t,r)){if(!e)return y.length=0,r;i.push(r)}return y.length=0,i},i.prototype.pushOutSolid=function(t,e,i,s,n,r){var o,a=s||50,h=t.x,c=t.y,l=null,u=null;for(o=0;a>o;o++)if(t.x=h+e*o,t.y=c+i*o,t.set_bbox_changed(),!this.testOverlap(t,l)&&(l=this.testOverlapSolid(t),l&&(u=l),!l&&(n&&(l=r?this.testOverlap(t,r)?r:null:this.testOverlapJumpThru(t),l&&(u=l)),!l)))return u&&this.pushInFractional(t,e,i,u,16),!0;return t.x=h,t.y=c,t.set_bbox_changed(),!1},i.prototype.pushOut=function(t,e,i,s,n){var r,o=s||50,a=t.x,h=t.y;for(r=0;o>r;r++)if(t.x=a+e*r,t.y=h+i*r,t.set_bbox_changed(),!this.testOverlap(t,n))return!0;return t.x=a,t.y=h,t.set_bbox_changed(),!1},i.prototype.pushInFractional=function(t,e,i,s,n){for(var r,o=2,a=!1,h=!1,c=t.x,l=t.y;n>=o;)r=1/o,o*=2,t.x+=e*r*(a?1:-1),t.y+=i*r*(a?1:-1),t.set_bbox_changed(),this.testOverlap(t,s)?(a=!0,h=!0):(a=!1,h=!1,c=t.x,l=t.y);h&&(t.x=c,t.y=l,t.set_bbox_changed())},i.prototype.pushOutSolidNearest=function(t,e){var i=cr.is_undefined(e)?100:e,s=0,n=t.x,r=t.y,o=0,a=0,h=0,c=this.testOverlapSolid(t);if(!c)return!0;for(;i>=s;){switch(o){case 0:a=0,h=-1,s++;break;case 1:a=1,h=-1;break;case 2:a=1,h=0;break;case 3:a=1,h=1;break;case 4:a=0,h=1;break;case 5:a=-1,h=1;break;case 6:a=-1,h=0;break;case 7:a=-1,h=-1}if(o=(o+1)%8,t.x=cr.floor(n+a*s),t.y=cr.floor(r+h*s),t.set_bbox_changed(),!this.testOverlap(t,c)&&(c=this.testOverlapSolid(t),!c))return!0}return t.x=n,t.y=r,t.set_bbox_changed(),!1},i.prototype.registerCollision=function(t,e){t.collisionsEnabled&&e.collisionsEnabled&&this.registered_collisions.push([t,e])},i.prototype.checkRegisteredCollision=function(t,e){var i,s,n;for(i=0,s=this.registered_collisions.length;s>i;i++)if(n=this.registered_collisions[i],n[0]==t&&n[1]==e||n[0]==e&&n[1]==t)return!0;return!1},i.prototype.calculateSolidBounceAngle=function(t,e,i,s){var n=t.x,r=t.y,o=cr.max(10,cr.distanceTo(e,i,n,r)),a=cr.angleTo(e,i,n,r),h=s||this.testOverlapSolid(t);if(!h)return cr.clamp_angle(a+cr.PI);var c,l,u,p,d=h,f=cr.to_radians(5);for(c=1;36>c;c++)if(l=a-c*f,t.x=e+Math.cos(l)*o,t.y=i+Math.sin(l)*o,t.set_bbox_changed(),!this.testOverlap(t,d)&&(d=s?null:this.testOverlapSolid(t),!d)){u=l;break}36===c&&(u=cr.clamp_angle(a+cr.PI));var d=h;for(c=1;36>c;c++)if(l=a+c*f,t.x=e+Math.cos(l)*o,t.y=i+Math.sin(l)*o,t.set_bbox_changed(),!this.testOverlap(t,d)&&(d=s?null:this.testOverlapSolid(t),!d)){p=l;break}if(36===c&&(p=cr.clamp_angle(a+cr.PI)),t.x=n,t.y=r,t.set_bbox_changed(),p===u)return p;var g,m=cr.angleDiff(p,u)/2;g=cr.clamp_angle(cr.angleClockwise(p,u)?u+m+cr.PI:p+m);var y=Math.cos(a),_=Math.sin(a),v=Math.cos(g),b=Math.sin(g),x=y*v+_*b,w=y-2*x*v,S=_-2*x*b;return cr.angleTo(0,0,w,S)};var v=-1;i.prototype.trigger=function(t,e,i){if(!this.running_layout)return!1;var s=this.running_layout.event_sheet;if(!s)return!1;var n,r,o,a=!1;v++;var h=s.deep_includes;for(r=0,o=h.length;o>r;++r)n=this.triggerOnSheet(t,e,h[r],i),a=a||n;return n=this.triggerOnSheet(t,e,s,i),a=a||n,v--,a},i.prototype.triggerOnSheet=function(t,e,i,s){var n,r,o,a,h=!1;if(e)for(o=this.triggerOnSheetForTypeName(t,e,e.type.name,i,s),h=h||o,a=e.type.families,n=0,r=a.length;r>n;++n)o=this.triggerOnSheetForTypeName(t,e,a[n].name,i,s),h=h||o;else o=this.triggerOnSheetForTypeName(t,e,"system",i,s),h=h||o;return h},i.prototype.triggerOnSheetForTypeName=function(t,e,i,s,n){var r,o,a,h,c=!1,l=!1,u="undefined"!=typeof n,p=u?s.fasttriggers:s.triggers,d=p[i];if(!d)return c;var f=null;for(r=0,o=d.length;o>r;++r)if(d[r].method==t){f=d[r].evs;break}if(!f)return c;var g;if(g=u?f[n]:f,!g)return null;for(r=0,o=g.length;o>r;r++)a=g[r][0],h=g[r][1],l=this.executeSingleTrigger(e,i,a,h),c=c||l;return c},i.prototype.executeSingleTrigger=function(t,e,i,s){var n,r,o=!1;this.trigger_depth++;var a=this.getCurrentEventStack().current_event;a&&this.pushCleanSol(a.solModifiersIncludingParents);var h=this.trigger_depth>1;this.pushCleanSol(i.solModifiersIncludingParents),h&&this.pushLocalVarStack();var c=this.pushEventStack(i);if(c.current_event=i,t){var l=this.types[e].getCurrentSol();l.select_all=!1,l.instances.length=1,l.instances[0]=t,this.types[e].applySolToContainer()}var u=!0;if(i.parent){for(var p=c.temp_parents_arr,d=i.parent;d;)p.push(d),d=d.parent;for(p.reverse(),n=0,r=p.length;r>n;n++)if(!p[n].run_pretrigger()){u=!1;break}}return u&&(this.execcount++,i.orblock?i.run_orblocktrigger(s):i.run(),o=o||c.last_event_true),this.popEventStack(),h&&this.popLocalVarStack(),this.popSol(i.solModifiersIncludingParents),a&&this.popSol(a.solModifiersIncludingParents),0!==this.isInOnDestroy||0!==v||this.isRunningEvents||this.deathRow.isEmpty()&&!this.createRow.length||this.ClearDeathRow(),this.trigger_depth--,o},i.prototype.getCurrentCondition=function(){var t=this.getCurrentEventStack();return t.current_event.conditions[t.cndindex]},i.prototype.getCurrentAction=function(){var t=this.getCurrentEventStack();return t.current_event.actions[t.actindex]},i.prototype.pushLocalVarStack=function(){this.localvar_stack_index++,this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])},i.prototype.popLocalVarStack=function(){this.localvar_stack_index--},i.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]},i.prototype.pushEventStack=function(t){this.event_stack_index++,this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var e=this.getCurrentEventStack();return e.reset(t),e},i.prototype.popEventStack=function(){this.event_stack_index--},i.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]},i.prototype.pushLoopStack=function(t){this.loop_stack_index++,this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:t,index:0,stopped:!1}));var e=this.getCurrentLoop();return e.name=t,e.index=0,e.stopped=!1,e},i.prototype.popLoopStack=function(){this.loop_stack_index--},i.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]},i.prototype.getEventVariableByName=function(t,e){for(var i,s,n,r,o,a;e;){for(i=0,s=e.subevents.length;s>i;i++)if(a=e.subevents[i],a instanceof cr.eventvariable&&cr.equals_nocase(t,a.name))return a;e=e.parent}for(i=0,s=this.eventsheets_by_index.length;s>i;i++)for(o=this.eventsheets_by_index[i],n=0,r=o.events.length;r>n;n++)if(a=o.events[n],a instanceof cr.eventvariable&&cr.equals_nocase(t,a.name))return a;return null},i.prototype.getLayoutBySid=function(t){var e,i;for(e=0,i=this.layouts_by_index.length;i>e;e++)if(this.layouts_by_index[e].sid===t)return this.layouts_by_index[e];return null},i.prototype.getObjectTypeBySid=function(t){var e,i;for(e=0,i=this.types_by_index.length;i>e;e++)if(this.types_by_index[e].sid===t)return this.types_by_index[e];return null},i.prototype.getGroupBySid=function(t){var e,i;for(e=0,i=this.allGroups.length;i>e;e++)if(this.allGroups[e].sid===t)return this.allGroups[e];return null},i.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0},i.prototype.handleSaveLoad=function(){var t=this,e=this.saveToSlot,i=this.lastSaveJson,s=this.loadFromSlot,a=!1;if(this.signalledContinuousPreview&&(a=!0,e="__c2_continuouspreview",this.signalledContinuousPreview=!1),e.length){if(this.ClearDeathRow(),i=this.saveToJSONString(),window.indexedDB&&!this.isCocoonJs)n(e,i,function(){cr.logexport("Saved state to IndexedDB storage ("+i.length+" bytes)"),t.lastSaveJson=i,t.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",a&&o()},function(s){try{localStorage.setItem("__c2save_"+e,i),cr.logexport("Saved state to WebStorage ("+i.length+" bytes)"),t.lastSaveJson=i,t.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",a&&o()}catch(n){cr.logexport("Failed to save game state: "+s+"; "+n)}});else try{localStorage.setItem("__c2save_"+e,i),cr.logexport("Saved state to WebStorage ("+i.length+" bytes)"),t.lastSaveJson=i,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",a&&o()}catch(h){cr.logexport("Error saving to WebStorage: "+h)}this.saveToSlot="",this.loadFromSlot="",this.loadFromJson=""}s.length&&(window.indexedDB&&!this.isCocoonJs?r(s,function(e){e?(t.loadFromJson=e,cr.logexport("Loaded state from IndexedDB storage ("+t.loadFromJson.length+" bytes)")):(t.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+t.loadFromJson.length+" bytes)")),t.suspendDrawing=!1,t.loadFromJson.length||t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null)},function(){t.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+t.loadFromJson.length+" bytes)"),t.suspendDrawing=!1,t.loadFromJson.length||t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null)}):(this.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)"),this.suspendDrawing=!1,t.loadFromJson.length||t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null)),this.loadFromSlot="",this.saveToSlot=""),this.loadFromJson.length&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson),this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson="",this.loadFromJson="")},i.prototype.saveToJSONString=function(){var t,e,i,s,n,r,o,h,c,l,u,p,d={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};for(t=0,e=this.types_by_index.length;e>t;t++)if(n=this.types_by_index[t],!n.is_family&&!this.typeHasNoSaveBehavior(n)){for(o={instances:[]},cr.hasAnyOwnProperty(n.extra)&&(o.ex=a(n.extra)),i=0,s=n.instances.length;s>i;i++)o.instances.push(this.saveInstanceToJSON(n.instances[i]));d.types[n.sid.toString()]=o}for(t=0,e=this.layouts_by_index.length;e>t;t++)r=this.layouts_by_index[t],d.layouts[r.sid.toString()]=r.saveToJSON();var f=d.events.groups;for(t=0,e=this.allGroups.length;e>t;t++)h=this.allGroups[t],f[h.sid.toString()]=this.groups_by_name[h.group_name].group_active;var g=d.events.cnds;for(p in this.cndsBySid)this.cndsBySid.hasOwnProperty(p)&&(c=this.cndsBySid[p],cr.hasAnyOwnProperty(c.extra)&&(g[p]={ex:a(c.extra)}));var m=d.events.acts;for(p in this.actsBySid)this.actsBySid.hasOwnProperty(p)&&(l=this.actsBySid[p],cr.hasAnyOwnProperty(l.extra)&&(m[p]={ex:l.extra}));var y=d.events.vars;for(p in this.varsBySid)this.varsBySid.hasOwnProperty(p)&&(u=this.varsBySid[p],u.is_constant||u.parent&&!u.is_static||(y[p]=u.data));return d.system=this.system.saveToJSON(),JSON.stringify(d)},i.prototype.refreshUidMap=function(){var t,e,i,s,n,r;for(this.objectsByUid={},t=0,e=this.types_by_index.length;e>t;t++)if(i=this.types_by_index[t],!i.is_family)for(s=0,n=i.instances.length;n>s;s++)r=i.instances[s],this.objectsByUid[r.uid.toString()]=r},i.prototype.loadFromJSONString=function(t){var e=JSON.parse(t);if(e.c2save&&!(e.version>1)){var i=e.rt;this.kahanTime.reset(),this.kahanTime.sum=i.time,this.wallTime.reset(),this.wallTime.sum=i.walltime||0,this.timescale=i.timescale,this.tickcount=i.tickcount,this.start_time=Date.now()-i.start_time_offset;var s=i.running_layout;if(s!==this.running_layout.sid){var n=this.getLayoutBySid(s);if(!n)return;this.doChangeLayout(n)}this.isLoadingState=!0;var r,o,a,h,c,l,u,p,d,f,g,m,y,_,v,b,x,w=e.types;for(u in w)if(w.hasOwnProperty(u)){if(p=this.getObjectTypeBySid(parseInt(u,10)),!p||p.is_family||this.typeHasNoSaveBehavior(p))continue;for(w[u].ex?p.extra=w[u].ex:cr.wipe(p.extra),d=p.instances,f=w[u].instances,r=0,o=cr.min(d.length,f.length);o>r;r++)this.loadInstanceFromJSON(d[r],f[r]);for(r=f.length,o=d.length;o>r;r++)this.DestroyInstance(d[r]);for(r=d.length,o=f.length;o>r;r++)_=null,(!p.plugin.is_world||(_=this.running_layout.getLayerBySid(f[r].w.l)))&&(g=this.createInstanceFromInit(p.default_instance,_,!1,0,0,!0),this.loadInstanceFromJSON(g,f[r]));p.stale_iids=!0}this.ClearDeathRow(),this.refreshUidMap();var S=e.layouts;for(u in S)if(S.hasOwnProperty(u)){if(y=this.getLayoutBySid(parseInt(u,10)),!y)continue;y.loadFromJSON(S[u])}var T=e.events.groups;for(u in T)T.hasOwnProperty(u)&&(v=this.getGroupBySid(parseInt(u,10)),v&&this.groups_by_name[v.group_name]&&(this.groups_by_name[v.group_name].group_active=T[u]));var k=e.events.cnds;for(u in k)k.hasOwnProperty(u)&&this.cndsBySid.hasOwnProperty(u)&&(this.cndsBySid[u].extra=k[u].ex);var C=e.events.acts;for(u in C)C.hasOwnProperty(u)&&this.actsBySid.hasOwnProperty(u)&&(this.actsBySid[u].extra=C[u].ex);var O=e.events.vars;for(u in O)O.hasOwnProperty(u)&&this.varsBySid.hasOwnProperty(u)&&(this.varsBySid[u].data=O[u]);for(this.next_uid=i.next_uid,this.isLoadingState=!1,this.system.loadFromJSON(e.system),r=0,o=this.types_by_index.length;o>r;r++)if(p=this.types_by_index[r],!p.is_family)for(a=0,h=p.instances.length;h>a;a++){if(g=p.instances[a],p.is_contained)for(b=g.get_iid(),g.siblings.length=0,c=0,l=p.container.length;l>c;c++)x=p.container[c],p!==x&&g.siblings.push(x.instances[b]);if(g.afterLoad&&g.afterLoad(),g.behavior_insts)for(c=0,l=g.behavior_insts.length;l>c;c++)m=g.behavior_insts[c],m.afterLoad&&m.afterLoad()}this.redraw=!0}},i.prototype.saveInstanceToJSON=function(t,e){var i,s,n,r,o,h=t.type,c=h.plugin,l={};if(e?l.c2=!0:l.uid=t.uid,cr.hasAnyOwnProperty(t.extra)&&(l.ex=a(t.extra)),t.instance_vars&&t.instance_vars.length)for(l.ivs={},i=0,s=t.instance_vars.length;s>i;i++)l.ivs[t.type.instvar_sids[i].toString()]=t.instance_vars[i];if(c.is_world){if(n={x:t.x,y:t.y,w:t.width,h:t.height,l:t.layer.sid,zi:t.get_zindex()},0!==t.angle&&(n.a=t.angle),1!==t.opacity&&(n.o=t.opacity),.5!==t.hotspotX&&(n.hX=t.hotspotX),.5!==t.hotspotY&&(n.hY=t.hotspotY),0!==t.blend_mode&&(n.bm=t.blend_mode),t.visible||(n.v=t.visible),t.collisionsEnabled||(n.ce=t.collisionsEnabled),-1!==t.my_timescale&&(n.mts=t.my_timescale),h.effect_types.length)for(n.fx=[],i=0,s=h.effect_types.length;s>i;i++)o=h.effect_types[i],n.fx.push({name:o.name,active:t.active_effect_flags[o.index],params:t.effect_params[o.index]});l.w=n}if(t.behavior_insts&&t.behavior_insts.length)for(l.behs={},i=0,s=t.behavior_insts.length;s>i;i++)r=t.behavior_insts[i],r.saveToJSON&&(l.behs[r.type.sid.toString()]=r.saveToJSON());return t.saveToJSON&&(l.data=t.saveToJSON()),l},i.prototype.getInstanceVarIndexBySid=function(t,e){var i,s;for(i=0,s=t.instvar_sids.length;s>i;i++)if(t.instvar_sids[i]===e)return i;return-1},i.prototype.getBehaviorIndexBySid=function(t,e){var i,s;for(i=0,s=t.behavior_insts.length;s>i;i++)if(t.behavior_insts[i].type.sid===e)return i;return-1},i.prototype.loadInstanceFromJSON=function(t,e,i){var s,n,r,o,a,h,c,l,u,p,d=t.type,f=d.plugin;if(i){if(!e.c2)return}else t.uid=e.uid;if(e.ex?t.extra=e.ex:cr.wipe(t.extra),a=e.ivs)for(s in a)if(a.hasOwnProperty(s)){if(o=this.getInstanceVarIndexBySid(d,parseInt(s,10)),0>o||o>=t.instance_vars.length)continue;t.instance_vars[o]=a[s]}if(f.is_world){if(h=e.w,t.layer.sid!==h.l&&(p=t.layer,t.layer=this.running_layout.getLayerBySid(h.l),t.layer?(t.layer.instances.push(t),t.layer.zindices_stale=!0,cr.arrayFindRemove(p.instances,t),p.zindices_stale=!0):(t.layer=p,this.DestroyInstance(t))),t.x=h.x,t.y=h.y,t.width=h.w,t.height=h.h,t.zindex=h.zi,t.angle=h.hasOwnProperty("a")?h.a:0,t.opacity=h.hasOwnProperty("o")?h.o:1,t.hotspotX=h.hasOwnProperty("hX")?h.hX:.5,t.hotspotY=h.hasOwnProperty("hY")?h.hY:.5,t.visible=h.hasOwnProperty("v")?h.v:!0,t.collisionsEnabled=h.hasOwnProperty("ce")?h.ce:!0,t.my_timescale=h.hasOwnProperty("mts")?h.mts:-1,t.blend_mode=h.hasOwnProperty("bm")?h.bm:0,t.compositeOp=cr.effectToCompositeOp(t.blend_mode),this.gl&&cr.setGLBlend(t,t.blend_mode,this.gl),t.set_bbox_changed(),h.hasOwnProperty("fx"))for(n=0,r=h.fx.length;r>n;n++)c=d.getEffectIndexByName(h.fx[n].name),0>c||(t.active_effect_flags[c]=h.fx[n].active,t.effect_params[c]=h.fx[n].params);t.updateActiveEffects()}if(l=e.behs)for(s in l)if(l.hasOwnProperty(s)){if(u=this.getBehaviorIndexBySid(t,parseInt(s,10)),0>u)continue;t.behavior_insts[u].loadFromJSON(l[s])}e.data&&t.loadFromJSON(e.data)},cr.runtime=i,cr.createRuntime=function(t){return new i(document.getElementById(t))},cr.createDCRuntime=function(t,e){return new i({dc:!0,width:t,height:e})},window.cr_createRuntime=cr.createRuntime,window.cr_createDCRuntime=cr.createDCRuntime,window.createCocoonJSRuntime=function(){window.c2cocoonjs=!0;var t=document.createElement("screencanvas")||document.createElement("canvas");t.screencanvas=!0,document.body.appendChild(t);var e=new i(t);return window.c2runtime=e,window.addEventListener("orientationchange",function(){window.c2runtime.setSize(window.innerWidth,window.innerHeight)}),window.c2runtime.setSize(window.innerWidth,window.innerHeight),e},window.createEjectaRuntime=function(){var t=document.getElementById("canvas"),e=new i(t);return window.c2runtime=e,window.c2runtime.setSize(window.innerWidth,window.innerHeight),e}}(),window.cr_getC2Runtime=function(){var t=document.getElementById("c2canvas");return t?t.c2runtime:window.c2runtime?window.c2runtime:null},window.cr_sizeCanvas=function(t,e){if(0!==t&&0!==e){var i=window.cr_getC2Runtime();i&&i.setSize(t,e)}},window.cr_setSuspended=function(t){var e=window.cr_getC2Runtime();e&&e.setSuspended(t)},function(){function t(t,e){this.runtime=t,this.event_sheet=null,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2,this.scale=1,this.angle=0,this.first_visit=!0,this.name=e[0],this.width=e[1],this.height=e[2],this.unbounded_scrolling=e[3],this.sheetname=e[4],this.sid=e[5];var i,s,n=e[6];for(this.layers=[],this.initial_types=[],i=0,s=n.length;s>i;i++){var r=new cr.layer(this,n[i]);r.number=i,cr.seal(r),this.layers.push(r)}var o=e[7];for(this.initial_nonworld=[],i=0,s=o.length;s>i;i++){var a=o[i],h=this.runtime.types_by_index[a[1]];h.default_instance||(h.default_instance=a),this.initial_nonworld.push(a),-1===this.initial_types.indexOf(h)&&this.initial_types.push(h)}for(this.effect_types=[],this.active_effect_types=[],this.effect_params=[],i=0,s=e[8].length;s>i;i++)this.effect_types.push({id:e[8][i][0],name:e[8][i][1],shaderindex:-1,active:!0,index:i}),this.effect_params.push(e[8][i][2].slice(0));this.updateActiveEffects(),this.rcTex=new cr.rect(0,0,1,1),this.rcTex2=new cr.rect(0,0,1,1),this.persist_data={}}function e(t,e){return t.zindex-e.zindex}function i(t,e){this.layout=t,this.runtime=t.runtime,this.instances=[],this.scale=1,this.angle=0,this.disableAngle=!1,this.tmprect=new cr.rect(0,0,0,0),this.tmpquad=new cr.quad,this.viewLeft=0,this.viewRight=0,this.viewTop=0,this.viewBottom=0,this.zindices_stale=!1,this.name=e[0],this.index=e[1],this.sid=e[2],this.visible=e[3],this.background_color=e[4],this.transparent=e[5],this.parallaxX=e[6],this.parallaxY=e[7],this.opacity=e[8],this.forceOwnTexture=e[9],this.zoomRate=e[10],this.blend_mode=e[11],this.effect_fallback=e[12],this.compositeOp="source-over",this.srcBlend=0,this.destBlend=0,this.render_offscreen=!1;var i,s,n=e[13];for(this.initial_instances=[],i=0,s=n.length;s>i;i++){var r=n[i],o=this.runtime.types_by_index[r[1]];o.default_instance||(o.default_instance=r,o.default_layerindex=this.index),this.initial_instances.push(r),-1===this.layout.initial_types.indexOf(o)&&this.layout.initial_types.push(o)}for(this.effect_types=[],this.active_effect_types=[],this.effect_params=[],i=0,s=e[14].length;s>i;i++)this.effect_types.push({id:e[14][i][0],name:e[14][i][1],shaderindex:-1,active:!0,index:i}),this.effect_params.push(e[14][i][2].slice(0));this.updateActiveEffects(),this.rcTex=new cr.rect(0,0,1,1),this.rcTex2=new cr.rect(0,0,1,1)}t.prototype.saveObjectToPersist=function(t){var e=t.type.sid.toString();this.persist_data.hasOwnProperty(e)||(this.persist_data[e]=[]);var i=this.persist_data[e];i.push(this.runtime.saveInstanceToJSON(t))},t.prototype.hasOpaqueBottomLayer=function(){var t=this.layers[0];return!t.transparent&&1===t.opacity&&!t.forceOwnTexture&&t.visible},t.prototype.updateActiveEffects=function(){this.active_effect_types.length=0;var t,e,i;for(t=0,e=this.effect_types.length;e>t;t++)i=this.effect_types[t],i.active&&this.active_effect_types.push(i)},t.prototype.getEffectByName=function(t){var e,i,s;for(e=0,i=this.effect_types.length;i>e;e++)if(s=this.effect_types[e],s.name===t)return s;return null};var s=[],n=!0;t.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes()),this.runtime.running_layout=this,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2;var t,i,r,o,a,h,c,l,u,p,d,f,g;for(t=0,r=this.runtime.types_by_index.length;r>t;t++)if(a=this.runtime.types_by_index[t],!a.is_family)for(h=a.instances,i=0,o=h.length;o>i;i++)if(c=h[i],c.layer){var m=c.layer.number;m>=this.layers.length&&(m=this.layers.length-1),c.layer=this.layers[m],-1===c.layer.instances.indexOf(c)&&c.layer.instances.push(c),c.layer.zindices_stale=!0}if(!n)for(t=0,r=this.layers.length;r>t;++t)this.layers[t].instances.sort(e);var g;for(s.length=0,this.boundScrolling(),t=0,r=this.layers.length;r>t;t++){g=this.layers[t],g.createInitialInstances(),g.disableAngle=!0;var y=g.canvasToLayer(0,0,!0,!0),_=g.canvasToLayer(0,0,!1,!0);g.disableAngle=!1,this.runtime.pixel_rounding&&(y=Math.round(y),_=Math.round(_)),g.rotateViewport(y,_,null)}var v=!1;if(!this.first_visit){for(d in this.persist_data)if(this.persist_data.hasOwnProperty(d)){if(a=this.runtime.getObjectTypeBySid(parseInt(d,10)),!a||a.is_family||!this.runtime.typeHasPersistBehavior(a))continue;for(f=this.persist_data[d],t=0,r=f.length;r>t;t++)g=null,(!a.plugin.is_world||(g=this.getLayerBySid(f[t].w.l)))&&(c=this.runtime.createInstanceFromInit(a.default_instance,g,!1,0,0,!0),this.runtime.loadInstanceFromJSON(c,f[t]),v=!0,s.push(c));f.length=0}for(t=0,r=this.layers.length;r>t;t++)this.layers[t].instances.sort(e),this.layers[t].zindices_stale=!0}for(v&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap()),t=0;t<s.length;t++)if(c=s[t],c.type.is_contained)for(l=c.get_iid(),i=0,o=c.type.container.length;o>i;i++)u=c.type.container[i],c.type!==u&&(u.instances.length>l?c.siblings.push(u.instances[l]):u.default_instance&&(p=this.runtime.createInstanceFromInit(u.default_instance,c.layer,!0,c.x,c.y,!0),this.runtime.ClearDeathRow(),u.updateIIDs(),c.siblings.push(p),s.push(p)));for(t=0,r=this.initial_nonworld.length;r>t;t++)c=this.runtime.createInstanceFromInit(this.initial_nonworld[t],null,!0);if(this.runtime.changelayout=null,this.runtime.ClearDeathRow(),this.runtime.ctx&&!this.runtime.isDomFree)for(t=0,r=this.runtime.types_by_index.length;r>t;t++)u=this.runtime.types_by_index[t],!u.is_family&&u.instances.length&&u.preloadCanvas2D&&u.preloadCanvas2D(this.runtime.ctx);for(t=0,r=s.length;r>t;t++)c=s[t],this.runtime.trigger(Object.getPrototypeOf(c.type.plugin).cnds.OnCreated,c);s.length=0,this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null),this.first_visit=!1},t.prototype.createGlobalNonWorlds=function(){var t,e,i,s,n,r;for(t=0,e=0,i=this.initial_nonworld.length;i>t;t++)s=this.initial_nonworld[t],r=this.runtime.types_by_index[s[1]],r.global?n=this.runtime.createInstanceFromInit(s,null,!0):(this.initial_nonworld[e]=s,e++);this.initial_nonworld.length=e},t.prototype.stopRunning=function(){this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null),this.runtime.system.waits.length=0;var t,e,i,s,r,o,a;for(t=0,e=this.layers.length;e>t;t++)for(this.layers[t].updateZIndices(),r=this.layers[t].instances,i=0,s=r.length;s>i;i++)o=r[i],o.type.global||this.runtime.typeHasPersistBehavior(o.type)&&this.saveObjectToPersist(o);for(t=0,e=this.layers.length;e>t;t++){for(r=this.layers[t].instances,i=0,s=r.length;s>i;i++)o=r[i],o.type.global||this.runtime.DestroyInstance(o);this.runtime.ClearDeathRow(),r.length=0,this.layers[t].zindices_stale=!0}for(t=0,e=this.runtime.types_by_index.length;e>t;t++)if(a=this.runtime.types_by_index[t],!(a.global||a.plugin.is_world||a.plugin.singleglobal||a.is_family)){for(i=0,s=a.instances.length;s>i;i++)this.runtime.DestroyInstance(a.instances[i]);this.runtime.ClearDeathRow()}n=!1},t.prototype.draw=function(t){var e,i=t,s=!1,n=!this.runtime.fullscreenScalingQuality;n&&(this.runtime.layout_canvas||(this.runtime.layout_canvas=document.createElement("canvas"),e=this.runtime.layout_canvas,e.width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layout_ctx=e.getContext("2d"),s=!0),e=this.runtime.layout_canvas,i=this.runtime.layout_ctx,e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,s=!0),e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,s=!0),s&&(i.webkitImageSmoothingEnabled=this.runtime.linearSampling,i.mozImageSmoothingEnabled=this.runtime.linearSampling,i.msImageSmoothingEnabled=this.runtime.linearSampling,i.imageSmoothingEnabled=this.runtime.linearSampling)),i.globalAlpha=1,i.globalCompositeOperation="source-over",this.runtime.alphaBackground&&!this.hasOpaqueBottomLayer()&&i.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);
var r,o,a;for(r=0,o=this.layers.length;o>r;r++)a=this.layers[r],a.visible&&a.opacity>0&&11!==a.blend_mode&&a.draw(i);n&&t.drawImage(e,0,0,this.runtime.width,this.runtime.height)},t.prototype.drawGL=function(t){var e=this.active_effect_types.length>0||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality;e?(this.runtime.layout_tex||(this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)&&(t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layout_tex),this.runtime.fullscreenScalingQuality||t.setSize(this.runtime.draw_width,this.runtime.draw_height)):this.runtime.layout_tex&&(t.setRenderingToTexture(null),t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null),this.runtime.alphaBackground&&!this.hasOpaqueBottomLayer()&&t.clear(0,0,0,0);var i,s;for(i=0,s=this.layers.length;s>i;i++)this.layers[i].visible&&this.layers[i].opacity>0&&this.layers[i].drawGL(t);if(e)if(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality){if(1===this.active_effect_types.length){var n=this.active_effect_types[0].index;t.switchProgram(this.active_effect_types[0].shaderindex),t.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.scale,this.angle,0,0,this.effect_params[n]),t.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)}else t.switchProgram(0);this.runtime.fullscreenScalingQuality||t.setSize(this.runtime.width,this.runtime.height),t.setRenderingToTexture(null),t.setOpacity(1),t.setTexture(this.runtime.layout_tex),t.setAlphaBlend(),t.resetModelView(),t.updateModelView();var r=this.runtime.width/2,o=this.runtime.height/2;t.quad(-r,o,r,o,r,-o,-r,-o),t.setTexture(null)}else this.renderEffectChain(t,null,null,null)},t.prototype.getRenderTarget=function(){return this.active_effect_types.length>0||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality?this.runtime.layout_tex:null},t.prototype.getMinLayerScale=function(){var t,e,i,s=this.layers[0].getScale();for(t=1,e=this.layers.length;e>t;t++)i=this.layers[t],(0!==i.parallaxX||0!==i.parallaxY)&&i.getScale()<s&&(s=i.getScale());return s},t.prototype.scrollToX=function(t){if(!this.unbounded_scrolling){var e=this.runtime.draw_width*(1/this.getMinLayerScale())/2;t>this.width-e&&(t=this.width-e),e>t&&(t=e)}this.scrollX!==t&&(this.scrollX=t,this.runtime.redraw=!0)},t.prototype.scrollToY=function(t){if(!this.unbounded_scrolling){var e=this.runtime.draw_height*(1/this.getMinLayerScale())/2;t>this.height-e&&(t=this.height-e),e>t&&(t=e)}this.scrollY!==t&&(this.scrollY=t,this.runtime.redraw=!0)},t.prototype.boundScrolling=function(){this.scrollToX(this.scrollX),this.scrollToY(this.scrollY)},t.prototype.renderEffectChain=function(t,e,i,s){var n=i?i.active_effect_types:e?e.active_effect_types:this.active_effect_types,r=1,o=0,a=0,h=0;i?(r=i.layer.getScale(),o=i.layer.getAngle(),a=i.layer.viewLeft,h=i.layer.viewTop):e&&(r=e.getScale(),o=e.getAngle(),a=e.viewLeft,h=e.viewTop);var c,l,u,p,d,f,g=this.runtime.fx_tex,m=0,y=1,_=this.runtime.draw_width,v=this.runtime.draw_height,b=_/2,x=v/2,w=e?e.rcTex:this.rcTex,S=e?e.rcTex2:this.rcTex2,T=0,k=0,C=0,O=0,A=_,E=_,P=v,B=v,R=0,I=0,N=i?i.layer.getAngle():0;if(i){for(c=0,l=n.length;l>c;c++)R+=t.getProgramBoxExtendHorizontal(n[c].shaderindex),I+=t.getProgramBoxExtendVertical(n[c].shaderindex);var M=i.bbox;if(T=e.layerToCanvas(M.left,M.top,!0,!0),C=e.layerToCanvas(M.left,M.top,!1,!0),A=e.layerToCanvas(M.right,M.bottom,!0,!0),P=e.layerToCanvas(M.right,M.bottom,!1,!0),0!==N){var L=e.layerToCanvas(M.right,M.top,!0,!0),D=e.layerToCanvas(M.right,M.top,!1,!0),F=e.layerToCanvas(M.left,M.bottom,!0,!0),j=e.layerToCanvas(M.left,M.bottom,!1,!0);p=Math.min(T,A,L,F),A=Math.max(T,A,L,F),T=p,p=Math.min(C,P,D,j),P=Math.max(C,P,D,j),C=p}T-=R,C-=I,A+=R,P+=I,S.left=T/_,S.top=1-C/v,S.right=A/_,S.bottom=1-P/v,k=T=cr.floor(T),O=C=cr.floor(C),E=A=cr.ceil(A),B=P=cr.ceil(P),k-=R,O-=I,E+=R,B+=I,0>T&&(T=0),0>C&&(C=0),A>_&&(A=_),P>v&&(P=v),0>k&&(k=0),0>O&&(O=0),E>_&&(E=_),B>v&&(B=v),w.left=T/_,w.top=1-C/v,w.right=A/_,w.bottom=1-P/v}else w.left=S.left=0,w.top=S.top=0,w.right=S.right=1,w.bottom=S.bottom=1;var W=i&&((i.angle||N)&&t.programUsesDest(n[0].shaderindex)||0!==R||0!==I||1!==i.opacity||i.type.plugin.must_predraw)||e&&!i&&1!==e.opacity;t.setAlphaBlend(),W&&(g[m]||(g[m]=t.createEmptyTexture(_,v,this.runtime.linearSampling)),(g[m].c2width!==_||g[m].c2height!==v)&&(t.deleteTexture(g[m]),g[m]=t.createEmptyTexture(_,v,this.runtime.linearSampling)),t.switchProgram(0),t.setRenderingToTexture(g[m]),f=B-O,d=v-O-f,t.clearRect(k,d,E-k,f),i?i.drawGL(t):(t.setTexture(this.runtime.layer_tex),t.setOpacity(e.opacity),t.resetModelView(),t.translate(-b,-x),t.updateModelView(),t.quadTex(T,P,A,P,A,C,T,C,w)),S.left=S.top=0,S.right=S.bottom=1,i&&(p=w.top,w.top=w.bottom,w.bottom=p),m=1,y=0),t.setOpacity(1);var u=n.length-1,G=t.programUsesCrossSampling(n[u].shaderindex)||!e&&!i&&!this.runtime.fullscreenScalingQuality,V=0;for(c=0,l=n.length;l>c;c++)g[m]||(g[m]=t.createEmptyTexture(_,v,this.runtime.linearSampling)),(g[m].c2width!==_||g[m].c2height!==v)&&(t.deleteTexture(g[m]),g[m]=t.createEmptyTexture(_,v,this.runtime.linearSampling)),t.switchProgram(n[c].shaderindex),V=n[c].index,t.programIsAnimated(n[c].shaderindex)&&(this.runtime.redraw=!0),0!=c||W?(t.setProgramParameters(s,1/_,1/v,S.left,S.top,S.right,S.bottom,r,o,a,h,i?i.effect_params[V]:e?e.effect_params[V]:this.effect_params[V]),t.setTexture(null),c!==u||G?(t.setRenderingToTexture(g[m]),f=B-O,d=v-O-f,t.clearRect(k,d,E-k,f)):(i?t.setBlend(i.srcBlend,i.destBlend):e&&t.setBlend(e.srcBlend,e.destBlend),t.setRenderingToTexture(s)),t.setTexture(g[y]),t.resetModelView(),t.translate(-b,-x),t.updateModelView(),t.quadTex(T,P,A,P,A,C,T,C,w),c!==u||G||t.setTexture(null)):(t.setRenderingToTexture(g[m]),f=B-O,d=v-O-f,t.clearRect(k,d,E-k,f),i?(t.setProgramParameters(s,1/i.width,1/i.height,S.left,S.top,S.right,S.bottom,r,o,a,h,i.effect_params[V]),i.drawGL(t)):(t.setProgramParameters(s,1/_,1/v,0,0,1,1,r,o,a,h,e?e.effect_params[V]:this.effect_params[V]),t.setTexture(e?this.runtime.layer_tex:this.runtime.layout_tex),t.resetModelView(),t.translate(-b,-x),t.updateModelView(),t.quadTex(T,P,A,P,A,C,T,C,w)),S.left=S.top=0,S.right=S.bottom=1,i&&!G&&(p=P,P=C,C=p)),m=0===m?1:0,y=0===m?1:0;G&&(t.switchProgram(0),i?t.setBlend(i.srcBlend,i.destBlend):e?t.setBlend(e.srcBlend,e.destBlend):this.runtime.fullscreenScalingQuality||(t.setSize(this.runtime.width,this.runtime.height),b=this.runtime.width/2,x=this.runtime.height/2,T=0,C=0,A=this.runtime.width,P=this.runtime.height),t.setRenderingToTexture(s),t.setTexture(g[y]),t.resetModelView(),t.translate(-b,-x),t.updateModelView(),i&&1===n.length&&!W?t.quadTex(T,C,A,C,A,P,T,P,w):t.quadTex(T,P,A,P,A,C,T,C,w),t.setTexture(null))},t.prototype.getLayerBySid=function(t){var e,i;for(e=0,i=this.layers.length;i>e;e++)if(this.layers[e].sid===t)return this.layers[e];return null},t.prototype.saveToJSON=function(){var t,e,i,s,n={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};for(t=0,e=this.effect_types.length;e>t;t++)s=this.effect_types[t],n.fx.push({name:s.name,active:s.active,params:this.effect_params[s.index]});for(t=0,e=this.layers.length;e>t;t++)i=this.layers[t],n.layers[i.sid.toString()]=i.saveToJSON();return n},t.prototype.loadFromJSON=function(t){var e,i,s,n,r;this.scrollX=t.sx,this.scrollY=t.sy,this.scale=t.s,this.angle=t.a,this.width=t.w,this.height=t.h,this.persist_data=t.persist,"undefined"!=typeof t.fv&&(this.first_visit=t.fv);var o=t.fx;for(e=0,i=o.length;i>e;e++)s=this.getEffectByName(o[e].name),s&&(s.active=o[e].active,this.effect_params[s.index]=o[e].params);this.updateActiveEffects();var a=t.layers;for(n in a)if(a.hasOwnProperty(n)){if(r=this.getLayerBySid(parseInt(n,10)),!r)continue;r.loadFromJSON(a[n])}},cr.layout=t,i.prototype.updateActiveEffects=function(){this.active_effect_types.length=0;var t,e,i;for(t=0,e=this.effect_types.length;e>t;t++)i=this.effect_types[t],i.active&&this.active_effect_types.push(i)},i.prototype.getEffectByName=function(t){var e,i,s;for(e=0,i=this.effect_types.length;i>e;e++)if(s=this.effect_types[e],s.name===t)return s;return null},i.prototype.createInitialInstances=function(){var t,e,i,n,r,o,a,h;for(t=0,e=0,i=this.initial_instances.length;i>t;t++)r=this.initial_instances[t],o=this.runtime.types_by_index[r[1]],h=this.runtime.typeHasPersistBehavior(o),a=!0,(!h||this.layout.first_visit)&&(n=this.runtime.createInstanceFromInit(r,this,!0),s.push(n),n.type.global&&(a=!1)),a&&(this.initial_instances[e]=this.initial_instances[t],e++);this.initial_instances.length=e,this.runtime.ClearDeathRow(),!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback),this.compositeOp=cr.effectToCompositeOp(this.blend_mode),this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl)},i.prototype.updateZIndices=function(){if(this.zindices_stale){var t,e;for(t=0,e=this.instances.length;e>t;t++)this.instances[t].zindex=t;this.zindices_stale=!1}},i.prototype.getScale=function(t){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||t?this.runtime.aspect_scale:1)},i.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1},i.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)},i.prototype.draw=function(t){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var e=this.runtime.canvas,i=t,s=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),e=this.runtime.layer_canvas,e.width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layer_ctx=e.getContext("2d"),s=!0),e=this.runtime.layer_canvas,i=this.runtime.layer_ctx,e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,s=!0),e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,s=!0),s&&(i.webkitImageSmoothingEnabled=this.runtime.linearSampling,i.mozImageSmoothingEnabled=this.runtime.linearSampling,i.msImageSmoothingEnabled=this.runtime.linearSampling,i.imageSmoothingEnabled=this.runtime.linearSampling),this.transparent&&i.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height)),i.globalAlpha=1,i.globalCompositeOperation="source-over",this.transparent||(i.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",i.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height)),i.save(),this.disableAngle=!0;var n=this.canvasToLayer(0,0,!0,!0),r=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),this.rotateViewport(n,r,i);var o=this.getScale();i.scale(o,o),i.translate(-n,-r);var a,h,c,l;for(a=0,h=this.instances.length;h>a;a++)c=this.instances[a],c.visible&&0!==c.width&&0!==c.height&&(c.update_bbox(),l=c.bbox,l.right<this.viewLeft||l.bottom<this.viewTop||l.left>this.viewRight||l.top>this.viewBottom||(i.globalCompositeOperation=c.compositeOp,c.draw(i)));i.restore(),this.render_offscreen&&(t.globalCompositeOperation=this.compositeOp,t.globalAlpha=this.opacity,t.drawImage(e,0,0))},i.prototype.rotateViewport=function(t,e,i){var s=this.getScale();this.viewLeft=t,this.viewTop=e,this.viewRight=t+this.runtime.draw_width*(1/s),this.viewBottom=e+this.runtime.draw_height*(1/s);var n=this.getAngle();0!==n&&(i&&(i.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),i.rotate(-n),i.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,n),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)},i.prototype.drawGL=function(t){var e=this.runtime.draw_width,i=this.runtime.draw_height,s=0,n=0;this.render_offscreen=this.forceOwnTexture||1!==this.opacity||this.active_effect_types.length>0||0!==this.blend_mode,this.render_offscreen&&(this.runtime.layer_tex||(this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)&&(t.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layer_tex),this.transparent&&t.clear(0,0,0,0)),this.transparent||t.clear(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),this.disableAngle=!0;var r=this.canvasToLayer(0,0,!0,!0),o=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(r=Math.round(r),o=Math.round(o)),this.rotateViewport(r,o,null);var a=this.getScale();t.resetModelView(),t.scale(a,a),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView();var h,c,l,u;for(h=0,c=this.instances.length;c>h;h++)if(l=this.instances[h],l.visible&&0!==l.width&&0!==l.height&&(l.update_bbox(),u=l.bbox,!(u.right<this.viewLeft||u.bottom<this.viewTop||u.left>this.viewRight||u.top>this.viewBottom)))if(l.uses_shaders)if(s=l.active_effect_types[0].shaderindex,n=l.active_effect_types[0].index,1!==l.active_effect_types.length||t.programUsesCrossSampling(s)||t.programExtendsBox(s)||(l.angle||l.layer.getAngle())&&t.programUsesDest(s)||1!==l.opacity||l.type.plugin.must_predraw)this.layout.renderEffectChain(t,this,l,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),t.resetModelView(),t.scale(a,a),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView();else{t.switchProgram(s),t.setBlend(l.srcBlend,l.destBlend),t.programIsAnimated(s)&&(this.runtime.redraw=!0);var p=0,d=0,f=0,g=0;if(t.programUsesDest(s)){var u=l.bbox,m=this.layerToCanvas(u.left,u.top,!0,!0),y=this.layerToCanvas(u.left,u.top,!1,!0),_=this.layerToCanvas(u.right,u.bottom,!0,!0),v=this.layerToCanvas(u.right,u.bottom,!1,!0);p=m/e,d=1-y/i,f=_/e,g=1-v/i}t.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),1/l.width,1/l.height,p,d,f,g,this.getScale(),this.getAngle(),this.viewLeft,this.viewTop,l.effect_params[n]),l.drawGL(t)}else t.switchProgram(0),t.setBlend(l.srcBlend,l.destBlend),l.drawGL(t);if(this.render_offscreen)if(s=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,n=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!t.programUsesCrossSampling(s)&&1===this.opacity){1===this.active_effect_types.length?(t.switchProgram(s),t.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.getScale(),this.getAngle(),this.viewLeft,this.viewTop,this.effect_params[n]),t.programIsAnimated(s)&&(this.runtime.redraw=!0)):t.switchProgram(0),t.setRenderingToTexture(this.layout.getRenderTarget()),t.setOpacity(this.opacity),t.setTexture(this.runtime.layer_tex),t.setBlend(this.srcBlend,this.destBlend),t.resetModelView(),t.updateModelView();var b=this.runtime.draw_width/2,x=this.runtime.draw_height/2;t.quad(-b,x,b,x,b,-x,-b,-x),t.setTexture(null)}else this.layout.renderEffectChain(t,this,null,this.layout.getRenderTarget())},i.prototype.canvasToLayer=function(t,e,i,s){var n=this.runtime.devicePixelRatio;this.runtime.isRetina&&(t*=n,e*=n);var r=this.runtime.parallax_x_origin,o=this.runtime.parallax_y_origin,a=(this.layout.scrollX-r)*this.parallaxX+r,h=(this.layout.scrollY-o)*this.parallaxY+o,c=1/this.getScale(!s);s?(a-=this.runtime.draw_width*c/2,h-=this.runtime.draw_height*c/2):(a-=this.runtime.width*c/2,h-=this.runtime.height*c/2),a+=t*c,h+=e*c;var l=this.getAngle();if(0!==l){a-=this.layout.scrollX,h-=this.layout.scrollY;var u=Math.cos(l),p=Math.sin(l),d=a*u-h*p;h=h*u+a*p,a=d,a+=this.layout.scrollX,h+=this.layout.scrollY}return i?a:h},i.prototype.layerToCanvas=function(t,e,i,s){var n=this.getAngle();if(0!==n){t-=this.layout.scrollX,e-=this.layout.scrollY;var r=Math.cos(-n),o=Math.sin(-n),a=t*r-e*o;e=e*r+t*o,t=a,t+=this.layout.scrollX,e+=this.layout.scrollY}var h=this.runtime.parallax_x_origin,c=this.runtime.parallax_y_origin,l=(this.layout.scrollX-h)*this.parallaxX+h,u=(this.layout.scrollY-c)*this.parallaxY+c,p=1/this.getScale(!s);s?(l-=this.runtime.draw_width*p/2,u-=this.runtime.draw_height*p/2):(l-=this.runtime.width*p/2,u-=this.runtime.height*p/2),l=(t-l)/p,u=(e-u)/p;var d=this.runtime.devicePixelRatio;return this.runtime.isRetina&&!s&&(l/=d,u/=d),i?l:u},i.prototype.rotatePt=function(t,e,i){if(0===this.getAngle())return i?t:e;var s=this.layerToCanvas(t,e,!0),n=this.layerToCanvas(t,e,!1);this.disableAngle=!0;var r=this.canvasToLayer(s,n,!0),o=this.canvasToLayer(s,n,!0);return this.disableAngle=!1,i?r:o},i.prototype.saveToJSON=function(){var t,e,i,s={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],instances:[]};for(t=0,e=this.effect_types.length;e>t;t++)i=this.effect_types[t],s.fx.push({name:i.name,active:i.active,params:this.effect_params[i.index]});return s},i.prototype.loadFromJSON=function(t){var i,s,n;this.scale=t.s,this.angle=t.a,this.viewLeft=t.vl,this.viewTop=t.vt,this.viewRight=t.vr,this.viewBottom=t.vb,this.visible=t.v,this.background_color=t.bc,this.transparent=t.t,this.parallaxX=t.px,this.parallaxY=t.py,this.opacity=t.o,this.zoomRate=t.zr;var r=t.fx;for(i=0,s=r.length;s>i;i++)n=this.getEffectByName(r[i].name),n&&(n.active=r[i].active,this.effect_params[n.index]=r[i].params);this.updateActiveEffects(),this.instances.sort(e),this.zindices_stale=!0},cr.layer=i}(),function(){function t(t,e){var i,s=t.length;switch(s){case 0:return!0;case 1:return t[0]===e[0];case 2:return t[0]===e[0]&&t[1]===e[1];default:for(i=0;s>i;i++)if(t[i]!==e[i])return!1;return!0}}function e(t,e){return t.index-e.index}function i(i){var s,n,r,o,a;for(2===i.length?i[0].index>i[1].index&&(o=i[0],i[0]=i[1],i[1]=o):i.length>2&&i.sort(e),i.length>=f.length&&(f.length=i.length+1),f[i.length]||(f[i.length]=[]),a=f[i.length],s=0,n=a.length;n>s;s++)if(r=a[s],t(i,r))return r;return a.push(i),i}function s(t,e){this.runtime=t,this.triggers={},this.fasttriggers={},this.hasRun=!1,this.includes=new cr.ObjectSet,this.deep_includes=[],this.already_included_sheets=[],this.name=e[0];var i=e[1];this.events=[];var s,n;for(s=0,n=i.length;n>s;s++)this.init_event(i[s],null,this.events)}function n(t){return cr.plugins_.Sprite&&t===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?!0:!1}function r(t){this.type=t,this.instances=[],this.else_instances=[],this.select_all=!0}function o(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.solModifiersIncludingParents=[],this.solWriterAfterCnds=!1,this.group=!1,this.initially_activated=!1,this.toplevelevent=!1,this.toplevelgroup=!1,this.has_else_block=!1,this.conditions=[],this.actions=[],this.subevents=[],this.group_name="",this.group=!1,this.initially_activated=!1,this.group_active=!1,this.contained_includes=null,i[1]&&(this.group_name=i[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!i[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=this),this.orblock=i[2],this.sid=i[4],this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var s,n,r=i[5];for(s=0,n=r.length;n>s;s++){var o=new cr.condition(this,r[s]);o.index=s,cr.seal(o),this.conditions.push(o),this.addSolModifier(o.type)}var a=i[6];for(s=0,n=a.length;n>s;s++){var h=new cr.action(this,a[s]);h.index=s,cr.seal(h),this.actions.push(h)}if(8===i.length){var c=i[7];for(s=0,n=c.length;n>s;s++)this.sheet.init_event(c[s],this,this.subevents)}this.is_else_block=!1,this.conditions.length&&(this.is_else_block=null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function a(t,e){var i,s,n;if(t&&(-1===e.indexOf(t)&&e.push(t),t.is_contained))for(i=0,s=t.container.length;s>i;i++)n=t.container[i],t!==n&&-1===e.indexOf(n)&&e.push(n)}function h(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=e[1],this.trigger=e[3]>0,this.fasttrigger=2===e[3],this.looping=e[4],this.inverted=e[5],this.isstatic=e[6],this.sid=e[7],this.runtime.cndsBySid[this.sid.toString()]=this,-1===e[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[e[0]],this.run=this.isstatic?this.run_static:this.run_object,e[2]?(this.behaviortype=this.type.getBehaviorByName(e[2]),this.beh_index=this.type.getBehaviorIndexByName(e[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&this.block.parent.setSolWriterAfterCnds()),this.fasttrigger&&(this.run=this.run_true),10===e.length){var i,s,n=e[9];for(i=0,s=n.length;s>i;i++){var r=new cr.parameter(this,n[i]);cr.seal(r),this.parameters.push(r)}this.results.length=n.length}}function c(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=e[1],-1===e[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[e[0]],this.run=this.run_object,e[2]?(this.behaviortype=this.type.getBehaviorByName(e[2]),this.beh_index=this.type.getBehaviorIndexByName(e[2])):(this.behaviortype=null,this.beh_index=-1)),this.sid=e[3],this.runtime.actsBySid[this.sid.toString()]=this,6===e.length){var i,s,n=e[5];for(i=0,s=n.length;s>i;i++){var r=new cr.parameter(this,n[i]);cr.seal(r),this.parameters.push(r)}this.results.length=n.length}}function l(t,e){this.owner=t,this.block=t.block,this.sheet=t.sheet,this.runtime=t.runtime,this.type=e[0],this.expression=null,this.solindex=0,this.get=null,this.combosel=0,this.layout=null,this.key=0,this.object=null,this.index=0,this.varname=null,this.eventvar=null,this.fileinfo=null,this.subparams=null,this.variadicret=null,this.subparams=null,this.variadicret=null,this.variesPerInstance=!1;var i,s,n;switch(e[0]){case 0:case 7:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp;break;case 1:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp_str;break;case 5:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_layer;break;case 3:case 8:this.combosel=e[1],this.get=this.get_combosel;break;case 6:this.layout=this.runtime.layouts[e[1]],this.get=this.get_layout;break;case 9:this.key=e[1],this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[e[1]],this.get=this.get_object,this.block.addSolModifier(this.object),this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=e[1],t.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=e[1],this.eventvar=null,this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=e[1],this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],i=1,s=e.length;s>i;i++)n=new cr.parameter(this.owner,e[i]),cr.seal(n),this.subparams.push(n),this.variadicret.push(0)}}function u(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.name=i[1],this.vartype=i[2],this.initial=i[3],this.is_static=!!i[4],this.is_constant=!!i[5],this.sid=i[6],this.runtime.varsBySid[this.sid.toString()]=this,this.data=this.initial,this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function p(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.include_sheet=null,this.include_sheet_name=i[1],this.active=!0}function d(){this.temp_parents_arr=[],this.reset(null),cr.seal(this)}var f=[];s.prototype.toString=function(){return this.name},s.prototype.init_event=function(t,e,i){switch(t[0]){case 0:var s=new cr.eventblock(this,e,t);if(cr.seal(s),s.orblock){i.push(s);var n,r;for(n=0,r=s.conditions.length;r>n;n++)s.conditions[n].trigger&&this.init_trigger(s,n)}else s.is_trigger()?this.init_trigger(s,0):i.push(s);break;case 1:var o=new cr.eventvariable(this,e,t);cr.seal(o),i.push(o);break;case 2:var a=new cr.eventinclude(this,e,t);cr.seal(a),i.push(a)}},s.prototype.postInit=function(){var t,e;for(t=0,e=this.events.length;e>t;t++)this.events[t].postInit(e-1>t&&this.events[t+1].is_else_block)},s.prototype.updateDeepIncludes=function(){this.deep_includes.length=0,this.already_included_sheets.length=0,this.addDeepIncludes(this),this.already_included_sheets.length=0},s.prototype.addDeepIncludes=function(t){var e,i,s,n,r=t.deep_includes,o=t.already_included_sheets,a=this.includes.valuesRef();for(e=0,i=a.length;i>e;++e)s=a[e],n=s.include_sheet,!s.isActive()||t===n||o.indexOf(n)>-1||(o.push(n),n.addDeepIncludes(t),r.push(n))},s.prototype.run=function(t){this.runtime.resuming_breakpoint||(this.hasRun=!0,t||(this.runtime.isRunningEvents=!0));var e,i;for(e=0,i=this.events.length;i>e;e++){var s=this.events[e];s.run(),this.runtime.clearSol(s.solModifiers),(!this.runtime.deathRow.isEmpty()||this.runtime.createRow.length)&&this.runtime.ClearDeathRow()}t||(this.runtime.isRunningEvents=!1)},s.prototype.init_trigger=function(t,e){t.orblock||this.runtime.triggers_to_postinit.push(t);var i,s,r,o=t.conditions[e];r=o.type?o.type.name:"system";var a=o.fasttrigger,h=a?this.fasttriggers:this.triggers;h[r]||(h[r]=[]);var c=h[r],l=o.func;if(a){if(!o.parameters.length)return;var u=o.parameters[0];if(1!==u.type||2!==u.expression.type)return;var p,i,s,d=u.expression.value.toLowerCase();for(i=0,s=c.length;s>i;i++)if(c[i].method==l)return p=c[i].evs,void(p[d]?p[d].push([t,e]):p[d]=[[t,e]]);p={},p[d]=[[t,e]],c.push({method:l,evs:p})}else{for(i=0,s=c.length;s>i;i++)if(c[i].method==l)return void c[i].evs.push([t,e]);n(l)?c.unshift({method:l,evs:[[t,e]]}):c.push({method:l,evs:[[t,e]]})}},cr.eventsheet=s,r.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length},r.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances},r.prototype.pick_one=function(t){if(t)if(t.runtime.getCurrentEventStack().current_event.orblock){this.select_all&&(this.instances.length=0,cr.shallowAssignArray(this.else_instances,t.type.instances),this.select_all=!1);var e=this.else_instances.indexOf(t);-1!==e&&(this.instances.push(this.else_instances[e]),this.else_instances.splice(e,1))}else this.select_all=!1,this.instances.length=1,this.instances[0]=t},cr.selection=r,window._c2hh_="",o.prototype.postInit=function(t){var e,s,n=this.parent;if(this.group)for(this.toplevelgroup=!0;n;){if(!n.group){this.toplevelgroup=!1;break}n=n.parent}for(this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup),this.has_else_block=!!t,this.solModifiersIncludingParents=this.solModifiers.slice(0),n=this.parent;n;){for(e=0,s=n.solModifiers.length;s>e;e++)this.addParentSolModifier(n.solModifiers[e]);n=n.parent}this.solModifiers=i(this.solModifiers),this.solModifiersIncludingParents=i(this.solModifiersIncludingParents);var e,s;for(e=0,s=this.conditions.length;s>e;e++)this.conditions[e].postInit();for(e=0,s=this.actions.length;s>e;e++)this.actions[e].postInit();for(e=0,s=this.subevents.length;s>e;e++)this.subevents[e].postInit(s-1>e&&this.subevents[e+1].is_else_block)},o.prototype.setGroupActive=function(t){if(this.group_active!==!!t){this.group_active=!!t;var e,i;for(e=0,i=this.contained_includes.length;i>e;++e)this.contained_includes[e].updateActive();i>0&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}},o.prototype.addSolModifier=function(t){a(t,this.solModifiers)},o.prototype.addParentSolModifier=function(t){a(t,this.solModifiersIncludingParents)},o.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0,this.parent&&this.parent.setSolWriterAfterCnds()},o.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1},o.prototype.run=function(){var t,e,i=!1,s=this.runtime,n=this.runtime.getCurrentEventStack();n.current_event=this;var r=this.conditions;if(this.is_else_block||(n.else_branch_ran=!1),this.orblock){for(0===r.length&&(i=!0),n.cndindex=0,t=r.length;n.cndindex<t;n.cndindex++)r[n.cndindex].trigger||(e=r[n.cndindex].run(),e&&(i=!0));n.last_event_true=i,i&&this.run_actions_and_subevents()}else{for(n.cndindex=0,t=r.length;n.cndindex<t;n.cndindex++)if(e=r[n.cndindex].run(),!e)return n.last_event_true=!1,void(!this.toplevelevent||s.deathRow.isEmpty()&&!s.createRow.length||s.ClearDeathRow());n.last_event_true=!0,this.run_actions_and_subevents()}this.end_run(n)},o.prototype.end_run=function(t){t.last_event_true&&this.has_else_block&&(t.else_branch_ran=!0),!this.toplevelevent||this.runtime.deathRow.isEmpty()&&!this.runtime.createRow.length||this.runtime.ClearDeathRow()},o.prototype.run_orblocktrigger=function(t){var e=this.runtime.getCurrentEventStack();e.current_event=this,this.conditions[t].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)},o.prototype.run_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(e.actindex=0,t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},o.prototype.resume_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},o.prototype.run_subevents=function(){if(this.subevents.length){var t,e,i,s,n=this.subevents.length-1;if(this.runtime.pushEventStack(this),this.solWriterAfterCnds)for(t=0,e=this.subevents.length;e>t;t++)i=this.subevents[t],s=!this.toplevelgroup||!this.group&&n>t,s&&this.runtime.pushCopySol(i.solModifiers),i.run(),s?this.runtime.popSol(i.solModifiers):this.runtime.clearSol(i.solModifiers);else for(t=0,e=this.subevents.length;e>t;t++)this.subevents[t].run();this.runtime.popEventStack()}},o.prototype.run_pretrigger=function(){var t=this.runtime.getCurrentEventStack();t.current_event=this;var e,i=!1;for(t.cndindex=0,e=this.conditions.length;t.cndindex<e;t.cndindex++)if(this.conditions[t.cndindex].run())i=!0;else if(!this.orblock)return!1;return this.orblock?i:!0},o.prototype.retrigger=function(){this.runtime.execcount++;var t,e=this.runtime.getCurrentEventStack().cndindex,i=this.runtime.pushEventStack(this);if(!this.orblock)for(i.cndindex=e+1,t=this.conditions.length;i.cndindex<t;i.cndindex++)if(!this.conditions[i.cndindex].run())return this.runtime.popEventStack(),!1;return this.run_actions_and_subevents(),this.runtime.popEventStack(),!0
},o.prototype.isFirstConditionOfType=function(t){var e=t.index;if(0===e)return!0;for(--e;e>=0;--e)if(this.conditions[e].type===t.type)return!1;return!0},cr.eventblock=o,h.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;e>t;t++)i=this.parameters[t],i.postInit(),i.variesPerInstance&&(this.anyParamVariesPerInstance=!0)},h.prototype.run_true=function(){return!0},h.prototype.run_system=function(){var t,e;for(t=0,e=this.parameters.length;e>t;t++)this.results[t]=this.parameters[t].get();return cr.xor(this.func.apply(this.runtime.system,this.results),this.inverted)},h.prototype.run_static=function(){var t,e;for(t=0,e=this.parameters.length;e>t;t++)this.results[t]=this.parameters[t].get();var i=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);return this.type.applySolToContainer(),i},h.prototype.run_object=function(){var t,e,i,s,n,r,o,a,h,c,l,u,p,d=this.type,f=d.getCurrentSol(),g=this.block.orblock&&!this.trigger,m=0,y=d.is_contained,_=d.is_family,v=d.family_index,b=this.beh_index,x=b>-1,w=this.anyParamVariesPerInstance,S=this.parameters,T=this.results,k=this.inverted,C=this.func;if(w)for(e=0,n=S.length;n>e;++e)r=S[e],r.variesPerInstance||(T[e]=r.get(0));else for(e=0,n=S.length;n>e;++e)T[e]=S[e].get(0);if(f.select_all){for(f.instances.length=0,f.else_instances.length=0,u=d.instances,t=0,s=u.length;s>t;++t){if(h=u[t],w)for(e=0,n=S.length;n>e;++e)r=S[e],r.variesPerInstance&&(T[e]=r.get(t));x?(m=0,_&&(m=h.type.family_beh_map[v]),o=C.apply(h.behavior_insts[b+m],T)):o=C.apply(h,T),a=cr.xor(o,k),a?f.instances.push(h):g&&f.else_instances.push(h)}return d.finish&&d.finish(!0),f.select_all=!1,d.applySolToContainer(),f.hasObjects()}i=0;var O=g&&!this.block.isFirstConditionOfType(this);u=O?f.else_instances:f.instances;var A=!1;for(t=0,s=u.length;s>t;++t){if(h=u[t],w)for(e=0,n=S.length;n>e;++e)r=S[e],r.variesPerInstance&&(T[e]=r.get(t));if(x?(m=0,_&&(m=h.type.family_beh_map[v]),o=C.apply(h.behavior_insts[b+m],T)):o=C.apply(h,T),cr.xor(o,k))if(A=!0,O){if(f.instances.push(h),y)for(e=0,n=h.siblings.length;n>e;e++)c=h.siblings[e],c.type.getCurrentSol().instances.push(c)}else{if(u[i]=h,y)for(e=0,n=h.siblings.length;n>e;e++)c=h.siblings[e],c.type.getCurrentSol().instances[i]=c;i++}else if(O){if(u[i]=h,y)for(e=0,n=h.siblings.length;n>e;e++)c=h.siblings[e],c.type.getCurrentSol().else_instances[i]=c;i++}else if(g&&(f.else_instances.push(h),y))for(e=0,n=h.siblings.length;n>e;e++)c=h.siblings[e],c.type.getCurrentSol().else_instances.push(c)}if(u.length=i,y)for(p=d.container,t=0,s=p.length;s>t;t++)l=p[t].getCurrentSol(),O?l.else_instances.length=i:l.instances.length=i;var E=A;if(O&&!A)for(t=0,s=f.instances.length;s>t;t++){if(h=f.instances[t],w)for(e=0,n=S.length;n>e;e++)r=S[e],r.variesPerInstance&&(T[e]=r.get(t));if(o=x?C.apply(h.behavior_insts[b],T):C.apply(h,T),cr.xor(o,k)){A=!0;break}}return d.finish&&d.finish(E||g),g?A:f.hasObjects()},cr.condition=h,c.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;e>t;t++)i=this.parameters[t],i.postInit(),i.variesPerInstance&&(this.anyParamVariesPerInstance=!0)},c.prototype.run_system=function(){var t,e;for(t=0,e=this.parameters.length;e>t;t++)this.results[t]=this.parameters[t].get();return this.func.apply(this.runtime.system,this.results)},c.prototype.run_object=function(){var t,e,i,s,n,r,o,a=this.type.getCurrentSol().getObjects(),h=this.type.is_family,c=this.type.family_index,l=this.beh_index,u=l>-1,p=this.anyParamVariesPerInstance,d=this.parameters,f=this.results,g=this.func;if(p)for(e=0,s=d.length;s>e;++e)n=d[e],n.variesPerInstance||(f[e]=n.get(0));else for(e=0,s=d.length;s>e;++e)f[e]=d[e].get(0);for(t=0,i=a.length;i>t;++t){if(r=a[t],p)for(e=0,s=d.length;s>e;++e)n=d[e],n.variesPerInstance&&(f[e]=n.get(t));u?(o=0,h&&(o=r.type.family_beh_map[c]),g.apply(r.behavior_insts[l+o],f)):g.apply(r,f)}return!1},cr.action=c;var g=[],m=-1;l.prototype.postInit=function(){var t,e;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type)for(t=0,e=this.subparams.length;e>t;t++)this.subparams[t].postInit();this.expression&&this.expression.postInit()},l.prototype.maybeVaryForType=function(t){return!this.variesPerInstance&&t?t.plugin.singleglobal?void 0:void(this.variesPerInstance=!0):void 0},l.prototype.setVaries=function(){this.variesPerInstance=!0},l.prototype.pushTempValue=function(){return m++,g.length===m&&g.push(new cr.expvalue),g[m]},l.prototype.popTempValue=function(){m--},l.prototype.get_exp=function(t){this.solindex=t||0;var e=this.pushTempValue();return this.expression.get(e),this.popTempValue(),e.data},l.prototype.get_exp_str=function(t){this.solindex=t||0;var e=this.pushTempValue();return this.expression.get(e),this.popTempValue(),cr.is_string(e.data)?e.data:""},l.prototype.get_object=function(){return this.object},l.prototype.get_combosel=function(){return this.combosel},l.prototype.get_layer=function(t){this.solindex=t||0;var e=this.pushTempValue();return this.expression.get(e),this.popTempValue(),e.is_number()?this.runtime.getLayerByNumber(e.data):this.runtime.getLayerByName(e.data)},l.prototype.get_layout=function(){return this.layout},l.prototype.get_key=function(){return this.key},l.prototype.get_instvar=function(){return this.index},l.prototype.get_familyvar=function(t){var e=t||0,i=this.owner.type,s=null,n=i.getCurrentSol(),r=n.getObjects();if(r.length)s=r[e%r.length].type;else if(n.else_instances.length)s=n.else_instances[e%n.else_instances.length].type;else{if(!i.instances.length)return 0;s=i.instances[e%i.instances.length].type}return this.index+s.family_var_map[i.family_index]},l.prototype.get_eventvar=function(){return this.eventvar},l.prototype.get_audiofile=function(){return this.fileinfo},l.prototype.get_variadic=function(){var t,e;for(t=0,e=this.subparams.length;e>t;t++)this.variadicret[t]=this.subparams[t].get();return this.variadicret},cr.parameter=l,u.prototype.postInit=function(){this.solModifiers=i(this.solModifiers)},u.prototype.setValue=function(t){var e=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&e?(this.localIndex>=e.length&&(e.length=this.localIndex+1),e[this.localIndex]=t):this.data=t},u.prototype.getValue=function(){var t=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!t||this.is_constant?this.data:this.localIndex>=t.length?this.initial:"undefined"==typeof t[this.localIndex]?this.initial:t[this.localIndex]},u.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)},cr.eventvariable=u,p.prototype.toString=function(){return"include:"+this.include_sheet.toString()},p.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name],this.sheet.includes.add(this),this.solModifiers=i(this.solModifiers);for(var t=this.parent;t;)t.group&&t.contained_includes.push(this),t=t.parent;this.updateActive()},p.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index),this.include_sheet.hasRun||this.include_sheet.run(!0),this.parent&&this.runtime.popSol(this.runtime.types_by_index)},p.prototype.updateActive=function(){for(var t=this.parent;t;){if(t.group&&!t.group_active)return void(this.active=!1);t=t.parent}this.active=!0},p.prototype.isActive=function(){return this.active},cr.eventinclude=p,d.prototype.reset=function(t){this.current_event=t,this.cndindex=0,this.actindex=0,this.temp_parents_arr.length=0,this.last_event_true=!1,this.else_branch_ran=!1,this.any_true_state=!1},d.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1},cr.eventStackFrame=d}(),function(){function t(t,e){this.owner=t,this.runtime=t.runtime,this.type=e[0],this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_behavior_exp,this.eval_instvar_exp,this.eval_object_behavior_exp,this.eval_eventvar_exp][this.type];var i=null;switch(this.value=null,this.first=null,this.second=null,this.third=null,this.func=null,this.results=null,this.parameters=null,this.object_type=null,this.beh_index=-1,this.instance_expr=null,this.varindex=-1,this.behavior_type=null,this.varname=null,this.eventvar=null,this.return_string=!1,this.type){case 0:case 1:case 2:this.value=e[1];break;case 3:this.first=new cr.expNode(t,e[1]);break;case 18:this.first=new cr.expNode(t,e[1]),this.second=new cr.expNode(t,e[2]),this.third=new cr.expNode(t,e[3]);break;case 19:this.func=e[1],(this.func===cr.system_object.prototype.exps.random||this.func===cr.system_object.prototype.exps.choose)&&this.owner.setVaries(),this.results=[],this.parameters=[],3===e.length?(i=e[2],this.results.length=i.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[e[1]],this.beh_index=-1,this.func=e[2],this.return_string=e[3],cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&this.owner.setVaries(),this.instance_expr=e[4]?new cr.expNode(t,e[4]):null,this.results=[],this.parameters=[],6===e.length?(i=e[5],this.results.length=i.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[e[1]],this.return_string=e[2],this.instance_expr=e[3]?new cr.expNode(t,e[3]):null,this.varindex=e[4];break;case 22:this.object_type=this.runtime.types_by_index[e[1]],this.behavior_type=this.object_type.getBehaviorByName(e[2]),this.beh_index=this.object_type.getBehaviorIndexByName(e[2]),this.func=e[3],this.return_string=e[4],this.instance_expr=e[5]?new cr.expNode(t,e[5]):null,this.results=[],this.parameters=[],7===e.length?(i=e[6],this.results.length=i.length+1):this.results.length=1;break;case 23:this.varname=e[1],this.eventvar=null}if(this.owner.maybeVaryForType(this.object_type),this.type>=4&&this.type<=17&&(this.first=new cr.expNode(t,e[1]),this.second=new cr.expNode(t,e[2])),i){var s,n;for(s=0,n=i.length;n>s;s++)this.parameters.push(new cr.expNode(t,i[s]))}cr.seal(this)}function e(t,e){this.type=t||cr.exptype.Integer,this.data=e||0,this.object_class=null,this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data)),cr.seal(this)}t.prototype.postInit=function(){if(23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent)),this.first&&this.first.postInit(),this.second&&this.second.postInit(),this.third&&this.third.postInit(),this.instance_expr&&this.instance_expr.postInit(),this.parameters){var t,e;for(t=0,e=this.parameters.length;e>t;t++)this.parameters[t].postInit()}},t.prototype.eval_system_exp=function(t){this.results[0]=t;var e,i,s=this.owner.pushTempValue();for(e=0,i=this.parameters.length;i>e;e++)this.parameters[e].get(s),this.results[e+1]=s.data;this.owner.popTempValue(),this.func.apply(this.runtime.system,this.results)},t.prototype.eval_object_behavior_exp=function(t){var e=this.object_type.getCurrentSol(),i=e.getObjects();if(!i.length){if(!e.else_instances.length)return void(this.return_string?t.set_string(""):t.set_int(0));i=e.else_instances}this.results[0]=t,t.object_class=this.object_type;var s,n,r=this.owner.pushTempValue();for(s=0,n=this.parameters.length;n>s;s++)this.parameters[s].get(r),this.results[s+1]=r.data;var o=this.owner.solindex;this.instance_expr&&(this.instance_expr.get(r),r.is_number()&&(o=r.data,i=this.object_type.instances)),this.owner.popTempValue(),o%=i.length,0>o&&(o+=i.length);var a,h=i[o];if(this.beh_index>-1){var c=0;this.object_type.is_family&&(c=h.type.family_beh_map[this.object_type.family_index]),a=this.func.apply(h.behavior_insts[this.beh_index+c],this.results)}else a=this.func.apply(h,this.results)},t.prototype.eval_instvar_exp=function(t){var e=this.object_type.getCurrentSol(),i=e.getObjects();if(!i.length){if(!e.else_instances.length)return void(this.return_string?t.set_string(""):t.set_int(0));i=e.else_instances}var s=this.owner.solindex;if(this.instance_expr){var n=this.owner.pushTempValue();if(this.instance_expr.get(n),n.is_number()){s=n.data;var r=this.object_type.instances;s%=r.length,0>s&&(s+=r.length);var o=r[s].instance_vars[this.varindex];return cr.is_string(o)?t.set_string(o):t.set_float(o),void this.owner.popTempValue()}this.owner.popTempValue()}s%=i.length,0>s&&(s+=i.length);var a=i[s],h=0;this.object_type.is_family&&(h=a.type.family_var_map[this.object_type.family_index]);var o=a.instance_vars[this.varindex+h];cr.is_string(o)?t.set_string(o):t.set_float(o)},t.prototype.eval_int=function(t){t.type=cr.exptype.Integer,t.data=this.value},t.prototype.eval_float=function(t){t.type=cr.exptype.Float,t.data=this.value},t.prototype.eval_string=function(t){t.type=cr.exptype.String,t.data=this.value},t.prototype.eval_unaryminus=function(t){this.first.get(t),t.is_number()&&(t.data=-t.data)},t.prototype.eval_add=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data+=e.data,e.is_float()&&t.make_float()),this.owner.popTempValue()},t.prototype.eval_subtract=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data-=e.data,e.is_float()&&t.make_float()),this.owner.popTempValue()},t.prototype.eval_multiply=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data*=e.data,e.is_float()&&t.make_float()),this.owner.popTempValue()},t.prototype.eval_divide=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data/=e.data,t.make_float()),this.owner.popTempValue()},t.prototype.eval_mod=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data%=e.data,e.is_float()&&t.make_float()),this.owner.popTempValue()},t.prototype.eval_power=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&(t.data=Math.pow(t.data,e.data),e.is_float()&&t.make_float()),this.owner.popTempValue()},t.prototype.eval_and=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()?e.is_string()?t.set_string(t.data.toString()+e.data):t.set_int(t.data&&e.data?1:0):t.is_string()&&(t.data+=e.is_string()?e.data:(Math.round(1e10*e.data)/1e10).toString()),this.owner.popTempValue()},t.prototype.eval_or=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.is_number()&&e.is_number()&&t.set_int(t.data||e.data?1:0),this.owner.popTempValue()},t.prototype.eval_conditional=function(t){this.first.get(t),t.data?this.second.get(t):this.third.get(t)},t.prototype.eval_equal=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data===e.data?1:0),this.owner.popTempValue()},t.prototype.eval_notequal=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data!==e.data?1:0),this.owner.popTempValue()},t.prototype.eval_less=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data<e.data?1:0),this.owner.popTempValue()},t.prototype.eval_lessequal=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data<=e.data?1:0),this.owner.popTempValue()},t.prototype.eval_greater=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data>e.data?1:0),this.owner.popTempValue()},t.prototype.eval_greaterequal=function(t){this.first.get(t);var e=this.owner.pushTempValue();this.second.get(e),t.set_int(t.data>=e.data?1:0),this.owner.popTempValue()},t.prototype.eval_eventvar_exp=function(t){var e=this.eventvar.getValue();cr.is_number(e)?t.set_float(e):t.set_string(e)},cr.expNode=t,e.prototype.is_int=function(){return this.type===cr.exptype.Integer},e.prototype.is_float=function(){return this.type===cr.exptype.Float},e.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float},e.prototype.is_string=function(){return this.type===cr.exptype.String},e.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),this.type=cr.exptype.Integer)},e.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)},e.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)},e.prototype.set_int=function(t){this.type=cr.exptype.Integer,this.data=Math.floor(t)},e.prototype.set_float=function(t){this.type=cr.exptype.Float,this.data=t},e.prototype.set_string=function(t){this.type=cr.exptype.String,this.data=t},e.prototype.set_any=function(t){cr.is_number(t)?(this.type=cr.exptype.Float,this.data=t):cr.is_string(t)?(this.type=cr.exptype.String,this.data=t.toString()):(this.type=cr.exptype.Integer,this.data=0)},cr.expvalue=e,cr.exptype={Integer:0,Float:1,String:2}}(),cr.system_object=function(t){this.runtime=t,this.waits=[]},cr.system_object.prototype.saveToJSON=function(){var t,e,i,s,n,r,o,a,h={};h.waits=[];var c,l=h.waits;for(t=0,e=this.waits.length;e>t;t++){for(r=this.waits[t],c={t:r.time,st:r.signaltag,s:r.signalled,ev:r.ev.sid,sm:[],sols:{}},r.ev.actions[r.actindex]&&(c.act=r.ev.actions[r.actindex].sid),i=0,s=r.solModifiers.length;s>i;i++)c.sm.push(r.solModifiers[i].sid);for(n in r.sols)if(r.sols.hasOwnProperty(n)){for(o=this.runtime.types_by_index[parseInt(n,10)],a={sa:r.sols[n].sa,insts:[]},i=0,s=r.sols[n].insts.length;s>i;i++)a.insts.push(r.sols[n].insts[i].uid);c.sols[o.sid.toString()]=a}l.push(c)}return h},cr.system_object.prototype.loadFromJSON=function(t){var e,i,s,n,r,o,a,h,c,l,u,p,d,f=t.waits;for(this.waits.length=0,e=0,i=f.length;i>e;e++)if(o=f[e],h=this.runtime.blocksBySid[o.ev.toString()]){for(c=-1,s=0,n=h.actions.length;n>s;s++)if(h.actions[s].sid===o.act){c=s;break}if(-1!==c){for(a={},a.sols={},a.solModifiers=[],a.deleteme=!1,a.time=o.t,a.signaltag=o.st||"",a.signalled=!!o.s,a.ev=h,a.actindex=c,s=0,n=o.sm.length;n>s;s++)l=this.runtime.getObjectTypeBySid(o.sm[s]),l&&a.solModifiers.push(l);for(r in o.sols)if(o.sols.hasOwnProperty(r)){if(l=this.runtime.getObjectTypeBySid(parseInt(r,10)),!l)continue;for(u=o.sols[r],p={sa:u.sa,insts:[]},s=0,n=u.insts.length;n>s;s++)d=this.runtime.getObjectByUID(u.insts[s]),d&&p.insts.push(d);a.sols[l.index.toString()]=p}this.waits.push(a)}}},function(){function t(){}function e(t,e){var i=t.extra.c2_feo_val,s=e.extra.c2_feo_val;return cr.is_number(i)&&cr.is_number(s)?i-s:(i=""+i,s=""+s,s>i?-1:i>s?1:0)}function i(t,e){return d&&t===f&&e===g||(d=new RegExp(t,e),f=t,g=e),d.lastIndex=0,d}function s(){}function n(){var t;return y.length?t=y.pop():(t={},t.sols={},t.solModifiers=[]),t.deleteme=!1,t}function r(t){cr.wipe(t.sols),t.solModifiers.length=0,y.push(t)}function o(){var t;return _.length?t=_.pop():(t={},t.insts=[]),t.sa=!1,t}function a(t){t.insts.length=0,_.push(t)}function h(){}function c(t,e,s){if(t!==b||e!==x||s!==w){var n=i(e,s);v=t.match(n),b=t,x=e,w=s}}var l=cr.system_object.prototype;t.prototype.EveryTick=function(){return!0},t.prototype.OnLayoutStart=function(){return!0},t.prototype.OnLayoutEnd=function(){return!0},t.prototype.Compare=function(t,e,i){return cr.do_cmp(t,e,i)},t.prototype.CompareTime=function(t,e){var i=this.runtime.kahanTime.sum;if(0===t){var s=this.runtime.getCurrentCondition();return!s.extra.CompareTime_executed&&i>=e?(s.extra.CompareTime_executed=!0,!0):!1}return cr.do_cmp(i,t,e)},t.prototype.LayerVisible=function(t){return t?t.visible:!1},t.prototype.LayerCmpOpacity=function(t,e,i){return t?cr.do_cmp(100*t.opacity,e,i):!1},t.prototype.Repeat=function(t){var e,i=this.runtime.getCurrentEventStack(),s=i.current_event,n=i.isModifierAfterCnds(),r=this.runtime.pushLoopStack();if(n)for(e=0;t>e&&!r.stopped;e++)this.runtime.pushCopySol(s.solModifiers),r.index=e,s.retrigger(),this.runtime.popSol(s.solModifiers);else for(e=0;t>e&&!r.stopped;e++)r.index=e,s.retrigger();return this.runtime.popLoopStack(),!1},t.prototype.While=function(){var t,e=this.runtime.getCurrentEventStack(),i=e.current_event,s=e.isModifierAfterCnds(),n=this.runtime.pushLoopStack();if(s)for(t=0;!n.stopped;t++)this.runtime.pushCopySol(i.solModifiers),n.index=t,i.retrigger()||(n.stopped=!0),this.runtime.popSol(i.solModifiers);else for(t=0;!n.stopped;t++)n.index=t,i.retrigger()||(n.stopped=!0);return this.runtime.popLoopStack(),!1},t.prototype.For=function(t,e,i){var s,n=this.runtime.getCurrentEventStack(),r=n.current_event,o=n.isModifierAfterCnds(),a=this.runtime.pushLoopStack(t);if(e>i)if(o)for(s=e;s>=i&&!a.stopped;--s)this.runtime.pushCopySol(r.solModifiers),a.index=s,r.retrigger(),this.runtime.popSol(r.solModifiers);else for(s=e;s>=i&&!a.stopped;--s)a.index=s,r.retrigger();else if(o)for(s=e;i>=s&&!a.stopped;++s)this.runtime.pushCopySol(r.solModifiers),a.index=s,r.retrigger(),this.runtime.popSol(r.solModifiers);else for(s=e;i>=s&&!a.stopped;++s)a.index=s,r.retrigger();return this.runtime.popLoopStack(),!1};var u=[],p=-1;t.prototype.ForEach=function(t){var e=t.getCurrentSol();p++,u.length===p&&u.push([]);var i=u[p];cr.shallowAssignArray(i,e.getObjects());var s,n,r,o,a,h,c,l=this.runtime.getCurrentEventStack(),d=l.current_event,f=l.isModifierAfterCnds(),g=this.runtime.pushLoopStack(),m=t.is_contained;if(f)for(s=0,n=i.length;n>s&&!g.stopped;s++){if(this.runtime.pushCopySol(d.solModifiers),a=i[s],e=t.getCurrentSol(),e.select_all=!1,e.instances.length=1,e.instances[0]=a,m)for(r=0,o=a.siblings.length;o>r;r++)h=a.siblings[r],c=h.type.getCurrentSol(),c.select_all=!1,c.instances.length=1,c.instances[0]=h;g.index=s,d.retrigger(),this.runtime.popSol(d.solModifiers)}else for(e.select_all=!1,e.instances.length=1,s=0,n=i.length;n>s&&!g.stopped;s++){if(a=i[s],e.instances[0]=a,m)for(r=0,o=a.siblings.length;o>r;r++)h=a.siblings[r],c=h.type.getCurrentSol(),c.select_all=!1,c.instances.length=1,c.instances[0]=h;g.index=s,d.retrigger()}return i.length=0,this.runtime.popLoopStack(),p--,!1},t.prototype.ForEachOrdered=function(t,i,s){var n=t.getCurrentSol();p++,u.length===p&&u.push([]);var r=u[p];cr.shallowAssignArray(r,n.getObjects());var o,a,h,c,l,d,f,g=this.runtime.getCurrentEventStack(),m=g.current_event,y=this.runtime.getCurrentCondition(),_=g.isModifierAfterCnds(),v=this.runtime.pushLoopStack();for(o=0,a=r.length;a>o;o++)r[o].extra.c2_feo_val=y.parameters[1].get(o);r.sort(e),1===s&&r.reverse();var b=t.is_contained;if(_)for(o=0,a=r.length;a>o&&!v.stopped;o++){if(this.runtime.pushCopySol(m.solModifiers),l=r[o],n=t.getCurrentSol(),n.select_all=!1,n.instances.length=1,n.instances[0]=l,b)for(h=0,c=l.siblings.length;c>h;h++)d=l.siblings[h],f=d.type.getCurrentSol(),f.select_all=!1,f.instances.length=1,f.instances[0]=d;v.index=o,m.retrigger(),this.runtime.popSol(m.solModifiers)}else for(n.select_all=!1,n.instances.length=1,o=0,a=r.length;a>o&&!v.stopped;o++){if(l=r[o],n.instances[0]=l,b)for(h=0,c=l.siblings.length;c>h;h++)d=l.siblings[h],f=d.type.getCurrentSol(),f.select_all=!1,f.instances.length=1,f.instances[0]=d;v.index=o,m.retrigger()}return r.length=0,this.runtime.popLoopStack(),p--,!1},t.prototype.PickByComparison=function(t,e,i,s){var n,r,o,a;if(t){p++,u.length===p&&u.push([]);var h=u[p],c=t.getCurrentSol();cr.shallowAssignArray(h,c.getObjects()),c.select_all&&(c.else_instances.length=0);var l=this.runtime.getCurrentCondition();for(n=0,o=0,r=h.length;r>n;n++)a=h[n],h[o]=a,e=l.parameters[1].get(n),s=l.parameters[3].get(n),cr.do_cmp(e,i,s)?o++:c.else_instances.push(a);return h.length=o,c.select_all=!1,cr.shallowAssignArray(c.instances,h),h.length=0,p--,t.applySolToContainer(),!!c.instances.length}},t.prototype.PickByEvaluate=function(t,e){var i,s,n,r;if(t){p++,u.length===p&&u.push([]);var o=u[p],a=t.getCurrentSol();cr.shallowAssignArray(o,a.getObjects()),a.select_all&&(a.else_instances.length=0);var h=this.runtime.getCurrentCondition();for(i=0,n=0,s=o.length;s>i;i++)r=o[i],o[n]=r,e=h.parameters[1].get(i),e?n++:a.else_instances.push(r);return o.length=n,a.select_all=!1,cr.shallowAssignArray(a.instances,o),o.length=0,p--,t.applySolToContainer(),!!a.instances.length}},t.prototype.TriggerOnce=function(){var t=this.runtime.getCurrentCondition().extra;"undefined"==typeof t.TriggerOnce_lastTick&&(t.TriggerOnce_lastTick=-1);var e=t.TriggerOnce_lastTick,i=this.runtime.tickcount;return t.TriggerOnce_lastTick=i,this.runtime.layout_first_tick||e!==i-1},t.prototype.Every=function(t){var e=this.runtime.getCurrentCondition(),i=e.extra.Every_lastTime||0,s=this.runtime.kahanTime.sum;"undefined"==typeof e.extra.Every_seconds&&(e.extra.Every_seconds=t);var n=e.extra.Every_seconds;return s>=i+n?(e.extra.Every_lastTime=i+n,s>=e.extra.Every_lastTime+.04&&(e.extra.Every_lastTime=s),e.extra.Every_seconds=t,!0):(i-.1>s&&(e.extra.Every_lastTime=s),!1)},t.prototype.PickNth=function(t,e){if(!t)return!1;var i=t.getCurrentSol(),s=i.getObjects();if(e=cr.floor(e),0>e||e>=s.length)return!1;var n=s[e];return i.pick_one(n),t.applySolToContainer(),!0},t.prototype.PickRandom=function(t){if(!t)return!1;var e=t.getCurrentSol(),i=e.getObjects(),s=cr.floor(Math.random()*i.length);if(s>=i.length)return!1;var n=i[s];return e.pick_one(n),t.applySolToContainer(),!0},t.prototype.CompareVar=function(t,e,i){return cr.do_cmp(t.getValue(),e,i)},t.prototype.IsGroupActive=function(t){var e=this.runtime.groups_by_name[t.toLowerCase()];return e&&e.group_active},t.prototype.IsPreview=function(){return"undefined"!=typeof cr_is_preview},t.prototype.PickAll=function(t){if(!t)return!1;if(!t.instances.length)return!1;var e=t.getCurrentSol();return e.select_all=!0,t.applySolToContainer(),!0},t.prototype.IsMobile=function(){return this.runtime.isMobile},t.prototype.CompareBetween=function(t,e,i){return t>=e&&i>=t},t.prototype.Else=function(){var t=this.runtime.getCurrentEventStack();return t.else_branch_ran?!1:!t.last_event_true},t.prototype.OnLoadFinished=function(){return!0},t.prototype.OnCanvasSnapshot=function(){return!0},t.prototype.EffectsSupported=function(){return!!this.runtime.glwrap},t.prototype.OnSaveComplete=function(){return!0},t.prototype.OnLoadComplete=function(){return!0},t.prototype.OnLoadFailed=function(){return!0},t.prototype.ObjectUIDExists=function(t){return!!this.runtime.getObjectByUID(t)},t.prototype.IsOnPlatform=function(t){var e=this.runtime;switch(t){case 0:return!(e.isDomFree||e.isNodeWebkit||e.isPhoneGap||e.isCrosswalk||e.isWinJS||e.isWindowsPhone8||e.isBlackberry10||e.isAmazonWebApp);case 1:return e.isiOS;case 2:return e.isAndroid;case 3:return e.isWindows8App;case 4:return e.isWindowsPhone8;case 5:return e.isBlackberry10;case 6:return e.isTizen;case 7:return e.isCocoonJs;case 8:return e.isPhoneGap;case 9:return e.isArcade;case 10:return e.isNodeWebkit;case 11:return e.isCrosswalk;case 12:return e.isAmazonWebApp;default:return!1}};var d=null,f="",g="";t.prototype.RegexTest=function(t,e,s){var n=i(e,s);return n.test(t)};var m=[];t.prototype.PickOverlappingPoint=function(t,e,i){if(!t)return!1;var s,n,r,o,a=t.getCurrentSol(),h=a.getObjects(),c=this.runtime.getCurrentEventStack().current_event,l=c.orblock,u=this.runtime.getCurrentCondition();for(a.select_all?(cr.shallowAssignArray(m,h),a.else_instances.length=0,a.select_all=!1,a.instances.length=0):l?(cr.shallowAssignArray(m,a.else_instances),a.else_instances.length=0):(cr.shallowAssignArray(m,h),a.instances.length=0),s=0,n=m.length;n>s;++s)r=m[s],r.update_bbox(),o=cr.xor(r.contains_pt(e,i),u.inverted),o?a.instances.push(r):a.else_instances.push(r);return t.applySolToContainer(),cr.xor(!!a.instances.length,u.inverted)},l.cnds=new t,s.prototype.GoToLayout=function(t){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=t)},s.prototype.NextPrevLayout=function(t){if(!this.runtime.isloading&&!this.runtime.changelayout){var e=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!(t&&0===e||!t&&e===this.runtime.layouts_by_index.length-1)){var i=this.runtime.layouts_by_index[e+(t?-1:1)];this.runtime.changelayout=i}}},s.prototype.CreateObject=function(t,e,i,s){if(e&&t){var n=this.runtime.createInstance(t,e,i,s);if(n){this.runtime.isInOnDestroy++;var r,o,a;if(this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,n),n.is_contained)for(r=0,o=n.siblings.length;o>r;r++)a=n.siblings[r],this.runtime.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnCreated,a);this.runtime.isInOnDestroy--;var h=t.getCurrentSol();if(h.select_all=!1,h.instances.length=1,h.instances[0]=n,n.is_contained)for(r=0,o=n.siblings.length;o>r;r++)a=n.siblings[r],h=a.type.getCurrentSol(),h.select_all=!1,h.instances.length=1,h.instances[0]=a}}},s.prototype.SetLayerVisible=function(t,e){t&&t.visible!==e&&(t.visible=e,this.runtime.redraw=!0)},s.prototype.SetLayerOpacity=function(t,e){t&&(e=cr.clamp(e/100,0,1),t.opacity!==e&&(t.opacity=e,this.runtime.redraw=!0))},s.prototype.SetLayerScaleRate=function(t,e){t&&t.zoomRate!==e&&(t.zoomRate=e,this.runtime.redraw=!0)},s.prototype.SetLayoutScale=function(t){this.runtime.running_layout&&this.runtime.running_layout.scale!==t&&(this.runtime.running_layout.scale=t,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)},s.prototype.ScrollX=function(t){this.runtime.running_layout.scrollToX(t)},s.prototype.ScrollY=function(t){this.runtime.running_layout.scrollToY(t)},s.prototype.Scroll=function(t,e){this.runtime.running_layout.scrollToX(t),this.runtime.running_layout.scrollToY(e)},s.prototype.ScrollToObject=function(t){var e=t.getFirstPicked();e&&(this.runtime.running_layout.scrollToX(e.x),this.runtime.running_layout.scrollToY(e.y))},s.prototype.SetVar=function(t,e){0===t.vartype?t.setValue(cr.is_number(e)?e:parseFloat(e)):1===t.vartype&&t.setValue(e.toString())},s.prototype.AddVar=function(t,e){0===t.vartype?t.setValue(cr.is_number(e)?t.getValue()+e:t.getValue()+parseFloat(e)):1===t.vartype&&t.setValue(t.getValue()+e.toString())},s.prototype.SubVar=function(t,e){0===t.vartype&&t.setValue(cr.is_number(e)?t.getValue()-e:t.getValue()-parseFloat(e))},s.prototype.SetGroupActive=function(t,e){var i=this.runtime.groups_by_name[t.toLowerCase()];if(i)switch(e){case 0:i.setGroupActive(!1);break;case 1:i.setGroupActive(!0);break;case 2:i.setGroupActive(!i.group_active)}},s.prototype.SetTimescale=function(t){var e=t;0>e&&(e=0),this.runtime.timescale=e},s.prototype.SetObjectTimescale=function(t,e){var i=e;if(0>i&&(i=0),t){var s,n,r=t.getCurrentSol(),o=r.getObjects();for(s=0,n=o.length;n>s;s++)o[s].my_timescale=i}},s.prototype.RestoreObjectTimescale=function(t){if(!t)return!1;var e,i,s=t.getCurrentSol(),n=s.getObjects();for(e=0,i=n.length;i>e;e++)n[e].my_timescale=-1};var y=[],_=[];s.prototype.Wait=function(t){if(!(0>t)){var e,i,s,r,a,h=this.runtime.getCurrentEventStack(),c=n();for(c.time=this.runtime.kahanTime.sum+t,c.signaltag="",c.signalled=!1,c.ev=h.current_event,c.actindex=h.actindex+1,e=0,i=this.runtime.types_by_index.length;i>e;e++)r=this.runtime.types_by_index[e],s=r.getCurrentSol(),s.select_all&&-1===h.current_event.solModifiers.indexOf(r)||(c.solModifiers.push(r),a=o(),a.sa=s.select_all,cr.shallowAssignArray(a.insts,s.instances),c.sols[e.toString()]=a);return this.waits.push(c),!0}},s.prototype.WaitForSignal=function(t){var e,i,s,r,a,h=this.runtime.getCurrentEventStack(),c=n();for(c.time=-1,c.signaltag=t.toLowerCase(),c.signalled=!1,c.ev=h.current_event,c.actindex=h.actindex+1,e=0,i=this.runtime.types_by_index.length;i>e;e++)r=this.runtime.types_by_index[e],s=r.getCurrentSol(),s.select_all&&-1===h.current_event.solModifiers.indexOf(r)||(c.solModifiers.push(r),a=o(),a.sa=s.select_all,cr.shallowAssignArray(a.insts,s.instances),c.sols[e.toString()]=a);return this.waits.push(c),!0},s.prototype.Signal=function(t){var e,i,s,n=t.toLowerCase();
for(e=0,i=this.waits.length;i>e;++e)s=this.waits[e],-1===s.time&&s.signaltag===n&&(s.signalled=!0)},s.prototype.SetLayerScale=function(t,e){t&&t.scale!==e&&(t.scale=e,this.runtime.redraw=!0)},s.prototype.ResetGlobals=function(){var t,e,i;for(t=0,e=this.runtime.all_global_vars.length;e>t;t++)i=this.runtime.all_global_vars[t],i.data=i.initial},s.prototype.SetLayoutAngle=function(t){t=cr.to_radians(t),t=cr.clamp_angle(t),this.runtime.running_layout&&this.runtime.running_layout.angle!==t&&(this.runtime.running_layout.angle=t,this.runtime.redraw=!0)},s.prototype.SetLayerAngle=function(t,e){t&&(e=cr.to_radians(e),e=cr.clamp_angle(e),t.angle!==e&&(t.angle=e,this.runtime.redraw=!0))},s.prototype.SetLayerParallax=function(t,e,i){if(t&&(t.parallaxX!==e/100||t.parallaxY!==i/100)){if(t.parallaxX=e/100,t.parallaxY=i/100,1!==t.parallaxX||1!==t.parallaxY){var s,n,r=t.instances;for(s=0,n=r.length;n>s;++s)r[s].type.any_instance_parallaxed=!0}this.runtime.redraw=!0}},s.prototype.SetLayerBackground=function(t,e){if(t){var i=cr.GetRValue(e),s=cr.GetGValue(e),n=cr.GetBValue(e);(t.background_color[0]!==i||t.background_color[1]!==s||t.background_color[2]!==n)&&(t.background_color[0]=i,t.background_color[1]=s,t.background_color[2]=n,this.runtime.redraw=!0)}},s.prototype.SetLayerTransparent=function(t,e){t&&!!e!=!!t.transparent&&(t.transparent=!!e,this.runtime.redraw=!0)},s.prototype.StopLoop=function(){this.runtime.loop_stack_index<0||(this.runtime.getCurrentLoop().stopped=!0)},s.prototype.GoToLayoutByName=function(t){if(!this.runtime.isloading&&!this.runtime.changelayout){var e;for(e in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(e)&&cr.equals_nocase(e,t))return void(this.runtime.changelayout=this.runtime.layouts[e])}},s.prototype.RestartLayout=function(){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var t,e,i;for(t=0,e=this.runtime.allGroups.length;e>t;t++)i=this.runtime.allGroups[t],i.setGroupActive(i.initially_activated)}},s.prototype.SnapshotCanvas=function(t,e){this.runtime.snapshotCanvas=[0===t?"image/png":"image/jpeg",e/100],this.runtime.redraw=!0},s.prototype.SetCanvasSize=function(t,e){if(!(0>=t||0>=e)){var i=this.runtime.fullscreen_mode,s=document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen;s&&this.runtime.fullscreen_scaling>0&&(i=this.runtime.fullscreen_scaling),0===i?this.runtime.setSize(t,e,!0):(this.runtime.original_width=t,this.runtime.original_height=e,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}},s.prototype.SetLayoutEffectEnabled=function(t,e){if(this.runtime.running_layout&&this.runtime.glwrap){var i=this.runtime.running_layout.getEffectByName(e);if(i){var s=1===t;i.active!=s&&(i.active=s,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0)}}},s.prototype.SetLayerEffectEnabled=function(t,e,i){if(t&&this.runtime.glwrap){var s=t.getEffectByName(i);if(s){var n=1===e;s.active!=n&&(s.active=n,t.updateActiveEffects(),this.runtime.redraw=!0)}}},s.prototype.SetLayoutEffectParam=function(t,e,i){if(this.runtime.running_layout&&this.runtime.glwrap){var s=this.runtime.running_layout.getEffectByName(t);if(s){var n=this.runtime.running_layout.effect_params[s.index];e=Math.floor(e),0>e||e>=n.length||(1===this.runtime.glwrap.getProgramParameterType(s.shaderindex,e)&&(i/=100),n[e]!==i&&(n[e]=i,s.active&&(this.runtime.redraw=!0)))}}},s.prototype.SetLayerEffectParam=function(t,e,i,s){if(t&&this.runtime.glwrap){var n=t.getEffectByName(e);if(n){var r=t.effect_params[n.index];i=Math.floor(i),0>i||i>=r.length||(1===this.runtime.glwrap.getProgramParameterType(n.shaderindex,i)&&(s/=100),r[i]!==s&&(r[i]=s,n.active&&(this.runtime.redraw=!0)))}}},s.prototype.SaveState=function(t){this.runtime.saveToSlot=t},s.prototype.LoadState=function(t){this.runtime.loadFromSlot=t},s.prototype.LoadStateJSON=function(t){this.runtime.loadFromJson=t},s.prototype.SetHalfFramerateMode=function(t){this.runtime.halfFramerateMode=0!==t},s.prototype.SetFullscreenQuality=function(t){var e=document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen;(e||0!==this.runtime.fullscreen_mode)&&(this.runtime.wantFullscreenScalingQuality=0!==t,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))},l.acts=new s,h.prototype["int"]=function(t,e){cr.is_string(e)?(t.set_int(parseInt(e,10)),isNaN(t.data)&&(t.data=0)):t.set_int(e)},h.prototype["float"]=function(t,e){cr.is_string(e)?(t.set_float(parseFloat(e)),isNaN(t.data)&&(t.data=0)):t.set_float(e)},h.prototype.str=function(t,e){t.set_string(cr.is_string(e)?e:e.toString())},h.prototype.len=function(t,e){t.set_int(e.length||0)},h.prototype.random=function(t,e,i){t.set_float(void 0===i?Math.random()*e:Math.random()*(i-e)+e)},h.prototype.sqrt=function(t,e){t.set_float(Math.sqrt(e))},h.prototype.abs=function(t,e){t.set_float(Math.abs(e))},h.prototype.round=function(t,e){t.set_int(Math.round(e))},h.prototype.floor=function(t,e){t.set_int(Math.floor(e))},h.prototype.ceil=function(t,e){t.set_int(Math.ceil(e))},h.prototype.sin=function(t,e){t.set_float(Math.sin(cr.to_radians(e)))},h.prototype.cos=function(t,e){t.set_float(Math.cos(cr.to_radians(e)))},h.prototype.tan=function(t,e){t.set_float(Math.tan(cr.to_radians(e)))},h.prototype.asin=function(t,e){t.set_float(cr.to_degrees(Math.asin(e)))},h.prototype.acos=function(t,e){t.set_float(cr.to_degrees(Math.acos(e)))},h.prototype.atan=function(t,e){t.set_float(cr.to_degrees(Math.atan(e)))},h.prototype.exp=function(t,e){t.set_float(Math.exp(e))},h.prototype.ln=function(t,e){t.set_float(Math.log(e))},h.prototype.log10=function(t,e){t.set_float(Math.log(e)/Math.LN10)},h.prototype.max=function(t){var e=arguments[1];"number"!=typeof e&&(e=0);var i,s,n;for(i=2,s=arguments.length;s>i;i++)n=arguments[i],"number"==typeof n&&n>e&&(e=n);t.set_float(e)},h.prototype.min=function(t){var e=arguments[1];"number"!=typeof e&&(e=0);var i,s,n;for(i=2,s=arguments.length;s>i;i++)n=arguments[i],"number"==typeof n&&e>n&&(e=n);t.set_float(e)},h.prototype.dt=function(t){t.set_float(this.runtime.dt)},h.prototype.timescale=function(t){t.set_float(this.runtime.timescale)},h.prototype.wallclocktime=function(t){t.set_float((Date.now()-this.runtime.start_time)/1e3)},h.prototype.time=function(t){t.set_float(this.runtime.kahanTime.sum)},h.prototype.tickcount=function(t){t.set_int(this.runtime.tickcount)},h.prototype.objectcount=function(t){t.set_int(this.runtime.objectcount)},h.prototype.fps=function(t){t.set_int(this.runtime.fps)},h.prototype.loopindex=function(t,e){var i,s,n;if(!this.runtime.loop_stack.length)return void t.set_int(0);if(e){for(s=0,n=this.runtime.loop_stack.length;n>s;s++)if(i=this.runtime.loop_stack[s],i.name===e)return void t.set_int(i.index);t.set_int(0)}else i=this.runtime.getCurrentLoop(),t.set_int(i?i.index:-1)},h.prototype.distance=function(t,e,i,s,n){t.set_float(cr.distanceTo(e,i,s,n))},h.prototype.angle=function(t,e,i,s,n){t.set_float(cr.to_degrees(cr.angleTo(e,i,s,n)))},h.prototype.scrollx=function(t){t.set_float(this.runtime.running_layout.scrollX)},h.prototype.scrolly=function(t){t.set_float(this.runtime.running_layout.scrollY)},h.prototype.newline=function(t){t.set_string("\n")},h.prototype.lerp=function(t,e,i,s){t.set_float(cr.lerp(e,i,s))},h.prototype.qarp=function(t,e,i,s,n){t.set_float(cr.qarp(e,i,s,n))},h.prototype.cubic=function(t,e,i,s,n,r){t.set_float(cr.cubic(e,i,s,n,r))},h.prototype.cosp=function(t,e,i,s){t.set_float(cr.cosp(e,i,s))},h.prototype.windowwidth=function(t){t.set_int(this.runtime.width)},h.prototype.windowheight=function(t){t.set_int(this.runtime.height)},h.prototype.uppercase=function(t,e){t.set_string(cr.is_string(e)?e.toUpperCase():"")},h.prototype.lowercase=function(t,e){t.set_string(cr.is_string(e)?e.toLowerCase():"")},h.prototype.clamp=function(t,e,i,s){t.set_float(i>e?i:e>s?s:e)},h.prototype.layerscale=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.scale:0)},h.prototype.layeropacity=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?100*i.opacity:0)},h.prototype.layerscalerate=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.zoomRate:0)},h.prototype.layerparallaxx=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?100*i.parallaxX:0)},h.prototype.layerparallaxy=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?100*i.parallaxY:0)},h.prototype.layoutscale=function(t){t.set_float(this.runtime.running_layout?this.runtime.running_layout.scale:0)},h.prototype.layoutangle=function(t){t.set_float(cr.to_degrees(this.runtime.running_layout.angle))},h.prototype.layerangle=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?cr.to_degrees(i.angle):0)},h.prototype.layoutwidth=function(t){t.set_int(this.runtime.running_layout.width)},h.prototype.layoutheight=function(t){t.set_int(this.runtime.running_layout.height)},h.prototype.find=function(t,e,i){t.set_int(cr.is_string(e)&&cr.is_string(i)?e.search(new RegExp(cr.regexp_escape(i),"i")):-1)},h.prototype.left=function(t,e,i){t.set_string(cr.is_string(e)?e.substr(0,i):"")},h.prototype.right=function(t,e,i){t.set_string(cr.is_string(e)?e.substr(e.length-i):"")},h.prototype.mid=function(t,e,i,s){t.set_string(cr.is_string(e)?e.substr(i,s):"")},h.prototype.tokenat=function(t,e,i,s){if(cr.is_string(e)&&cr.is_string(s)){var n=e.split(s),r=cr.floor(i);t.set_string(0>r||r>=n.length?"":n[r])}else t.set_string("")},h.prototype.tokencount=function(t,e,i){t.set_int(cr.is_string(e)&&e.length?e.split(i).length:0)},h.prototype.replace=function(t,e,i,s){t.set_string(cr.is_string(e)&&cr.is_string(i)&&cr.is_string(s)?e.replace(new RegExp(cr.regexp_escape(i),"gi"),s):cr.is_string(e)?e:"")},h.prototype.trim=function(t,e){t.set_string(cr.is_string(e)?e.trim():"")},h.prototype.pi=function(t){t.set_float(cr.PI)},h.prototype.layoutname=function(t){t.set_string(this.runtime.running_layout?this.runtime.running_layout.name:"")},h.prototype.renderer=function(t){t.set_string(this.runtime.gl?"webgl":"canvas2d")},h.prototype.anglediff=function(t,e,i){t.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(e),cr.to_radians(i))))},h.prototype.choose=function(t){var e=cr.floor(Math.random()*(arguments.length-1));t.set_any(arguments[e+1])},h.prototype.rgb=function(t,e,i,s){t.set_int(cr.RGB(e,i,s))},h.prototype.projectversion=function(t){t.set_string(this.runtime.versionstr)},h.prototype.projectname=function(t){t.set_string(this.runtime.projectName)},h.prototype.anglelerp=function(t,e,i,s){e=cr.to_radians(e),i=cr.to_radians(i);var n=cr.angleDiff(e,i);t.set_float(cr.to_clamped_degrees(cr.angleClockwise(i,e)?e+n*s:e-n*s))},h.prototype.anglerotate=function(t,e,i,s){e=cr.to_radians(e),i=cr.to_radians(i),s=cr.to_radians(s),t.set_float(cr.to_clamped_degrees(cr.angleRotate(e,i,s)))},h.prototype.zeropad=function(t,e,i){var s=0>e?"-":"";0>e&&(e=-e);for(var n=i-e.toString().length,r=0;n>r;r++)s+="0";t.set_string(s+e.toString())},h.prototype.cpuutilisation=function(t){t.set_float(this.runtime.cpuutilisation/1e3)},h.prototype.viewportleft=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewLeft:0)},h.prototype.viewporttop=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewTop:0)},h.prototype.viewportright=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewRight:0)},h.prototype.viewportbottom=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewBottom:0)},h.prototype.loadingprogress=function(t){t.set_float(this.runtime.loadingprogress)},h.prototype.unlerp=function(t,e,i,s){t.set_float(cr.unlerp(e,i,s))},h.prototype.canvassnapshot=function(t){t.set_string(this.runtime.snapshotData)},h.prototype.urlencode=function(t,e){t.set_string(encodeURIComponent(e))},h.prototype.urldecode=function(t,e){t.set_string(decodeURIComponent(e))},h.prototype.canvastolayerx=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.canvasToLayer(i,s,!0):0)},h.prototype.canvastolayery=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.canvasToLayer(i,s,!1):0)},h.prototype.layertocanvasx=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.layerToCanvas(i,s,!0):0)},h.prototype.layertocanvasy=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.layerToCanvas(i,s,!1):0)},h.prototype.savestatejson=function(t){t.set_string(this.runtime.lastSaveJson)},h.prototype.imagememoryusage=function(t){t.set_float(this.runtime.glwrap?Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100:0)},h.prototype.regexsearch=function(t,e,s,n){var r=i(s,n);t.set_int(e?e.search(r):-1)},h.prototype.regexreplace=function(t,e,s,n,r){var o=i(s,n);t.set_string(e?e.replace(o,r):"")};var v=[],b="",x="",w="";h.prototype.regexmatchcount=function(t,e,s,n){i(s,n);c(e,s,n),t.set_int(v?v.length:0)},h.prototype.regexmatchat=function(t,e,s,n,r){r=Math.floor(r);i(s,n);c(e,s,n),t.set_string(!v||0>r||r>=v.length?"":v[r])},h.prototype.infinity=function(t){t.set_float(1/0)},h.prototype.setbit=function(t,e,i,s){e=0|e,i=0|i,s=0!==s?1:0,t.set_int(e&~(1<<i)|s<<i)},h.prototype.togglebit=function(t,e,i){e=0|e,i=0|i,t.set_int(e^1<<i)},h.prototype.getbit=function(t,e,i){e=0|e,i=0|i,t.set_int(e&1<<i?1:0)},h.prototype.originalwindowwidth=function(t){t.set_int(this.runtime.original_width)},h.prototype.originalwindowheight=function(t){t.set_int(this.runtime.original_height)},l.exps=new h,l.runWaits=function(){var t,e,i,s,n,o,h,c=this.runtime.getCurrentEventStack();for(t=0,i=this.waits.length;i>t;t++){if(s=this.waits[t],-1===s.time){if(!s.signalled)continue}else if(s.time>this.runtime.kahanTime.sum)continue;c.current_event=s.ev,c.actindex=s.actindex,c.cndindex=0;for(n in s.sols)s.sols.hasOwnProperty(n)&&(o=this.runtime.types_by_index[parseInt(n,10)].getCurrentSol(),h=s.sols[n],o.select_all=h.sa,cr.shallowAssignArray(o.instances,h.insts),a(h));s.ev.resume_actions_and_subevents(),this.runtime.clearSol(s.solModifiers),s.deleteme=!0}for(t=0,e=0,i=this.waits.length;i>t;t++)s=this.waits[t],this.waits[e]=s,s.deleteme?r(s):e++;this.waits.length=e}}(),function(){cr.add_common_aces=function(t){var e=t[0].prototype,i=t[1],s=t[3],n=t[4],r=t[5],o=t[6],a=t[7],h=t[8];e.cnds||(e.cnds={}),e.acts||(e.acts={}),e.exps||(e.exps={});var c=e.cnds,l=e.acts,u=e.exps;s&&(c.CompareX=function(t,e){return cr.do_cmp(this.x,t,e)},c.CompareY=function(t,e){return cr.do_cmp(this.y,t,e)},c.IsOnScreen=function(){var t=this.layer;this.update_bbox();var e=this.bbox;return!(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)},c.IsOutsideLayout=function(){this.update_bbox();var t=this.bbox,e=this.runtime.running_layout;return t.right<0||t.bottom<0||t.left>e.width||t.top>e.height},c.PickDistance=function(t,e,i){var s=this.getCurrentSol(),n=s.getObjects();if(!n.length)return!1;var r,o,a,h=n[0],c=h,l=cr.distanceTo(h.x,h.y,e,i);for(r=1,o=n.length;o>r;r++)h=n[r],a=cr.distanceTo(h.x,h.y,e,i),(0===t&&l>a||1===t&&a>l)&&(l=a,c=h);return s.pick_one(c),!0},l.SetX=function(t){this.x!==t&&(this.x=t,this.set_bbox_changed())},l.SetY=function(t){this.y!==t&&(this.y=t,this.set_bbox_changed())},l.SetPos=function(t,e){(this.x!==t||this.y!==e)&&(this.x=t,this.y=e,this.set_bbox_changed())},l.SetPosToObject=function(t,e){var i=t.getPairedInstance(this);if(i){var s,n;i.getImagePoint?(s=i.getImagePoint(e,!0),n=i.getImagePoint(e,!1)):(s=i.x,n=i.y),(this.x!==s||this.y!==n)&&(this.x=s,this.y=n,this.set_bbox_changed())}},l.MoveForward=function(t){0!==t&&(this.x+=Math.cos(this.angle)*t,this.y+=Math.sin(this.angle)*t,this.set_bbox_changed())},l.MoveAtAngle=function(t,e){0!==e&&(this.x+=Math.cos(cr.to_radians(t))*e,this.y+=Math.sin(cr.to_radians(t))*e,this.set_bbox_changed())},u.X=function(t){t.set_float(this.x)},u.Y=function(t){t.set_float(this.y)},u.dt=function(t){t.set_float(this.runtime.getDt(this))}),n&&(c.CompareWidth=function(t,e){return cr.do_cmp(this.width,t,e)},c.CompareHeight=function(t,e){return cr.do_cmp(this.height,t,e)},l.SetWidth=function(t){this.width!==t&&(this.width=t,this.set_bbox_changed())},l.SetHeight=function(t){this.height!==t&&(this.height=t,this.set_bbox_changed())},l.SetSize=function(t,e){(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.set_bbox_changed())},u.Width=function(t){t.set_float(this.width)},u.Height=function(t){t.set_float(this.height)},u.BBoxLeft=function(t){this.update_bbox(),t.set_float(this.bbox.left)},u.BBoxTop=function(t){this.update_bbox(),t.set_float(this.bbox.top)},u.BBoxRight=function(t){this.update_bbox(),t.set_float(this.bbox.right)},u.BBoxBottom=function(t){this.update_bbox(),t.set_float(this.bbox.bottom)}),r&&(c.AngleWithin=function(t,e){return cr.angleDiff(this.angle,cr.to_radians(e))<=cr.to_radians(t)},c.IsClockwiseFrom=function(t){return cr.angleClockwise(this.angle,cr.to_radians(t))},c.IsBetweenAngles=function(t,e){var i=cr.to_clamped_radians(t),s=cr.to_clamped_radians(e),n=cr.clamp_angle(this.angle),r=!cr.angleClockwise(s,i);return r?!(!cr.angleClockwise(n,i)&&cr.angleClockwise(n,s)):cr.angleClockwise(n,i)&&!cr.angleClockwise(n,s)},l.SetAngle=function(t){var e=cr.to_radians(cr.clamp_angle_degrees(t));isNaN(e)||this.angle!==e&&(this.angle=e,this.set_bbox_changed())},l.RotateClockwise=function(t){0===t||isNaN(t)||(this.angle+=cr.to_radians(t),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},l.RotateCounterclockwise=function(t){0===t||isNaN(t)||(this.angle-=cr.to_radians(t),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},l.RotateTowardAngle=function(t,e){var i=cr.angleRotate(this.angle,cr.to_radians(e),cr.to_radians(t));isNaN(i)||this.angle!==i&&(this.angle=i,this.set_bbox_changed())},l.RotateTowardPosition=function(t,e,i){var s=e-this.x,n=i-this.y,r=Math.atan2(n,s),o=cr.angleRotate(this.angle,r,cr.to_radians(t));isNaN(o)||this.angle!==o&&(this.angle=o,this.set_bbox_changed())},l.SetTowardPosition=function(t,e){var i=t-this.x,s=e-this.y,n=Math.atan2(s,i);isNaN(n)||this.angle!==n&&(this.angle=n,this.set_bbox_changed())},u.Angle=function(t){t.set_float(cr.to_clamped_degrees(this.angle))}),i||(c.CompareInstanceVar=function(t,e,i){return cr.do_cmp(this.instance_vars[t],e,i)},c.IsBoolInstanceVarSet=function(t){return this.instance_vars[t]},c.PickInstVarHiLow=function(t,e){var i=this.getCurrentSol(),s=i.getObjects();if(!s.length)return!1;var n,r,o,a=s[0],h=a,c=a.instance_vars[e];for(n=1,r=s.length;r>n;n++)a=s[n],o=a.instance_vars[e],(0===t&&c>o||1===t&&o>c)&&(c=o,h=a);return i.pick_one(h),!0},c.PickByUID=function(t){var e,i,s,n,r,o,a,h=this.runtime.getCurrentCondition();if(h.inverted){if(a=this.getCurrentSol(),a.select_all){for(a.select_all=!1,a.instances.length=0,a.else_instances.length=0,o=this.instances,e=0,i=o.length;i>e;e++)n=o[e],n.uid===t?a.else_instances.push(n):a.instances.push(n);return this.applySolToContainer(),!!a.instances.length}for(e=0,s=0,i=a.instances.length;i>e;e++)n=a.instances[e],a.instances[s]=n,n.uid===t?a.else_instances.push(n):s++;return a.instances.length=s,this.applySolToContainer(),!!a.instances.length}if(n=this.runtime.getObjectByUID(t),!n)return!1;if(a=this.getCurrentSol(),!a.select_all&&-1===a.instances.indexOf(n))return!1;if(this.is_family){for(r=n.type.families,e=0,i=r.length;i>e;e++)if(r[e]===this)return a.pick_one(n),this.applySolToContainer(),!0}else if(n.type===this)return a.pick_one(n),this.applySolToContainer(),!0;return!1},c.OnCreated=function(){return!0},c.OnDestroyed=function(){return!0},l.SetInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])?i[t]=cr.is_number(e)?e:parseFloat(e):cr.is_string(i[t])&&(i[t]=cr.is_string(e)?e:e.toString())},l.AddInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])?i[t]+=cr.is_number(e)?e:parseFloat(e):cr.is_string(i[t])&&(i[t]+=cr.is_string(e)?e:e.toString())},l.SubInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])&&(i[t]-=cr.is_number(e)?e:parseFloat(e))},l.SetBoolInstanceVar=function(t,e){this.instance_vars[t]=e?1:0},l.ToggleBoolInstanceVar=function(t){this.instance_vars[t]=1-this.instance_vars[t]},l.Destroy=function(){this.runtime.DestroyInstance(this)},l.LoadFromJsonString||(l.LoadFromJsonString=function(t){var e,i,s,n;try{e=JSON.parse(t)}catch(r){return}if(this.runtime.loadInstanceFromJSON(this,e,!0),this.afterLoad&&this.afterLoad(),this.behavior_insts)for(i=0,s=this.behavior_insts.length;s>i;++i)n=this.behavior_insts[i],n.afterLoad&&n.afterLoad()}),u.Count=function(t){var e,i,s,n=t.object_class.instances.length;for(e=0,i=this.runtime.createRow.length;i>e;e++)s=this.runtime.createRow[e],t.object_class.is_family?s.type.families.indexOf(t.object_class)>=0&&n++:s.type===t.object_class&&n++;t.set_int(n)},u.PickedCount=function(t){t.set_int(t.object_class.getCurrentSol().getObjects().length)},u.UID=function(t){t.set_int(this.uid)},u.IID=function(t){t.set_int(this.get_iid())},u.AsJSON||(u.AsJSON=function(t){t.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))})),o&&(c.IsVisible=function(){return this.visible},l.SetVisible=function(t){!t!=!this.visible&&(this.visible=t,this.runtime.redraw=!0)},c.CompareOpacity=function(t,e){return cr.do_cmp(cr.round6dp(100*this.opacity),t,e)},l.SetOpacity=function(t){var e=t/100;0>e?e=0:e>1&&(e=1),e!==this.opacity&&(this.opacity=e,this.runtime.redraw=!0)},u.Opacity=function(t){t.set_float(cr.round6dp(100*this.opacity))}),a&&(c.IsOnLayer=function(t){return t?this.layer===t:!1},c.PickTopBottom=function(t){var e=this.getCurrentSol(),i=e.getObjects();if(!i.length)return!1;var s,n,r=i[0],o=r;for(s=1,n=i.length;n>s;s++)r=i[s],0===t?(r.layer.index>o.layer.index||r.layer.index===o.layer.index&&r.get_zindex()>o.get_zindex())&&(o=r):(r.layer.index<o.layer.index||r.layer.index===o.layer.index&&r.get_zindex()<o.get_zindex())&&(o=r);return e.pick_one(o),!0},l.MoveToTop=function(){var t=this.get_zindex();t!==this.layer.instances.length-1&&(cr.arrayRemove(this.layer.instances,t),this.layer.instances.push(this),this.runtime.redraw=!0,this.layer.zindices_stale=!0)},l.MoveToBottom=function(){var t=this.get_zindex();0!==t&&(cr.arrayRemove(this.layer.instances,t),this.layer.instances.unshift(this),this.runtime.redraw=!0,this.layer.zindices_stale=!0)},l.MoveToLayer=function(t){t&&t!=this.layer&&(cr.arrayRemove(this.layer.instances,this.get_zindex()),this.layer.zindices_stale=!0,this.layer=t,this.zindex=t.instances.length,t.instances.push(this),this.runtime.redraw=!0)},l.ZMoveToObject=function(t,e){var i=0===t;if(e){var s=e.getFirstPicked(this);if(s&&s.uid!==this.uid){this.layer.index!==s.layer.index&&(cr.arrayRemove(this.layer.instances,this.get_zindex()),this.layer.zindices_stale=!0,this.layer=s.layer,this.zindex=s.layer.instances.length,s.layer.instances.push(this));var n=this.get_zindex(),r=s.get_zindex();cr.arrayRemove(this.layer.instances,n),r>n&&r--,i&&r++,r===this.layer.instances.length?this.layer.instances.push(this):this.layer.instances.splice(r,0,this),this.layer.zindices_stale=!0,this.runtime.redraw=!0}}},u.LayerNumber=function(t){t.set_int(this.layer.number)},u.LayerName=function(t){t.set_string(this.layer.name)},u.ZIndex=function(t){t.set_int(this.get_zindex())}),h&&(l.SetEffectEnabled=function(t,e){if(this.runtime.glwrap){var i=this.type.getEffectIndexByName(e);if(!(0>i)){var s=1===t;this.active_effect_flags[i]!==s&&(this.active_effect_flags[i]=s,this.updateActiveEffects(),this.runtime.redraw=!0)}}},l.SetEffectParam=function(t,e,i){if(this.runtime.glwrap){var s=this.type.getEffectIndexByName(t);if(!(0>s)){var n=this.type.effect_types[s],r=this.effect_params[s];e=Math.floor(e),0>e||e>=r.length||(1===this.runtime.glwrap.getProgramParameterType(n.shaderindex,e)&&(i/=100),r[e]!==i&&(r[e]=i,n.active&&(this.runtime.redraw=!0)))}}})},cr.set_bbox_changed=function(){this.bbox_changed=!0,this.cell_changed=!0,this.type.any_cell_changed=!0,this.runtime.redraw=!0;var t,e,i=this.bbox_changed_callbacks;for(t=0,e=i.length;e>t;++t)i[t](this)},cr.add_bbox_changed_callback=function(t){t&&this.bbox_changed_callbacks.push(t)},cr.update_bbox=function(){if(this.bbox_changed){var t=this.bbox,e=this.bquad;t.set(this.x,this.y,this.x+this.width,this.y+this.height),t.offset(-this.hotspotX*this.width,-this.hotspotY*this.height),this.angle?(t.offset(-this.x,-this.y),e.set_from_rotated_rect(t,this.angle),e.offset(this.x,this.y),e.bounding_box(t)):e.set_from_rect(t),t.normalize(),this.bbox_changed=!1}};var t=new cr.rect(0,0,0,0);cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var e=this.type.collision_grid,i=this.collcells,s=this.bbox;t.set(e.XToCell(s.left),e.YToCell(s.top),e.XToCell(s.right),e.YToCell(s.bottom)),i.equals(t)||(i.right<i.left?e.update(this,null,t):e.update(this,i,t),i.copy(t),this.cell_changed=!1)}},cr.inst_contains_pt=function(t,e){return this.bbox.contains_pt(t,e)&&this.bquad.contains_pt(t,e)?this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(t-this.x,e-this.y)):!0:!1},cr.inst_get_iid=function(){return this.type.updateIIDs(),this.iid},cr.inst_get_zindex=function(){return this.layer.updateZIndices(),this.zindex},cr.inst_updateActiveEffects=function(){this.active_effect_types.length=0;var t,e;for(t=0,e=this.active_effect_flags.length;e>t;t++)this.active_effect_flags[t]&&this.active_effect_types.push(this.type.effect_types[t]);this.uses_shaders=!!this.active_effect_types.length},cr.inst_toString=function(){return"Inst"+this.puid},cr.type_getFirstPicked=function(t){if(t&&t.is_contained&&t.type!=this){var e,i,s;for(e=0,i=t.siblings.length;i>e;e++)if(s=t.siblings[e],s.type==this)return s}var n=this.getCurrentSol().getObjects();return n.length?n[0]:null},cr.type_getPairedInstance=function(t){var e=this.getCurrentSol().getObjects();return e.length?e[t.get_iid()%e.length]:null},cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var t,e;for(t=0,e=this.instances.length;e>t;t++)this.instances[t].iid=t;var i=t,s=this.runtime.createRow;for(t=0,e=s.length;e>t;++t)s[t].type===this&&(s[t].iid=i++);this.stale_iids=!1}},cr.type_getInstanceByIID=function(t){if(t<this.instances.length)return this.instances[t];t-=this.instances.length;var e,i,s=this.runtime.createRow;for(e=0,i=s.length;i>e;++e)if(s[e].type===this){if(0===t)return s[e];--t}return null},cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]},cr.type_pushCleanSol=function(){this.cur_sol++,this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):this.solstack[this.cur_sol].select_all=!0},cr.type_pushCopySol=function(){this.cur_sol++,this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var t=this.solstack[this.cur_sol],e=this.solstack[this.cur_sol-1];e.select_all?t.select_all=!0:(t.select_all=!1,cr.shallowAssignArray(t.instances,e.instances),cr.shallowAssignArray(t.else_instances,e.else_instances))},cr.type_popSol=function(){this.cur_sol--},cr.type_getBehaviorByName=function(t){var e,i,s,n,r,o=0;if(!this.is_family)for(e=0,i=this.families.length;i>e;e++)for(r=this.families[e],s=0,n=r.behaviors.length;n>s;s++){if(t===r.behaviors[s].name)return this.extra.lastBehIndex=o,r.behaviors[s];o++}for(e=0,i=this.behaviors.length;i>e;e++){if(t===this.behaviors[e].name)return this.extra.lastBehIndex=o,this.behaviors[e];o++}return null},cr.type_getBehaviorIndexByName=function(t){var e=this.getBehaviorByName(t);return e?this.extra.lastBehIndex:-1},cr.type_getEffectIndexByName=function(t){var e,i;for(e=0,i=this.effect_types.length;i>e;e++)if(this.effect_types[e].name===t)return e;return-1},cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var t,e,i,s,n,r,o;this.updateIIDs(),r=this.getCurrentSol();var a=r.select_all,h=this.runtime.getCurrentEventStack(),c=h&&h.current_event&&h.current_event.orblock;for(t=0,e=this.container.length;e>t;t++)if(n=this.container[t],n!==this&&(n.updateIIDs(),o=n.getCurrentSol(),o.select_all=a,!a)){for(o.instances.length=r.instances.length,i=0,s=r.instances.length;s>i;i++)o.instances[i]=n.getInstanceByIID(r.instances[i].iid);if(c)for(o.else_instances.length=r.else_instances.length,i=0,s=r.else_instances.length;s>i;i++)o.else_instances[i]=n.getInstanceByIID(r.else_instances[i].iid)}}},cr.type_toString=function(){return"Type"+this.sid},cr.do_cmp=function(t,e,i){if("undefined"==typeof t||"undefined"==typeof i)return!1;switch(e){case 0:return t===i;case 1:return t!==i;case 2:return i>t;case 3:return i>=t;case 4:return t>i;case 5:return t>=i;default:return!1}}}(),cr.shaders={},cr.plugins_.AJAX=function(t){this.runtime=t},function(){function t(){}function e(){}function i(){}var s=!1,n=null,r=null,o="",a=cr.plugins_.AJAX.prototype;a.Type=function(t){this.plugin=t,this.runtime=t.runtime};var h=a.Type.prototype;h.onCreate=function(){},a.Instance=function(t){this.type=t,this.runtime=t.runtime,this.lastData="",this.curTag="",this.progress=0,this.timeout=-1,s=this.runtime.isNodeWebkit,s&&(n=require("path"),r=require("fs"),o=n.dirname(process.execPath)+"\\")};var c=a.Instance.prototype,l=null;window.C2_AJAX_DCSide=function(t,e,i){l&&("success"===t?(l.curTag=e,l.lastData=i,l.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,l)):"error"===t?(l.curTag=e,l.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,l)):"progress"===t&&(l.progress=i,l.curTag=e,l.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,l)))},c.onCreate=function(){l=this},c.saveToJSON=function(){return{lastData:this.lastData}},c.loadFromJSON=function(t){this.lastData=t.lastData,this.curTag="",this.progress=0};var u={};c.doRequest=function(t,e,i,n){if(this.runtime.isDirectCanvas)return void AppMobi.webview.execute('C2_AJAX_WebSide("'+t+'", "'+e+'", "'+i+'", '+(n?'"'+n+'"':"null")+");");var a=this,h=null,c=function(){a.curTag=t,a.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,a)},l=function(){if(s){var t=o+e;r.existsSync(t)?r.readFile(t,{encoding:"utf8"},function(t,e){return t?void c():(a.lastData=e.replace(/\r\n/g,"\n"),void a.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,a))}):c()}else c()},p=function(e){e.lengthComputable&&(a.progress=e.loaded/e.total,a.curTag=t,a.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,a))};try{h=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,h.onreadystatechange=function(){4===h.readyState&&(a.curTag=t,a.lastData=h.responseText?h.responseText.replace(/\r\n/g,"\n"):"",h.status>=400?a.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,a):(!s||a.lastData.length)&&a.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,a))},this.runtime.isWindowsPhone8||(h.onerror=l,h.ontimeout=l,h.onabort=l,h.onprogress=p),h.open(i,e),this.runtime.isWindowsPhone8||this.timeout>=0&&"undefined"!=typeof h.timeout&&(h.timeout=this.timeout);try{h.responseType="text"}catch(d){}if(n&&h.setRequestHeader&&h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.setRequestHeader){var f;for(f in u)if(u.hasOwnProperty(f))try{h.setRequestHeader(f,u[f])}catch(d){}u={}}n?h.send(n):h.send()}catch(d){l()}},t.prototype.OnComplete=function(t){return cr.equals_nocase(t,this.curTag)},t.prototype.OnError=function(t){return cr.equals_nocase(t,this.curTag)},t.prototype.OnProgress=function(t){return cr.equals_nocase(t,this.curTag)},a.cnds=new t,e.prototype.Request=function(t,e){this.doRequest(t,e,"GET")},e.prototype.RequestFile=function(t,e){this.doRequest(t,e,"GET")},e.prototype.Post=function(t,e,i,s){this.doRequest(t,e,s,i)},e.prototype.SetTimeout=function(t){this.timeout=1e3*t},e.prototype.SetHeader=function(t,e){u[t]=e},a.acts=new e,i.prototype.LastData=function(t){t.set_string(this.lastData)},i.prototype.Progress=function(t){t.set_float(this.progress)},a.exps=new i}(),cr.plugins_.Audio=function(t){this.runtime=t},function(){function t(t){var e=i(t);return 0>e&&(e=0),e>1&&(e=1),e}function e(t){return 0>t&&(t=0),t>1&&(t=1),s(t)}function i(t){return Math.pow(10,t/20)}function s(t){return Math.log(t)/Math.log(10)*20
}function n(t){return t=t.toLowerCase(),le.hasOwnProperty(t)&&le[t].length?le[t][0].getInputNode():z.destination}function r(){return z.createGain?z.createGain():z.createGainNode()}function o(t){return z.createDelay?z.createDelay(t):z.createDelayNode(t)}function a(t){t.start?t.start(0):t.noteOn(0)}function h(t,e,i){t.start?t.start(0,e):t.noteGrainOn(0,e,i-e)}function c(t){try{t.stop?t.stop(0):t.noteOff(0)}catch(e){}}function l(t,e,i,s){if(t){if(t.cancelScheduledValues(0),0===s)return void(t.value=e);var n=z.currentTime;switch(s+=n,i){case 0:t.setValueAtTime(e,s);break;case 1:t.setValueAtTime(t.value,n),t.linearRampToValueAtTime(e,s);break;case 2:t.setValueAtTime(t.value,n),t.exponentialRampToValueAtTime(e,s)}}}function u(t,e,i,s,n,o){this.type="filter",this.params=[t,e,i,s,n,o],this.inputNode=r(),this.wetNode=r(),this.wetNode.gain.value=o,this.dryNode=r(),this.dryNode.gain.value=1-o,this.filterNode=z.createBiquadFilter(),this.filterNode.type="number"==typeof this.filterNode.type?t:ue[t],this.filterNode.frequency.value=e,this.filterNode.detune&&(this.filterNode.detune.value=i),this.filterNode.Q.value=s,this.filterNode.gain.value=n,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode)}function p(t,e,i){this.type="delay",this.params=[t,e,i],this.inputNode=r(),this.wetNode=r(),this.wetNode.gain.value=i,this.dryNode=r(),this.dryNode.gain.value=1-i,this.mainNode=r(),this.delayNode=o(t),this.delayNode.delayTime.value=t,this.delayGainNode=r(),this.delayGainNode.gain.value=e,this.inputNode.connect(this.mainNode),this.inputNode.connect(this.dryNode),this.mainNode.connect(this.wetNode),this.mainNode.connect(this.delayNode),this.delayNode.connect(this.delayGainNode),this.delayGainNode.connect(this.mainNode)}function d(t,e,i,s){this.type="convolve",this.params=[e,i,s],this.inputNode=r(),this.wetNode=r(),this.wetNode.gain.value=i,this.dryNode=r(),this.dryNode.gain.value=1-i,this.convolveNode=z.createConvolver(),t&&(this.convolveNode.normalize=e,this.convolveNode.buffer=t),this.inputNode.connect(this.convolveNode),this.inputNode.connect(this.dryNode),this.convolveNode.connect(this.wetNode)}function f(t,e,i,s,n){this.type="flanger",this.params=[t,e,i,s,n],this.inputNode=r(),this.dryNode=r(),this.dryNode.gain.value=1-n/2,this.wetNode=r(),this.wetNode.gain.value=n/2,this.feedbackNode=r(),this.feedbackNode.gain.value=s,this.delayNode=o(t+e),this.delayNode.delayTime.value=t,this.oscNode=z.createOscillator(),this.oscNode.frequency.value=i,this.oscGainNode=r(),this.oscGainNode.gain.value=e,this.inputNode.connect(this.delayNode),this.inputNode.connect(this.dryNode),this.delayNode.connect(this.wetNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.delayNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.delayNode.delayTime),a(this.oscNode)}function g(t,e,i,s,n,o){this.type="phaser",this.params=[t,e,i,s,n,o],this.inputNode=r(),this.dryNode=r(),this.dryNode.gain.value=1-o/2,this.wetNode=r(),this.wetNode.gain.value=o/2,this.filterNode=z.createBiquadFilter(),this.filterNode.type="number"==typeof this.filterNode.type?7:"allpass",this.filterNode.frequency.value=t,this.filterNode.detune&&(this.filterNode.detune.value=e),this.filterNode.Q.value=i,this.oscNode=z.createOscillator(),this.oscNode.frequency.value=n,this.oscGainNode=r(),this.oscGainNode.gain.value=s,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.filterNode.frequency),a(this.oscNode)}function m(t){this.type="gain",this.params=[t],this.node=r(),this.node.gain.value=t}function y(t,e){this.type="tremolo",this.params=[t,e],this.node=r(),this.node.gain.value=1-e/2,this.oscNode=z.createOscillator(),this.oscNode.frequency.value=t,this.oscGainNode=r(),this.oscGainNode.gain.value=e/2,this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.node.gain),a(this.oscNode)}function _(t,e){this.type="ringmod",this.params=[t,e],this.inputNode=r(),this.wetNode=r(),this.wetNode.gain.value=e,this.dryNode=r(),this.dryNode.gain.value=1-e,this.ringNode=r(),this.ringNode.gain.value=0,this.oscNode=z.createOscillator(),this.oscNode.frequency.value=t,this.oscNode.connect(this.ringNode.gain),a(this.oscNode),this.inputNode.connect(this.ringNode),this.inputNode.connect(this.dryNode),this.ringNode.connect(this.wetNode)}function v(t,e,s,n,o){this.type="distortion",this.params=[t,e,s,n,o],this.inputNode=r(),this.preGain=r(),this.postGain=r(),this.setDrive(s,i(n)),this.wetNode=r(),this.wetNode.gain.value=o,this.dryNode=r(),this.dryNode.gain.value=1-o,this.waveShaper=z.createWaveShaper(),this.curve=new Float32Array(65536),this.generateColortouchCurve(t,e),this.waveShaper.curve=this.curve,this.inputNode.connect(this.preGain),this.inputNode.connect(this.dryNode),this.preGain.connect(this.waveShaper),this.waveShaper.connect(this.postGain),this.postGain.connect(this.wetNode)}function b(t,e){return 1-Math.exp(-e*t)}function x(t,e,i,s,n){this.type="compressor",this.params=[t,e,i,s,n],this.node=z.createDynamicsCompressor();try{this.node.threshold.value=t,this.node.knee.value=e,this.node.ratio.value=i,this.node.attack.value=s,this.node.release.value=n}catch(r){}}function w(t,e){this.type="analyser",this.params=[t,e],this.node=z.createAnalyser(),this.node.fftSize=t,this.node.smoothingTimeConstant=e,this.freqBins=new Float32Array(this.node.frequencyBinCount),this.signal=new Uint8Array(t),this.peak=0,this.rms=0}function S(){this.obj=null,this.loadUid=0,this.speeds=[],this.lastX=0,this.lastY=0,this.moveAngle=0}function T(t,e){this.src=t,this.myapi=X,this.is_music=e,this.added_end_listener=!1;var i=this;this.outNode=null,this.mediaSourceNode=null,this.panWhenReady=[],this.seekWhenReady=0,this.pauseWhenReady=!1,this.supportWebAudioAPI=!1,this.failedToLoad=!1,this.wasEverReady=!1,X===G&&e&&(this.myapi=W,this.outNode=r()),this.bufferObject=null,this.audioData=null;var s;switch(this.myapi){case W:this.bufferObject=new Audio,this.bufferObject.addEventListener("canplaythrough",function(){i.wasEverReady=!0}),X!==G||!z.createMediaElementSource||L.isFirefox||/wiiu/i.test(navigator.userAgent)||(this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",function(){i.mediaSourceNode||(i.mediaSourceNode=z.createMediaElementSource(i.bufferObject),i.mediaSourceNode.connect(i.outNode))})),this.bufferObject.autoplay=!1,this.bufferObject.preload="auto",this.bufferObject.src=t;break;case G:s=new XMLHttpRequest,s.open("GET",t,!0),s.responseType="arraybuffer",s.onload=function(){i.audioData=s.response,i.decodeAudioBuffer()},s.onerror=function(){i.failedToLoad=!0},s.send();break;case V:this.bufferObject=!0;break;case U:this.bufferObject=!0}}function k(t,e){var i=this;this.tag=e,this.fresh=!0,this.stopped=!0,this.src=t.src,this.buffer=t,this.myapi=X,this.is_music=t.is_music,this.playbackRate=1,this.pgended=!0,this.resume_me=!1,this.is_paused=!1,this.resume_position=0,this.looping=!1,this.is_muted=!1,this.is_silent=!1,this.volume=1,this.isTimescaled=1===Q&&!this.is_music||2===Q,this.mutevol=1,this.startTime=this.isTimescaled?L.kahanTime.sum:L.wallTime.sum,this.gainNode=null,this.pannerNode=null,this.pannerEnabled=!1,this.objectTracker=null,this.panX=0,this.panY=0,this.panAngle=0,this.panConeInner=0,this.panConeOuter=0,this.panConeOuterGain=0,this.instanceObject=null;var s=!1;switch(this.myapi!==G||this.buffer.myapi!==W||this.buffer.supportWebAudioAPI||(this.myapi=W),this.myapi){case W:this.is_music?(this.instanceObject=t.bufferObject,s=!t.added_end_listener,t.added_end_listener=!0):(this.instanceObject=new Audio,this.instanceObject.autoplay=!1,this.instanceObject.src=t.bufferObject.src,s=!0),s&&this.instanceObject.addEventListener("ended",function(){F=i.tag,i.stopped=!0,L.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,D)});break;case G:this.gainNode=r(),this.gainNode.connect(n(e)),this.buffer.myapi===G?t.bufferObject&&(this.instanceObject=z.createBufferSource(),this.instanceObject.buffer=t.bufferObject,this.instanceObject.connect(this.gainNode)):(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode));break;case V:this.instanceObject=new window.Media(j+this.src,null,null,function(t){t===window.Media.MEDIA_STOPPED&&(i.pgended=!0,i.stopped=!0,F=i.tag,L.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,D))});break;case U:this.instanceObject=!0}}function C(t,e){var i=t.isPlaying()?1:0,s=e.isPlaying()?1:0;return i===s?0:s>i?1:-1}function O(t,e){if(ye.length=0,!t.length)return!Y||Y.hasEnded()?void 0:(ye.length=1,void(ye[0]=Y));var i,s,n;for(i=0,s=H.length;s>i;i++)n=H[i],cr.equals_nocase(t,n.tag)&&ye.push(n);e&&ye.sort(C)}function A(t){var e,i,s,n,r=z.destination;if(le.hasOwnProperty(t)&&(s=le[t],s.length))for(r=s[0].getInputNode(),e=0,i=s.length;i>e;e++)n=s[e],n.connectTo(e+1===i?z.destination:s[e+1].getInputNode());for(O(t),e=0,i=ye.length;i>e;e++)ye[e].reconnect(r);oe&&ae===t&&(oe.disconnect(),oe.connect(r))}function E(t,e){le.hasOwnProperty(t)?le[t].push(e):le[t]=[e],A(t)}function P(){}function B(){}function R(){}function I(t,e){var i=null;return le.hasOwnProperty(t)&&(i=le[t]),i&&e>=0&&e<i.length&&i[e].freqBins?i[e]:null}var N=cr.plugins_.Audio.prototype;N.Type=function(t){this.plugin=t,this.runtime=t.runtime};var M=N.Type.prototype;M.onCreate=function(){};var L=null,D=null,F="",j="",W=0,G=1,V=2,U=3,X=W,z=null,q=[],H=[],Y=null,J=!1,Q=0,Z=!1,K=1,$=0,te=0,ee=1,ie=1,se=10,ne=1e4,re=1,oe=null,ae="",he=!1,ce=[],le={},ue=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"];u.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},u.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},u.prototype.getInputNode=function(){return this.inputNode},u.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[5]=e,l(this.wetNode.gain,e,i,s),l(this.dryNode.gain,1-e,i,s);break;case 1:this.params[1]=e,l(this.filterNode.frequency,e,i,s);break;case 2:this.params[2]=e,l(this.filterNode.detune,e,i,s);break;case 3:this.params[3]=e,l(this.filterNode.Q,e,i,s);break;case 4:this.params[4]=e,l(this.filterNode.gain,e,i,s)}},p.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},p.prototype.remove=function(){this.inputNode.disconnect(),this.mainNode.disconnect(),this.delayNode.disconnect(),this.delayGainNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},p.prototype.getInputNode=function(){return this.inputNode},p.prototype.setParam=function(e,i,s,n){switch(e){case 0:i/=100,0>i&&(i=0),i>1&&(i=1),this.params[2]=i,l(this.wetNode.gain,i,s,n),l(this.dryNode.gain,1-i,s,n);break;case 4:this.params[1]=t(i),l(this.delayGainNode.gain,t(i),s,n);break;case 5:this.params[0]=i,l(this.delayNode.delayTime,i,s,n)}},d.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},d.prototype.remove=function(){this.inputNode.disconnect(),this.convolveNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},d.prototype.getInputNode=function(){return this.inputNode},d.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[1]=e,l(this.wetNode.gain,e,i,s),l(this.dryNode.gain,1-e,i,s)}},f.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},f.prototype.remove=function(){this.inputNode.disconnect(),this.delayNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect(),this.feedbackNode.disconnect()},f.prototype.getInputNode=function(){return this.inputNode},f.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[4]=e,l(this.wetNode.gain,e/2,i,s),l(this.dryNode.gain,1-e/2,i,s);break;case 6:this.params[1]=e/1e3,l(this.oscGainNode.gain,e/1e3,i,s);break;case 7:this.params[2]=e,l(this.oscNode.frequency,e,i,s);break;case 8:this.params[3]=e/100,l(this.feedbackNode.gain,e/100,i,s)}},g.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},g.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect()},g.prototype.getInputNode=function(){return this.inputNode},g.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[5]=e,l(this.wetNode.gain,e/2,i,s),l(this.dryNode.gain,1-e/2,i,s);break;case 1:this.params[0]=e,l(this.filterNode.frequency,e,i,s);break;case 2:this.params[1]=e,l(this.filterNode.detune,e,i,s);break;case 3:this.params[2]=e,l(this.filterNode.Q,e,i,s);break;case 6:this.params[3]=e,l(this.oscGainNode.gain,e,i,s);break;case 7:this.params[4]=e,l(this.oscNode.frequency,e,i,s)}},m.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},m.prototype.remove=function(){this.node.disconnect()},m.prototype.getInputNode=function(){return this.node},m.prototype.setParam=function(e,i,s,n){switch(e){case 4:this.params[0]=t(i),l(this.node.gain,t(i),s,n)}},y.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},y.prototype.remove=function(){this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.node.disconnect()},y.prototype.getInputNode=function(){return this.node},y.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[1]=e,l(this.node.gain.value,1-e/2,i,s),l(this.oscGainNode.gain.value,e/2,i,s);break;case 7:this.params[0]=e,l(this.oscNode.frequency,e,i,s)}},_.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},_.prototype.remove=function(){this.oscNode.disconnect(),this.ringNode.disconnect(),this.inputNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},_.prototype.getInputNode=function(){return this.inputNode},_.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[1]=e,l(this.wetNode.gain,e,i,s),l(this.dryNode.gain,1-e,i,s);break;case 7:this.params[0]=e,l(this.oscNode.frequency,e,i,s)}},v.prototype.setDrive=function(t,e){.01>t&&(t=.01),this.preGain.gain.value=t,this.postGain.gain.value=Math.pow(1/t,.6)*e},v.prototype.shape=function(t,e,i){var s=1.05*i*e,n=s-e,r=0>t?-1:1,o=0>t?-t:t,a=e>o?o:e+n*b(o-e,1/n);return a*=r},v.prototype.generateColortouchCurve=function(t,e){for(var s=i(t),n=i(e),r=65536,o=r/2,a=0,h=0;o>h;++h)a=h/o,a=this.shape(a,s,n),this.curve[o+h]=a,this.curve[o-h-1]=-a},v.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},v.prototype.remove=function(){this.inputNode.disconnect(),this.preGain.disconnect(),this.waveShaper.disconnect(),this.postGain.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},v.prototype.getInputNode=function(){return this.inputNode},v.prototype.setParam=function(t,e,i,s){switch(t){case 0:e/=100,0>e&&(e=0),e>1&&(e=1),this.params[4]=e,l(this.wetNode.gain,e,i,s),l(this.dryNode.gain,1-e,i,s)}},x.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},x.prototype.remove=function(){this.node.disconnect()},x.prototype.getInputNode=function(){return this.node},x.prototype.setParam=function(){},w.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins),this.node.getByteTimeDomainData(this.signal);var t=this.node.fftSize,i=0;this.peak=0;for(var s=0,n=0;t>i;i++)n=(this.signal[i]-128)/128,0>n&&(n=-n),this.peak<n&&(this.peak=n),s+=n*n;this.peak=e(this.peak),this.rms=e(Math.sqrt(s/t))},w.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},w.prototype.remove=function(){this.node.disconnect()},w.prototype.getInputNode=function(){return this.node},w.prototype.setParam=function(){};var pe=4;S.prototype.setObject=function(t){this.obj=t,this.obj&&(this.lastX=this.obj.x,this.lastY=this.obj.y),this.speeds.length=0},S.prototype.hasObject=function(){return!!this.obj},S.prototype.tick=function(t){if(this.obj&&0!==t){this.moveAngle=cr.angleTo(this.lastX,this.lastY,this.obj.x,this.obj.y);var e=cr.distanceTo(this.lastX,this.lastY,this.obj.x,this.obj.y)/t;this.speeds.length<pe?this.speeds.push(e):(this.speeds.shift(),this.speeds.push(e)),this.lastX=this.obj.x,this.lastY=this.obj.y}},S.prototype.getSpeed=function(){if(!this.speeds.length)return 0;var t,e,i=0;for(t=0,e=this.speeds.length;e>t;t++)i+=this.speeds[t];return i/this.speeds.length},S.prototype.getVelocityX=function(){return Math.cos(this.moveAngle)*this.getSpeed()},S.prototype.getVelocityY=function(){return Math.sin(this.moveAngle)*this.getSpeed()};var de=!1;T.prototype.decodeAudioBuffer=function(){if(!this.bufferObject&&this.audioData){var t=this;if(z.decodeAudioData)z.decodeAudioData(this.audioData,function(e){t.bufferObject=e,t.audioData=null;var i,s,n,r;if(cr.is_undefined(t.playTagWhenReady)||Z){if(!cr.is_undefined(t.convolveWhenReady)){var o=t.convolveWhenReady.convolveNode;o.normalize=t.normalizeWhenReady,o.buffer=e}}else if(t.panWhenReady.length){for(s=0,n=t.panWhenReady.length;n>s;s++)if(i=t.panWhenReady[s],r=new k(t,i.thistag),r.setPannerEnabled(!0),"undefined"==typeof i.objUid||(i.obj=L.getObjectByUID(i.objUid),i.obj)){if(i.obj){var a=cr.rotatePtAround(i.obj.x,i.obj.y,-i.obj.layer.getAngle(),$,te,!0),h=cr.rotatePtAround(i.obj.x,i.obj.y,-i.obj.layer.getAngle(),$,te,!1);r.setPan(a,h,cr.to_degrees(i.obj.angle-i.obj.layer.getAngle()),i.ia,i.oa,i.og),r.setObject(i.obj)}else r.setPan(i.x,i.y,i.a,i.ia,i.oa,i.og);r.play(t.loopWhenReady,t.volumeWhenReady,t.seekWhenReady),t.pauseWhenReady&&r.pause(),H.push(r)}t.panWhenReady.length=0}else r=new k(t,t.playTagWhenReady),r.play(t.loopWhenReady,t.volumeWhenReady,t.seekWhenReady),t.pauseWhenReady&&r.pause(),H.push(r)},function(){t.failedToLoad=!0});else if(this.bufferObject=z.createBuffer(this.audioData,!1),this.audioData=null,cr.is_undefined(this.playTagWhenReady)||Z){if(!cr.is_undefined(this.convolveWhenReady)){var e=this.convolveWhenReady.convolveNode;e.normalize=this.normalizeWhenReady,e.buffer=this.bufferObject}}else{var i=new k(this,this.playTagWhenReady);i.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady&&i.pause(),H.push(i)}}},T.prototype.isLoaded=function(){switch(this.myapi){case W:var t=this.bufferObject.readyState>=4;return t&&(this.wasEverReady=!0),t||this.wasEverReady;case G:return!!this.audioData||!!this.bufferObject;case V:return!0;case U:return!0}return!1},T.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case W:return this.isLoaded();case G:return!!this.bufferObject;case V:return!0;case U:return!0}return!1},T.prototype.hasFailedToLoad=function(){switch(this.myapi){case W:return!!this.bufferObject.error;case G:return this.failedToLoad}return!1},k.prototype.hasEnded=function(){var t;switch(this.myapi){case W:return this.instanceObject.ended;case G:return this.buffer.myapi===G?this.fresh||this.stopped||!this.instanceObject.loop?this.is_paused?!1:(t=this.isTimescaled?L.kahanTime.sum:L.wallTime.sum,t-this.startTime>this.buffer.bufferObject.duration):!1:this.instanceObject.ended;case V:return this.pgended;case U:}return!0},k.prototype.canBeRecycled=function(){return this.fresh||this.stopped?!0:this.hasEnded()},k.prototype.setPannerEnabled=function(t){if(X===G)if(!this.pannerEnabled&&t){if(!this.gainNode)return;this.pannerNode||(this.pannerNode=z.createPanner(),this.pannerNode.panningModel="number"==typeof this.pannerNode.panningModel?ee:["equalpower","HRTF","soundfield"][ee],this.pannerNode.distanceModel="number"==typeof this.pannerNode.distanceModel?ie:["linear","inverse","exponential"][ie],this.pannerNode.refDistance=se,this.pannerNode.maxDistance=ne,this.pannerNode.rolloffFactor=re),this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(n(this.tag)),this.pannerEnabled=!0}else if(this.pannerEnabled&&!t){if(!this.gainNode)return;this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(n(this.tag)),this.pannerEnabled=!1}},k.prototype.setPan=function(t,e,i,s,n,r){this.pannerEnabled&&X===G&&(this.pannerNode.setPosition(t,e,0),this.pannerNode.setOrientation(Math.cos(cr.to_radians(i)),Math.sin(cr.to_radians(i)),0),this.pannerNode.coneInnerAngle=s,this.pannerNode.coneOuterAngle=n,this.pannerNode.coneOuterGain=r,this.panX=t,this.panY=e,this.panAngle=i,this.panConeInner=s,this.panConeOuter=n,this.panConeOuterGain=r)},k.prototype.setObject=function(t){this.pannerEnabled&&X===G&&(this.objectTracker||(this.objectTracker=new S),this.objectTracker.setObject(t))},k.prototype.tick=function(t){if(this.pannerEnabled&&X===G&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(t);var e=this.objectTracker.obj,i=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),$,te,!0),s=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),$,te,!1);this.pannerNode.setPosition(i,s,0);var n=0;"undefined"!=typeof this.objectTracker.obj.angle&&(n=e.angle-e.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(n),Math.sin(n),0)),i=cr.rotatePtAround(this.objectTracker.getVelocityX(),this.objectTracker.getVelocityY(),-e.layer.getAngle(),0,0,!0),s=cr.rotatePtAround(this.objectTracker.getVelocityX(),this.objectTracker.getVelocityY(),-e.layer.getAngle(),0,0,!1),this.pannerNode.setVelocity(i,s,0)}},k.prototype.play=function(t,e,i){var s=this.instanceObject;this.looping=t,this.volume=e;var n=i||0;switch(this.myapi){case W:if(1!==s.playbackRate&&(s.playbackRate=1),s.volume!==e*K&&(s.volume=e*K),s.loop!==t&&(s.loop=t),s.muted&&(s.muted=!1),s.currentTime!==n)try{s.currentTime=n}catch(r){}if(this.is_music&&he&&!L.isInUserInputEvent)ce.push(this);else try{this.instanceObject.play()}catch(o){console&&console.log&&console.log("[C2] WARNING: exception trying to play audio '"+this.buffer.src+"': ",o)}break;case G:if(this.muted=!1,this.mutevol=1,this.buffer.myapi===G)this.fresh||(this.instanceObject=z.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode)),this.instanceObject.loop=t,this.gainNode.gain.value=e*K,0===n?a(this.instanceObject):h(this.instanceObject,n,this.getDuration());else{if(1!==s.playbackRate&&(s.playbackRate=1),s.loop!==t&&(s.loop=t),this.gainNode.gain.value=e*K,s.currentTime!==n)try{s.currentTime=n}catch(r){}this.is_music&&he&&!L.isInUserInputEvent?ce.push(this):s.play()}break;case V:(!this.fresh&&this.stopped||0!==n)&&s.seekTo(n),s.play(),this.pgended=!1;break;case U:L.isDirectCanvas?AppMobi.context.playSound(this.src,t):AppMobi.player.playSound(this.src,t)}this.playbackRate=1,this.startTime=(this.isTimescaled?L.kahanTime.sum:L.wallTime.sum)-n,this.fresh=!1,this.stopped=!1,this.is_paused=!1},k.prototype.stop=function(){switch(this.myapi){case W:this.instanceObject.paused||this.instanceObject.pause();break;case G:this.buffer.myapi===G?c(this.instanceObject):this.instanceObject.paused||this.instanceObject.pause();break;case V:this.instanceObject.stop();break;case U:L.isDirectCanvas&&AppMobi.context.stopSound(this.src)}this.stopped=!0,this.is_paused=!1},k.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){switch(this.myapi){case W:this.instanceObject.paused||this.instanceObject.pause();break;case G:this.buffer.myapi===G?(this.resume_position=this.getPlaybackTime(),this.looping&&(this.resume_position=this.resume_position%this.getDuration()),c(this.instanceObject)):this.instanceObject.paused||this.instanceObject.pause();break;case V:this.instanceObject.pause();break;case U:L.isDirectCanvas&&AppMobi.context.stopSound(this.src)}this.is_paused=!0}},k.prototype.resume=function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){switch(this.myapi){case W:this.instanceObject.play();break;case G:this.buffer.myapi===G?(this.instanceObject=z.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.loop=this.looping,this.gainNode.gain.value=K*this.volume*this.mutevol,this.startTime=(this.isTimescaled?L.kahanTime.sum:L.wallTime.sum)-this.resume_position,h(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play();break;case V:this.instanceObject.play();break;case U:L.isDirectCanvas&&AppMobi.context.resumeSound(this.src)}this.is_paused=!1}},k.prototype.seek=function(t){if(!(this.fresh||this.stopped||this.hasEnded()))switch(this.myapi){case W:try{this.instanceObject.currentTime=t}catch(e){}break;case G:if(this.buffer.myapi===G)this.is_paused?this.resume_position=t:(this.pause(),this.resume_position=t,this.resume());else try{this.instanceObject.currentTime=t}catch(e){}break;case V:break;case U:L.isDirectCanvas&&AppMobi.context.seekSound(this.src,t)}},k.prototype.reconnect=function(t){this.myapi===G&&(this.pannerEnabled?(this.pannerNode.disconnect(),this.pannerNode.connect(t)):(this.gainNode.disconnect(),this.gainNode.connect(t)))},k.prototype.getDuration=function(){switch(this.myapi){case W:return"undefined"!=typeof this.instanceObject.duration?this.instanceObject.duration:0;case G:return this.buffer.bufferObject.duration;case V:return this.instanceObject.getDuration();case U:return L.isDirectCanvas?AppMobi.context.getDurationSound(this.src):0}return 0},k.prototype.getPlaybackTime=function(){var t=this.getDuration(),e=0;switch(this.myapi){case W:"undefined"!=typeof this.instanceObject.currentTime&&(e=this.instanceObject.currentTime);break;case G:if(this.buffer.myapi===G){if(this.is_paused)return this.resume_position;e=(this.isTimescaled?L.kahanTime.sum:L.wallTime.sum)-this.startTime}else"undefined"!=typeof this.instanceObject.currentTime&&(e=this.instanceObject.currentTime);break;case V:break;case U:L.isDirectCanvas&&(e=AppMobi.context.getPlaybackTimeSound(this.src))}return!this.looping&&e>t&&(e=t),e},k.prototype.isPlaying=function(){return!(this.is_paused||this.fresh||this.stopped||this.hasEnded())},k.prototype.setVolume=function(t){this.volume=t,this.updateVolume()},k.prototype.updateVolume=function(){var t=this.volume*K;switch(this.myapi){case W:this.instanceObject.volume&&this.instanceObject.volume!==t&&(this.instanceObject.volume=t);break;case G:this.gainNode.gain.value=t*this.mutevol;break;case V:break;case U:}},k.prototype.getVolume=function(){return this.volume},k.prototype.doSetMuted=function(t){switch(this.myapi){case W:this.instanceObject.muted!==!!t&&(this.instanceObject.muted=!!t);break;case G:this.mutevol=t?0:1,this.gainNode.gain.value=K*this.volume*this.mutevol;break;case V:break;case U:}},k.prototype.setMuted=function(t){this.is_muted=!!t,this.doSetMuted(this.is_muted||this.is_silent)},k.prototype.setSilent=function(t){this.is_silent=!!t,this.doSetMuted(this.is_muted||this.is_silent)},k.prototype.setLooping=function(t){switch(this.looping=t,this.myapi){case W:this.instanceObject.loop!==!!t&&(this.instanceObject.loop=!!t);break;case G:this.instanceObject.loop!==!!t&&(this.instanceObject.loop=!!t);break;case V:break;case U:L.isDirectCanvas&&AppMobi.context.setLoopingSound(this.src,t)}},k.prototype.setPlaybackRate=function(t){this.playbackRate=t,this.updatePlaybackRate()},k.prototype.updatePlaybackRate=function(){var t=this.playbackRate;switch(this.isTimescaled&&(t*=L.timescale),this.myapi){case W:this.instanceObject.playbackRate!==t&&(this.instanceObject.playbackRate=t);break;case G:this.buffer.myapi===G?this.instanceObject.playbackRate.value!==t&&(this.instanceObject.playbackRate.value=t):this.instanceObject.playbackRate!==t&&(this.instanceObject.playbackRate=t);break;case V:break;case U:}},k.prototype.setSuspended=function(t){switch(this.myapi){case W:t?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&this.instanceObject.play();break;case G:t?this.isPlaying()?(this.buffer.myapi===G?(this.resume_position=this.getPlaybackTime(),this.looping&&(this.resume_position=this.resume_position%this.getDuration()),c(this.instanceObject)):this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&(this.buffer.myapi===G?(this.instanceObject=z.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.loop=this.looping,this.gainNode.gain.value=K*this.volume*this.mutevol,this.startTime=(this.isTimescaled?L.kahanTime.sum:L.wallTime.sum)-this.resume_position,h(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play());break;case V:t?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&this.instanceObject.play();break;case U:}},N.Instance=function(t){if(this.type=t,this.runtime=t.runtime,L=this.runtime,D=this,this.listenerTracker=null,this.listenerZ=-600,!(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))||this.runtime.isCrosswalk||this.runtime.isDomFree||(he=!0),z=null,"undefined"!=typeof AudioContext?(X=G,z=new AudioContext):"undefined"!=typeof webkitAudioContext&&(X=G,z=new webkitAudioContext),(this.runtime.isiOS&&X===G||he)&&document.addEventListener("touchstart",function(){var t,e,i;if(!de&&z){var s=z.createBuffer(1,1,22050),n=z.createBufferSource();n.buffer=s,n.connect(z.destination),a(n),de=!0}if(he){if(!Z)for(t=0,e=ce.length;e>t;++t)i=ce[t],i.stopped||i.is_paused||i.instanceObject.play();ce.length=0}},!0),X!==G&&(this.runtime.isPhoneGap&&"undefined"!=typeof window.Media?X=V:this.runtime.isAppMobi&&(X=U)),X===V){j=location.href;var e=j.lastIndexOf("/");e>-1&&(j=j.substr(0,e+1)),j=j.replace("file://","")}if(this.runtime.isSafari&&this.runtime.isWindows&&"undefined"==typeof Audio)alert("It looks like you're using Safari for Windows without Quicktime.  Audio cannot be played until Quicktime is installed."),this.runtime.DestroyInstance(this);else{if(this.runtime.isDirectCanvas)J=this.runtime.isAndroid;else try{J=!!(new Audio).canPlayType('audio/ogg; codecs="vorbis"')}catch(i){J=!1}switch(X){case W:break;case G:break;case V:break;case U:}this.runtime.tickMe(this)}};var fe=N.Instance.prototype;fe.onCreate=function(){this.runtime.audioInstance=this,Q=this.properties[0],this.saveload=this.properties[1],this.playinbackground=0!==this.properties[2],ee=this.properties[3],ie=this.properties[4],this.listenerZ=-this.properties[5],se=this.properties[6],ne=this.properties[7],re=this.properties[8],this.listenerTracker=new S,X===G&&(z.listener.speedOfSound=this.properties[9],z.listener.dopplerFactor=this.properties[10],z.listener.setPosition(this.runtime.draw_width/2,this.runtime.draw_height/2,this.listenerZ),z.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=function(t,e){oe&&oe.disconnect(),ae=e.toLowerCase(),oe=z.createMediaStreamSource(t),oe.connect(n(ae))}),this.runtime.addSuspendCallback(function(t){D.onSuspend(t)});var t=this;this.runtime.addDestroyCallback(function(e){t.onInstanceDestroyed(e)})},fe.onInstanceDestroyed=function(t){var e,i,s;for(e=0,i=H.length;i>e;e++)s=H[e],s.objectTracker&&s.objectTracker.obj===t&&(s.objectTracker.obj=null,s.pannerEnabled&&s.isPlaying()&&s.looping&&s.stop());this.listenerTracker.obj===t&&(this.listenerTracker.obj=null)},fe.saveToJSON=function(){var t,e,i,s,n,r,o,a={silent:Z,masterVolume:K,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},h=a.playing;for(t=0,e=H.length;e>t;t++)i=H[t],i.isPlaying()&&3!==this.saveload&&(i.is_music&&1===this.saveload||(i.is_music||2!==this.saveload)&&(o=i.getPlaybackTime(),i.looping&&(o%=i.getDuration()),s={tag:i.tag,buffersrc:i.buffer.src,is_music:i.is_music,playbackTime:o,volume:i.volume,looping:i.looping,muted:i.is_muted,playbackRate:i.playbackRate,paused:i.is_paused,resume_position:i.resume_position},i.pannerEnabled&&(s.pan={},r=s.pan,i.objectTracker&&i.objectTracker.hasObject()?r.objUid=i.objectTracker.obj.uid:(r.x=i.panX,r.y=i.panY,r.a=i.panAngle),r.ia=i.panConeInner,r.oa=i.panConeOuter,r.og=i.panConeOuterGain),h.push(s)));
var c,l=a.effects;for(n in le)if(le.hasOwnProperty(n)){for(c=[],t=0,e=le[n].length;e>t;t++)c.push({type:le[n][t].type,params:le[n][t].params});l[n]=c}return a};var ge=[];fe.loadFromJSON=function(t){var e=t.silent;K=t.masterVolume,this.listenerZ=t.listenerZ,this.listenerTracker.setObject(null);var i=t.listenerUid;-1!==i&&(this.listenerTracker.loadUid=i,ge.push(this.listenerTracker));var s,n,r,o,a,h,c,l,b,T,k,C,O,A,P=t.playing;if(3!==this.saveload)for(s=0,n=H.length;n>s;s++)k=H[s],k.is_music&&1===this.saveload||(k.is_music||2!==this.saveload)&&k.stop();var B,R,I,N;for(C in le)if(le.hasOwnProperty(C))for(s=0,n=le[C].length;n>s;s++)le[C][s].remove();cr.wipe(le);for(C in t.effects)if(t.effects.hasOwnProperty(C))for(B=t.effects[C],s=0,n=B.length;n>s;s++)switch(R=B[s].type,I=B[s].params,R){case"filter":E(C,new u(I[0],I[1],I[2],I[3],I[4],I[5]));break;case"delay":E(C,new p(I[0],I[1],I[2]));break;case"convolve":o=I[2],T=this.getAudioBuffer(o,!1),T.bufferObject?N=new d(T.bufferObject,I[0],I[1],o):(N=new d(null,I[0],I[1],o),T.normalizeWhenReady=I[0],T.convolveWhenReady=N),E(C,N);break;case"flanger":E(C,new f(I[0],I[1],I[2],I[3],I[4]));break;case"phaser":E(C,new g(I[0],I[1],I[2],I[3],I[4],I[5]));break;case"gain":E(C,new m(I[0]));break;case"tremolo":E(C,new y(I[0],I[1]));break;case"ringmod":E(C,new _(I[0],I[1]));break;case"distortion":E(C,new v(I[0],I[1],I[2],I[3],I[4]));break;case"compressor":E(C,new x(I[0],I[1],I[2],I[3],I[4]));break;case"analyser":E(C,new w(I[0],I[1]))}for(s=0,n=P.length;n>s;s++)3!==this.saveload&&(r=P[s],o=r.buffersrc,a=r.is_music,h=r.tag,c=r.playbackTime,l=r.looping,b=r.volume,O=r.pan,A=O&&O.hasOwnProperty("objUid")?O.objUid:-1,a&&1===this.saveload||(a||2!==this.saveload)&&(k=this.getAudioInstance(o,h,a,l,b),k?(k.resume_position=r.resume_position,k.setPannerEnabled(!!O),k.play(l,b,c),k.updatePlaybackRate(),k.updateVolume(),k.doSetMuted(k.is_muted||k.is_silent),r.paused&&k.pause(),r.muted&&k.setMuted(!0),k.doSetMuted(k.is_muted||k.is_silent),O&&(-1!==A?(k.objectTracker=k.objectTracker||new S,k.objectTracker.loadUid=A,ge.push(k.objectTracker)):k.setPan(O.x,O.y,O.a,O.ia,O.oa,O.og))):(T=this.getAudioBuffer(o,a),T.seekWhenReady=c,T.pauseWhenReady=r.paused,O&&T.panWhenReady.push(-1!==A?{objUid:A,ia:O.ia,oa:O.oa,og:O.og,thistag:h}:{x:O.x,y:O.y,a:O.a,ia:O.ia,oa:O.oa,og:O.og,thistag:h}))));if(e&&!Z){for(s=0,n=H.length;n>s;s++)H[s].setSilent(!0);Z=!0}else if(!e&&Z){for(s=0,n=H.length;n>s;s++)H[s].setSilent(!1);Z=!1}},fe.afterLoad=function(){var t,e,i,s;for(t=0,e=ge.length;e>t;t++)i=ge[t],s=this.runtime.getObjectByUID(i.loadUid),i.setObject(s),i.loadUid=-1,s&&($=s.x,te=s.y);ge.length=0},fe.onSuspend=function(t){if(!this.playinbackground){var e,i;for(e=0,i=H.length;i>e;e++)H[e].setSuspended(t)}},fe.tick=function(){var t,e,i,s=this.runtime.dt;for(t=0,e=H.length;e>t;t++)i=H[t],i.tick(s),i.myapi!==W&&i.myapi!==U&&(i.fresh||i.stopped||!i.hasEnded()||(i.stopped=!0,F=i.tag,L.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,D))),0!==Q&&i.updatePlaybackRate();var n,r,o;for(n in le)if(le.hasOwnProperty(n))for(r=le[n],t=0,e=r.length;e>t;t++)o=r[t],o.tick&&o.tick();X===G&&this.listenerTracker.hasObject()&&(this.listenerTracker.tick(s),$=this.listenerTracker.obj.x,te=this.listenerTracker.obj.y,z.listener.setPosition(this.listenerTracker.obj.x,this.listenerTracker.obj.y,this.listenerZ),z.listener.setVelocity(this.listenerTracker.getVelocityX(),this.listenerTracker.getVelocityY(),0))};var me=[];fe.setPreloadList=function(t){var e,i,s,n,r,o,a=0;for(e=0,i=t.length;i>e;++e)s=t[e],n=s[0],r=2*s[1],o=n.length>4&&".ogg"===n.substr(n.length-4),(o&&J||!o&&!J)&&(me.push({filename:n,size:r,obj:null}),a+=r);return a},fe.startPreloads=function(){var t,e,i,s;for(t=0,e=me.length;e>t;++t)i=me[t],s=this.runtime.files_subfolder+i.filename,i.obj=this.getAudioBuffer(s,!1)},fe.getPreloadedSize=function(){var t,e,i,s=0;for(t=0,e=me.length;e>t;++t)i=me[t],i.obj.isLoadedAndDecoded()||i.obj.hasFailedToLoad()||this.runtime.isDomFree||this.runtime.isAndroidStockBrowser?s+=i.size:i.obj.isLoaded()&&(s+=Math.floor(i.size/2));return s},fe.getAudioBuffer=function(t,e){var i,s,n,r=null;for(i=0,s=q.length;s>i;i++)if(n=q[i],n.src===t){r=n;break}return r||(r=new T(t,e),q.push(r)),r},fe.getAudioInstance=function(t,e,i,s,n){var r,o,a;for(r=0,o=H.length;o>r;r++)if(a=H[r],a.src===t&&(a.canBeRecycled()||i))return a.tag=e,a;var h=this.getAudioBuffer(t,i);return h.bufferObject?(a=new k(h,e),H.push(a),a):("<preload>"!==e&&(h.playTagWhenReady=e,h.loopWhenReady=s,h.volumeWhenReady=n),null)};var ye=[];P.prototype.OnEnded=function(t){return cr.equals_nocase(F,t)},P.prototype.PreloadsComplete=function(){var t,e;for(t=0,e=q.length;e>t;t++)if(!q[t].isLoadedAndDecoded()&&!q[t].hasFailedToLoad())return!1;return!0},P.prototype.AdvancedAudioSupported=function(){return X===G},P.prototype.IsSilent=function(){return Z},P.prototype.IsAnyPlaying=function(){var t,e;for(t=0,e=H.length;e>t;t++)if(H[t].isPlaying())return!0;return!1},P.prototype.IsTagPlaying=function(t){O(t);var e,i;for(e=0,i=ye.length;i>e;e++)if(ye[e].isPlaying())return!0;return!1},N.cnds=new P,B.prototype.Play=function(e,i,s,n){if(!Z){var r=t(s),o=e[1],a=this.runtime.files_subfolder+e[0]+(J?".ogg":".m4a");Y=this.getAudioInstance(a,n,o,0!==i,r),Y&&(Y.setPannerEnabled(!1),Y.play(0!==i,r))}},B.prototype.PlayAtPosition=function(e,i,s,n,r,o,a,h,c,l){if(!Z){var u=t(s),p=e[1],d=this.runtime.files_subfolder+e[0]+(J?".ogg":".m4a");if(Y=this.getAudioInstance(d,l,p,0!==i,u),!Y){var f=this.getAudioBuffer(d,p);return void f.panWhenReady.push({x:n,y:r,a:o,ia:a,oa:h,og:t(c),thistag:l})}Y.setPannerEnabled(!0),Y.setPan(n,r,o,a,h,t(c)),Y.play(0!==i,u)}},B.prototype.PlayAtObject=function(e,i,s,n,r,o,a,h){if(!Z&&n){var c=n.getFirstPicked();if(c){var l=t(s),u=e[1],p=this.runtime.files_subfolder+e[0]+(J?".ogg":".m4a");if(Y=this.getAudioInstance(p,h,u,0!==i,l),!Y){var d=this.getAudioBuffer(p,u);return void d.panWhenReady.push({obj:c,ia:r,oa:o,og:t(a),thistag:h})}Y.setPannerEnabled(!0);var f=cr.rotatePtAround(c.x,c.y,-c.layer.getAngle(),$,te,!0),g=cr.rotatePtAround(c.x,c.y,-c.layer.getAngle(),$,te,!1);Y.setPan(f,g,cr.to_degrees(c.angle-c.layer.getAngle()),r,o,t(a)),Y.setObject(c),Y.play(0!==i,l)}}},B.prototype.PlayByName=function(e,i,s,n,r){if(!Z){var o=t(n),a=1===e,h=this.runtime.files_subfolder+i.toLowerCase()+(J?".ogg":".m4a");Y=this.getAudioInstance(h,r,a,0!==s,o),Y&&(Y.setPannerEnabled(!1),Y.play(0!==s,o))}},B.prototype.PlayAtPositionByName=function(e,i,s,n,r,o,a,h,c,l,u){if(!Z){var p=t(n),d=1===e,f=this.runtime.files_subfolder+i.toLowerCase()+(J?".ogg":".m4a");if(Y=this.getAudioInstance(f,u,d,0!==s,p),!Y){var g=this.getAudioBuffer(f,d);return void g.panWhenReady.push({x:r,y:o,a:a,ia:h,oa:c,og:t(l),thistag:u})}Y.setPannerEnabled(!0),Y.setPan(r,o,a,h,c,t(l)),Y.play(0!==s,p)}},B.prototype.PlayAtObjectByName=function(e,i,s,n,r,o,a,h,c){if(!Z&&r){var l=r.getFirstPicked();if(l){var u=t(n),p=1===e,d=this.runtime.files_subfolder+i.toLowerCase()+(J?".ogg":".m4a");if(Y=this.getAudioInstance(d,c,p,0!==s,u),!Y){var f=this.getAudioBuffer(d,p);return void f.panWhenReady.push({obj:l,ia:o,oa:a,og:t(h),thistag:c})}Y.setPannerEnabled(!0);var g=cr.rotatePtAround(l.x,l.y,-l.layer.getAngle(),$,te,!0),m=cr.rotatePtAround(l.x,l.y,-l.layer.getAngle(),$,te,!1);Y.setPan(g,m,cr.to_degrees(l.angle-l.layer.getAngle()),o,a,t(h)),Y.setObject(l),Y.play(0!==s,u)}}},B.prototype.SetLooping=function(t,e){O(t);var i,s;for(i=0,s=ye.length;s>i;i++)ye[i].setLooping(0===e)},B.prototype.SetMuted=function(t,e){O(t);var i,s;for(i=0,s=ye.length;s>i;i++)ye[i].setMuted(0===e)},B.prototype.SetVolume=function(e,i){O(e);var s,n,r=t(i);for(s=0,n=ye.length;n>s;s++)ye[s].setVolume(r)},B.prototype.Preload=function(t){if(!Z){var e=t[1],i=this.runtime.files_subfolder+t[0]+(J?".ogg":".m4a");return X===U?void(this.runtime.isDirectCanvas?AppMobi.context.loadSound(i):AppMobi.player.loadSound(i)):void(X!==V&&this.getAudioInstance(i,"<preload>",e,!1))}},B.prototype.PreloadByName=function(t,e){if(!Z){var i=1===t,s=this.runtime.files_subfolder+e.toLowerCase()+(J?".ogg":".m4a");return X===U?void(this.runtime.isDirectCanvas?AppMobi.context.loadSound(s):AppMobi.player.loadSound(s)):void(X!==V&&this.getAudioInstance(s,"<preload>",i,!1))}},B.prototype.SetPlaybackRate=function(t,e){O(t),0>e&&(e=0);var i,s;for(i=0,s=ye.length;s>i;i++)ye[i].setPlaybackRate(e)},B.prototype.Stop=function(t){O(t);var e,i;for(e=0,i=ye.length;i>e;e++)ye[e].stop()},B.prototype.StopAll=function(){var t,e;for(t=0,e=H.length;e>t;t++)H[t].stop()},B.prototype.SetPaused=function(t,e){O(t);var i,s;for(i=0,s=ye.length;s>i;i++)0===e?ye[i].pause():ye[i].resume()},B.prototype.Seek=function(t,e){O(t);var i,s;for(i=0,s=ye.length;s>i;i++)ye[i].seek(e)},B.prototype.SetSilent=function(t){var e,i;if(2===t&&(t=Z?1:0),0!==t||Z){if(1===t&&Z){for(e=0,i=H.length;i>e;e++)H[e].setSilent(!1);Z=!1}}else{for(e=0,i=H.length;i>e;e++)H[e].setSilent(!0);Z=!0}},B.prototype.SetMasterVolume=function(e){K=t(e);var i,s;for(i=0,s=H.length;s>i;i++)H[i].updateVolume()},B.prototype.AddFilterEffect=function(t,e,i,s,n,r,o){X!==G||0>e||e>=ue.length||!z.createBiquadFilter||(t=t.toLowerCase(),o/=100,0>o&&(o=0),o>1&&(o=1),E(t,new u(e,i,s,n,r,o)))},B.prototype.AddDelayEffect=function(e,i,s,n){X===G&&(e=e.toLowerCase(),n/=100,0>n&&(n=0),n>1&&(n=1),E(e,new p(i,t(s),n)))},B.prototype.AddFlangerEffect=function(t,e,i,s,n,r){X===G&&z.createOscillator&&(t=t.toLowerCase(),r/=100,0>r&&(r=0),r>1&&(r=1),E(t,new f(e/1e3,i/1e3,s,n/100,r)))},B.prototype.AddPhaserEffect=function(t,e,i,s,n,r,o){X===G&&z.createOscillator&&(t=t.toLowerCase(),o/=100,0>o&&(o=0),o>1&&(o=1),E(t,new g(e,i,s,n,r,o)))},B.prototype.AddConvolutionEffect=function(t,e,i,s){if(X===G&&z.createConvolver){var n=0===i,r=this.runtime.files_subfolder+e[0]+(J?".ogg":".m4a"),o=this.getAudioBuffer(r,!1);t=t.toLowerCase(),s/=100,0>s&&(s=0),s>1&&(s=1);var a;o.bufferObject?a=new d(o.bufferObject,n,s,r):(a=new d(null,n,s,r),o.normalizeWhenReady=n,o.convolveWhenReady=a),E(t,a)}},B.prototype.AddGainEffect=function(e,i){X===G&&(e=e.toLowerCase(),E(e,new m(t(i))))},B.prototype.AddMuteEffect=function(t){X===G&&(t=t.toLowerCase(),E(t,new m(0)))},B.prototype.AddTremoloEffect=function(t,e,i){X===G&&z.createOscillator&&(t=t.toLowerCase(),i/=100,0>i&&(i=0),i>1&&(i=1),E(t,new y(e,i)))},B.prototype.AddRingModEffect=function(t,e,i){X===G&&z.createOscillator&&(t=t.toLowerCase(),i/=100,0>i&&(i=0),i>1&&(i=1),E(t,new _(e,i)))},B.prototype.AddDistortionEffect=function(t,e,i,s,n,r){X===G&&z.createWaveShaper&&(t=t.toLowerCase(),r/=100,0>r&&(r=0),r>1&&(r=1),E(t,new v(e,i,s,n,r)))},B.prototype.AddCompressorEffect=function(t,e,i,s,n,r){X===G&&z.createDynamicsCompressor&&(t=t.toLowerCase(),E(t,new x(e,i,s,n/1e3,r/1e3)))},B.prototype.AddAnalyserEffect=function(t,e,i){X===G&&(t=t.toLowerCase(),E(t,new w(e,i)))},B.prototype.RemoveEffects=function(t){if(X===G){t=t.toLowerCase();var e,i,s;if(le.hasOwnProperty(t)&&(s=le[t],s.length)){for(e=0,i=s.length;i>e;e++)s[e].remove();s.length=0,A(t)}}},B.prototype.SetEffectParameter=function(t,e,i,s,n,r){if(X===G){t=t.toLowerCase(),e=Math.floor(e);var o;le.hasOwnProperty(t)&&(o=le[t],0>e||e>=o.length||o[e].setParam(i,s,n,r))}},B.prototype.SetListenerObject=function(t){if(t&&X===G){var e=t.getFirstPicked();e&&(this.listenerTracker.setObject(e),$=e.x,te=e.y)}},B.prototype.SetListenerZ=function(t){this.listenerZ=t},N.acts=new B,R.prototype.Duration=function(t,e){O(e,!0),t.set_float(ye.length?ye[0].getDuration():0)},R.prototype.PlaybackTime=function(t,e){O(e,!0),t.set_float(ye.length?ye[0].getPlaybackTime():0)},R.prototype.Volume=function(t,i){if(O(i,!0),ye.length){var s=ye[0].getVolume();t.set_float(e(s))}else t.set_float(0)},R.prototype.MasterVolume=function(t){t.set_float(K)},R.prototype.EffectCount=function(t,e){e=e.toLowerCase();var i=null;le.hasOwnProperty(e)&&(i=le[e]),t.set_int(i?i.length:0)},R.prototype.AnalyserFreqBinCount=function(t,e,i){e=e.toLowerCase(),i=Math.floor(i);var s=I(e,i);t.set_int(s?s.node.frequencyBinCount:0)},R.prototype.AnalyserFreqBinAt=function(t,e,i,s){e=e.toLowerCase(),i=Math.floor(i),s=Math.floor(s);var n=I(e,i);t.set_float(n?0>s||s>=n.node.frequencyBinCount?0:n.freqBins[s]:0)},R.prototype.AnalyserPeakLevel=function(t,e,i){e=e.toLowerCase(),i=Math.floor(i);var s=I(e,i);t.set_float(s?s.peak:0)},R.prototype.AnalyserRMSLevel=function(t,e,i){e=e.toLowerCase(),i=Math.floor(i);var s=I(e,i);t.set_float(s?s.rms:0)},N.exps=new R}(),cr.plugins_.Browser=function(t){this.runtime=t},function(){function Cnds(){}function Acts(){}function onFullscreenError(t){console&&console.warn&&console.warn("Fullscreen request failed: ",t),crruntime.setSize(window.innerWidth,window.innerHeight)}function Exps(){}var pluginProto=cr.plugins_.Browser.prototype;pluginProto.Type=function(t){this.plugin=t,this.runtime=t.runtime};var typeProto=pluginProto.Type.prototype;typeProto.onCreate=function(){},pluginProto.Instance=function(t){this.type=t,this.runtime=t.runtime};var instanceProto=pluginProto.Instance.prototype;instanceProto.onCreate=function(){var t=this;window.addEventListener("resize",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,t)}),"undefined"!=typeof navigator.onLine&&(window.addEventListener("online",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,t)}),window.addEventListener("offline",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,t)})),"undefined"!=typeof window.applicationCache&&(window.applicationCache.addEventListener("updateready",function(){t.runtime.loadingprogress=1,t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,t)}),window.applicationCache.addEventListener("progress",function(e){t.runtime.loadingprogress=e.loaded/e.total})),this.runtime.isDirectCanvas||(document.addEventListener("appMobi.device.update.available",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,t)}),document.addEventListener("backbutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)}),document.addEventListener("menubutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,t)}),document.addEventListener("searchbutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,t)}),document.addEventListener("tizenhwkey",function(e){var i;switch(e.keyName){case"back":i=t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t),i||window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case"menu":i=t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,t),i||e.preventDefault()}})),this.runtime.isWindowsPhone81&&(WinJS.Application.onbackclick=function(){return!!t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)}),this.runtime.addSuspendCallback(function(e){e?t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,t):t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,t)}),this.is_arcade="undefined"!=typeof window.is_scirra_arcade},Cnds.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1},Cnds.prototype.IsOnline=function(){return navigator?navigator.onLine:!1},Cnds.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1},Cnds.prototype.OnOnline=function(){return!0},Cnds.prototype.OnOffline=function(){return!0},Cnds.prototype.IsDownloadingUpdate=function(){return"undefined"==typeof window.applicationCache?!1:window.applicationCache.status===window.applicationCache.DOWNLOADING},Cnds.prototype.OnUpdateReady=function(){return!0},Cnds.prototype.PageVisible=function(){return!this.runtime.isSuspended},Cnds.prototype.OnPageVisible=function(){return!0},Cnds.prototype.OnPageHidden=function(){return!0},Cnds.prototype.OnResize=function(){return!0},Cnds.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)},Cnds.prototype.OnBackButton=function(){return!0},Cnds.prototype.OnMenuButton=function(){return!0},Cnds.prototype.OnSearchButton=function(){return!0},Cnds.prototype.IsMetered=function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return t?t.metered:!1},Cnds.prototype.IsCharging=function(){var t=navigator.battery||navigator.mozBattery||navigator.webkitBattery;return t?t.charging:!0},Cnds.prototype.IsPortraitLandscape=function(t){var e=window.innerWidth<=window.innerHeight?0:1;return e===t},pluginProto.cnds=new Cnds,Acts.prototype.Alert=function(t){this.runtime.isDomFree||alert(t.toString())},Acts.prototype.Close=function(){this.runtime.isCocoonJs?CocoonJS.App.forceToFinish():window.tizen?window.tizen.application.getCurrentApplication().exit():navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||this.runtime.isDomFree||window.close()},Acts.prototype.Focus=function(){if(this.runtime.isNodeWebkit){var t=window.nwgui.Window.get();t.focus()}else this.is_arcade||this.runtime.isDomFree||window.focus()},Acts.prototype.Blur=function(){if(this.runtime.isNodeWebkit){var t=window.nwgui.Window.get();t.blur()}else this.is_arcade||this.runtime.isDomFree||window.blur()},Acts.prototype.GoBack=function(){navigator.app&&navigator.app.backHistory?navigator.app.backHistory():this.is_arcade||this.runtime.isDomFree||!window.back||window.back()},Acts.prototype.GoForward=function(){this.is_arcade||this.runtime.isDomFree||!window.forward||window.forward()},Acts.prototype.GoHome=function(){this.is_arcade||this.runtime.isDomFree||!window.home||window.home()},Acts.prototype.GoToURL=function(t,e){this.runtime.isCocoonJs?CocoonJS.App.openURL(t):this.runtime.isEjecta?ejecta.openURL(t):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(t,{openExternal:!0}):this.runtime.isPhoneGap?window.open(t,"_system"):this.is_arcade||this.runtime.isDomFree||(2!==e||this.is_arcade?1!==e||this.is_arcade?window.location=t:window.parent.location=t:window.top.location=t)},Acts.prototype.GoToURLWindow=function(t,e){this.runtime.isCocoonJs?CocoonJS.App.openURL(t):this.runtime.isEjecta?ejecta.openURL(t):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(t,{openExternal:!0}):this.runtime.isPhoneGap?window.open(t,"_system"):this.is_arcade||this.runtime.isDomFree||window.open(t,e)},Acts.prototype.Reload=function(){this.is_arcade||this.runtime.isDomFree||window.location.reload()};var firstRequestFullscreen=!0,crruntime=null;Acts.prototype.RequestFullScreen=function(t){if(this.runtime.isDomFree)return void cr.logexport("[The Ruchi Game] Requesting fullscreen is not supported on this platform - the request has been ignored");if(t>=2&&(t+=1),6===t&&(t=2),this.runtime.isNodeWebkit)this.runtime.isNodeFullscreen||(window.nwgui.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=t>=2?t:0);else{if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement)return;this.runtime.fullscreen_scaling=t>=2?t:0;var e=this.runtime.canvasdiv||this.runtime.canvas;firstRequestFullscreen&&(firstRequestFullscreen=!1,crruntime=this.runtime,e.addEventListener("mozfullscreenerror",onFullscreenError),e.addEventListener("webkitfullscreenerror",onFullscreenError),e.addEventListener("MSFullscreenError",onFullscreenError),e.addEventListener("fullscreenerror",onFullscreenError)),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullScreen&&("undefined"!=typeof Element&&"undefined"!=typeof Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen())}},Acts.prototype.CancelFullScreen=function(){return this.runtime.isDomFree?void cr.logexport("[The Ruchi Game] Exiting fullscreen is not supported on this platform - the request has been ignored"):void(this.runtime.isNodeWebkit?this.runtime.isNodeFullscreen&&(window.nwgui.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen())},Acts.prototype.Vibrate=function(t){try{var e,i,s=t.split(",");for(e=0,i=s.length;i>e;e++)s[e]=parseInt(s[e],10);navigator.vibrate?navigator.vibrate(s):navigator.mozVibrate?navigator.mozVibrate(s):navigator.webkitVibrate?navigator.webkitVibrate(s):navigator.msVibrate&&navigator.msVibrate(s)}catch(n){}},Acts.prototype.InvokeDownload=function(t,e){var i=document.createElement("a");if("undefined"==typeof i.download)window.open(t);else{var s=document.getElementsByTagName("body")[0];i.textContent=e,i.href=t,i.download=e,s.appendChild(i);var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n),s.removeChild(i)}},Acts.prototype.InvokeDownloadString=function(t,e,i){var s="data:"+e+","+encodeURIComponent(t),n=document.createElement("a");if("undefined"==typeof n.download)window.open(s);else{var r=document.getElementsByTagName("body")[0];n.textContent=i,n.href=s,n.download=i,r.appendChild(n);var o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o),r.removeChild(n)}},Acts.prototype.ConsoleLog=function(t,e){"undefined"!=typeof console&&(0===t&&console.log&&console.log(e.toString()),1===t&&console.warn&&console.warn(e.toString()),2===t&&console.error&&console.error(e.toString()))},Acts.prototype.ConsoleGroup=function(t){console&&console.group&&console.group(t)},Acts.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()},Acts.prototype.ExecJs=function(js_){try{eval&&eval(js_)}catch(e){console&&console.error&&console.error("Error executing Javascript: ",e)}};var orientations=["portrait","landscape","portrait-primary","portrait-secondary","landscape-primary","landscape-secondary"];Acts.prototype.LockOrientation=function(t){if(t=Math.floor(t),!(0>t||t>=orientations.length)){this.runtime.autoLockOrientation=!1;var e=orientations[t];screen.lockOrientation?screen.lockOrientation(e):screen.webkitLockOrientation?screen.webkitLockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):screen.msLockOrientation&&screen.msLockOrientation(e)}},Acts.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1,screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},pluginProto.acts=new Acts,Exps.prototype.URL=function(t){t.set_string(this.runtime.isDomFree?"":window.location.toString())},Exps.prototype.Protocol=function(t){t.set_string(this.runtime.isDomFree?"":window.location.protocol)},Exps.prototype.Domain=function(t){t.set_string(this.runtime.isDomFree?"":window.location.hostname)},Exps.prototype.PathName=function(t){t.set_string(this.runtime.isDomFree?"":window.location.pathname)},Exps.prototype.Hash=function(t){t.set_string(this.runtime.isDomFree?"":window.location.hash)},Exps.prototype.Referrer=function(t){t.set_string(this.runtime.isDomFree?"":document.referrer)},Exps.prototype.Title=function(t){t.set_string(this.runtime.isDomFree?"":document.title)},Exps.prototype.Name=function(t){t.set_string(this.runtime.isDomFree?"":navigator.appName)},Exps.prototype.Version=function(t){t.set_string(this.runtime.isDomFree?"":navigator.appVersion)},Exps.prototype.Language=function(t){t.set_string(navigator&&navigator.language?navigator.language:"")},Exps.prototype.Platform=function(t){t.set_string(this.runtime.isDomFree?"":navigator.platform)},Exps.prototype.Product=function(t){t.set_string(navigator&&navigator.product?navigator.product:"")},Exps.prototype.Vendor=function(t){t.set_string(navigator&&navigator.vendor?navigator.vendor:"")},Exps.prototype.UserAgent=function(t){t.set_string(this.runtime.isDomFree?"":navigator.userAgent)},Exps.prototype.QueryString=function(t){t.set_string(this.runtime.isDomFree?"":window.location.search)},Exps.prototype.QueryParam=function(t,e){if(this.runtime.isDomFree)return void t.set_string("");var i=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);t.set_string(i?decodeURIComponent(i[1].replace(/\+/g," ")):"")},Exps.prototype.Bandwidth=function(t){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;t.set_float(e?e.bandwidth:Number.POSITIVE_INFINITY)},Exps.prototype.BatteryLevel=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;t.set_float(e?e.level:1)},Exps.prototype.BatteryTimeLeft=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;t.set_float(e?e.dischargingTime:Number.POSITIVE_INFINITY)},Exps.prototype.ExecJS=function(ret,js_){if(!eval)return void ret.set_any(0);var result=0;try{result=eval(js_)}catch(e){console&&console.error&&console.error("Error executing Javascript: ",e)}ret.set_any("number"==typeof result?result:"string"==typeof result?result:"boolean"==typeof result&&result?1:0)},Exps.prototype.ScreenWidth=function(t){t.set_int(screen.width)},Exps.prototype.ScreenHeight=function(t){t.set_int(screen.height)},Exps.prototype.DevicePixelRatio=function(t){t.set_float(this.runtime.devicePixelRatio)},pluginProto.exps=new Exps}(),cr.plugins_.Button=function(t){this.runtime=t},function(){function t(){}function e(){}function i(){}var s=cr.plugins_.Button.prototype;s.Type=function(t){this.plugin=t,this.runtime=t.runtime};var n=s.Type.prototype;n.onCreate=function(){},s.Instance=function(t){this.type=t,this.runtime=t.runtime};var r=s.Instance.prototype;r.onCreate=function(){return this.runtime.isDomFree?void cr.logexport("[The Ruchi Game] Button plugin not supported on this platform - the object will not be created"):(this.isCheckbox=1===this.properties[0],this.inputElem=document.createElement("input"),this.elem=this.isCheckbox?document.createElement("label"):this.inputElem,this.labelText=null,this.inputElem.type=this.isCheckbox?"checkbox":"button",this.inputElem.id=this.properties[6],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.isCheckbox?(jQuery(this.inputElem).appendTo(this.elem),this.labelText=document.createTextNode(this.properties[1]),jQuery(this.elem).append(this.labelText),this.inputElem.checked=0!==this.properties[7],jQuery(this.elem).css("font-family","sans-serif"),jQuery(this.elem).css("display","inline-block"),jQuery(this.elem).css("color","black")):this.inputElem.value=this.properties[1],this.elem.title=this.properties[2],this.inputElem.disabled=0===this.properties[4],this.autoFontSize=0!==this.properties[5],this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.inputElem.onclick=function(t){return function(e){e.stopPropagation(),t.runtime.isInUserInputEvent=!0,t.runtime.trigger(cr.plugins_.Button.prototype.cnds.OnClicked,t),t.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),jQuery(this.elem).mousedown(function(t){t.stopPropagation()}),jQuery(this.elem).mouseup(function(t){t.stopPropagation()}),jQuery(this.elem).keydown(function(t){t.stopPropagation()}),jQuery(this.elem).keyup(function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),void this.runtime.tickMe(this))},r.saveToJSON=function(){var t={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};return this.isCheckbox?(t.checked=!!this.inputElem.checked,t.text=this.labelText.nodeValue):t.text=this.elem.value,t},r.loadFromJSON=function(t){this.elem.title=t.tooltip,this.inputElem.disabled=t.disabled,this.isCheckbox?(this.inputElem.checked=t.checked,this.labelText.nodeValue=t.text):this.elem.value=t.text},r.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)},r.tick=function(){this.updatePosition()};r.updatePosition=function(t){if(!this.runtime.isDomFree){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),s=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1);if(!this.visible||!this.layer.visible||0>=s||0>=n||e>=this.runtime.width||i>=this.runtime.height)return this.element_hidden||jQuery(this.elem).hide(),void(this.element_hidden=!0);1>e&&(e=1),1>i&&(i=1),s>=this.runtime.width&&(s=this.runtime.width-1),n>=this.runtime.height&&(n=this.runtime.height-1);var r=window.innerWidth,o=window.innerHeight;if(!t&&this.lastLeft===e&&this.lastTop===i&&this.lastRight===s&&this.lastBottom===n&&this.lastWinWidth===r&&this.lastWinHeight===o)return void(this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1));this.lastLeft=e,this.lastTop=i,this.lastRight=s,this.lastBottom=n,this.lastWinWidth=r,this.lastWinHeight=o,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1);var a=Math.round(e)+jQuery(this.runtime.canvas).offset().left,h=Math.round(i)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:h}),jQuery(this.elem).width(Math.round(s-e)),jQuery(this.elem).height(Math.round(n-i)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")}},r.draw=function(){},r.drawGL=function(){},t.prototype.OnClicked=function(){return!0},t.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked},s.cnds=new t,e.prototype.SetText=function(t){this.runtime.isDomFree||(this.isCheckbox?this.labelText.nodeValue=t:this.elem.value=t)},e.prototype.SetTooltip=function(t){this.runtime.isDomFree||(this.elem.title=t)},e.prototype.SetVisible=function(t){this.runtime.isDomFree||(this.visible=0!==t)},e.prototype.SetEnabled=function(t){this.runtime.isDomFree||(this.inputElem.disabled=0===t)},e.prototype.SetFocus=function(){this.runtime.isDomFree||this.inputElem.focus()},e.prototype.SetBlur=function(){this.runtime.isDomFree||this.inputElem.blur()},e.prototype.SetCSSStyle=function(t,e){this.runtime.isDomFree||jQuery(this.elem).css(t,e)},e.prototype.SetChecked=function(t){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=1===t)},e.prototype.ToggleChecked=function(){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=!this.inputElem.checked)},s.acts=new e,s.exps=new i}(),cr.plugins_.Facebook=function(t){this.runtime=t},function(){function t(){c||(c=!0,f.trigger(cr.plugins_.Facebook.prototype.cnds.OnLogIn,g),FB.api("/me",function(t){u=t.name,p=t.first_name,d=t.last_name,f.trigger(cr.plugins_.Facebook.prototype.cnds.OnNameAvailable,g)}))}function e(){}function i(){}function s(){}var n=cr.plugins_.Facebook.prototype;n.Type=function(t){this.plugin=t,this.runtime=t.runtime};var r=n.Type.prototype,o="",a="",h=!1,c=!1,l="",u="",p="",d="",f=null,g=null,m=0,y="",_=0,v=0,b=!1,x=!1,w="",S=!1;r.onCreate=function(){},n.Instance=function(t){this.type=t,this.runtime=t.runtime};var T=n.Instance.prototype;T.onCreate=function(){return this.runtime.isDomFree?void cr.logexport("[The Ruchi Game] Facebook plugin not supported on this platform - the object will not be created"):(this.runtime.tickMe(this),o=this.properties[0],a=this.properties[1],f=this.runtime,g=this,window.fbAsyncInit=function(){var e=("//"+location.hostname,location.pathname);"/"!==e.substr(e.length-1)&&(e=e.substr(0,e.lastIndexOf("/")+1)),FB.init({appId:o,channelURL:"//"+location.hostname+e+"channel.html",status:!0,cookie:!0,oauth:!0,xfbml:!1}),h=!0,FB.Event.subscribe("auth.login",function(e){l=e.authResponse.userID,t()
}),FB.Event.subscribe("auth.logout",function(){c&&(c=!1,u="",p="",d="",f.trigger(cr.plugins_.Facebook.prototype.cnds.OnLogOut,g))}),FB.getLoginStatus(function(e){e.authResponse&&(l=e.authResponse.userID,t())}),S||(S=!0,f.trigger(cr.plugins_.Facebook.prototype.cnds.OnReady,g))},void(o.length&&!function(t){var e,i="facebook-jssdk";t.getElementById(i)||(e=t.createElement("script"),e.id=i,e.async=!0,e.src="//connect.facebook.net/en_US/all.js",t.getElementsByTagName("head")[0].appendChild(e))}(document)))},T.tick=function(){S||h&&(S=!0,f.trigger(cr.plugins_.Facebook.prototype.cnds.OnReady,g))},T.onLayoutChange=function(){this.runtime.isDomFree||(c&&f.trigger(cr.plugins_.Facebook.prototype.cnds.OnLogIn,g),u.length&&f.trigger(cr.plugins_.Facebook.prototype.cnds.OnNameAvailable,g))},e.prototype.IsReady=function(){return h},e.prototype.OnReady=function(){return!0},e.prototype.IsLoggedIn=function(){return c},e.prototype.OnLogIn=function(){return!0},e.prototype.OnLogOut=function(){return!0},e.prototype.OnNameAvailable=function(){return!0},e.prototype.OnUserTopScoreAvailable=function(){return!0},e.prototype.OnHiscore=function(){return!0},e.prototype.OnScoreSubmitted=function(){return!0},n.cnds=new e,i.prototype.LogIn=function(e,i){if(!this.runtime.isDomFree&&h){b=1===e,x=1===i;var s=[];b&&s.push("publish_stream"),x&&s.push("publish_actions");var n=s.join();w=n,FB.login(function(e){e.authResponse&&t()},{scope:w})}},i.prototype.LogOut=function(){this.runtime.isDomFree||c&&FB.logout(function(){})},i.prototype.PromptWallPost=function(){!this.runtime.isDomFree&&c&&FB.ui({method:"feed"},function(t){(!t||t.error)&&console.error(t)})},i.prototype.PromptToShareApp=function(t,e,i,s){!this.runtime.isDomFree&&c&&FB.ui({method:"feed",link:"http://apps.facebook.com/"+o+"/",picture:s,name:t,caption:e,description:i},function(t){(!t||t.error)&&console.error(t)})},i.prototype.PromptToShareLink=function(t,e,i,s,n){!this.runtime.isDomFree&&c&&FB.ui({method:"feed",link:t,picture:n,name:e,caption:i,description:s},function(t){(!t||t.error)&&console.error(t)})},i.prototype.PublishToWall=function(t){if(!this.runtime.isDomFree&&c){var e={method:"stream.publish",message:t};FB.api("/me/feed","POST",e,function(t){(!t||t.error)&&console.error(t)})}},i.prototype.PublishLink=function(t,e,i,s,n,r){if(!this.runtime.isDomFree&&c){var o={method:"stream.publish",message:t,link:e,name:i,caption:s,description:n};r.length&&(o.picture=r),FB.api("/me/feed","POST",o,function(t){(!t||t.error)&&console.error(t)})}},i.prototype.PublishScore=function(t){!this.runtime.isDomFree&&c&&FB.api("/"+l+"/scores","POST",{score:Math.floor(t),access_token:o+"|"+a},function(t){f.trigger(cr.plugins_.Facebook.prototype.cnds.OnScoreSubmitted,g),(!t||t.error)&&console.error(t)})},i.prototype.RequestUserHiscore=function(){!this.runtime.isDomFree&&c&&FB.api("/me/scores","GET",{},function(t){m=0;var e=t.data;if(!e)return void console.error("Request for user hi-score failed: "+t);var i,s;for(i=0,s=e.length;s>i;i++)e[i].score>m&&(m=e[i].score);f.trigger(cr.plugins_.Facebook.prototype.cnds.OnUserTopScoreAvailable,g),(!t||t.error)&&console.error(t)})},i.prototype.RequestHiscores=function(t){!this.runtime.isDomFree&&c&&FB.api("/"+o+"/scores","GET",{},function(e){var i=e.data;if(!i)return void console.error("Hi-scores request failed: "+e);i.sort(function(t,e){return e.score-t.score});for(var s=0,n=Math.min(i.length,t);n>s;s++)m=i[s].score,y=i[s].user.name,_=i[s].user.id,v=s+1,f.trigger(cr.plugins_.Facebook.prototype.cnds.OnHiscore,g);(!e||e.error)&&console.error(e)})},n.acts=new i,s.prototype.FullName=function(t){t.set_string(u)},s.prototype.FirstName=function(t){t.set_string(p)},s.prototype.LastName=function(t){t.set_string(d)},s.prototype.Score=function(t){t.set_int(m)},s.prototype.HiscoreName=function(t){t.set_string(y)},s.prototype.HiscoreUserID=function(t){t.set_int(_)},s.prototype.HiscoreRank=function(t){t.set_int(v)},s.prototype.UserID=function(t){t.set_float(parseFloat(l))},n.exps=new s}(),cr.plugins_.Sprite=function(t){this.runtime=t},function(){function t(){if(0===this.datauri.length){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");this.spritesheeted?e.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):e.drawImage(this.texture_img,0,0,this.width,this.height),this.datauri=t.toDataURL("image/png")}return this.datauri}function e(){}function i(){return m.length?m.pop():[0,0,0]}function s(t){t[0]=0,t[1]=0,t[2]=0,m.push(t)}function n(t,e){return e>t?""+t+","+e:""+e+","+t}function r(t,e,s,r){var o=e.uid,a=s.uid,h=n(o,a);if(t.hasOwnProperty(h))return void(t[h][2]=r);var c=i();c[0]=o,c[1]=a,c[2]=r,t[h]=c}function o(t,e,i){var r=n(e.uid,i.uid);t.hasOwnProperty(r)&&(s(t[r]),delete t[r])}function a(t,e){var i,n,r=e.uid;for(i in t)t.hasOwnProperty(i)&&(n=t[i],(n[0]===r||n[1]===r)&&(s(t[i]),delete t[i]))}function h(t,e,i){var s=n(e.uid,i.uid);return t.hasOwnProperty(s)?(y=t[s][2],!0):(y=-2,!1)}function c(t,e,i){if(!t)return!1;var s,n,r,o,a,h,c=0!==e||0!==i,l=!1,u=this.runtime.getCurrentCondition(),p=u.type,d=u.inverted,f=t.getCurrentSol(),g=this.runtime.getCurrentEventStack().current_event.orblock;for(f.select_all?(this.update_bbox(),this.runtime.getCollisionCandidates(this.layer,t,this.bbox,w),h=w):h=g?f.else_instances:f.instances,v=t,x=p!==t&&!d,c&&(s=this.x,n=this.y,this.x+=e,this.y+=i,this.set_bbox_changed()),r=0,o=h.length;o>r;r++)if(a=h[r],this.runtime.testOverlap(this,a)){if(l=!0,d)break;p!==t&&b.add(a)}return c&&(this.x=s,this.y=n,this.set_bbox_changed()),w.length=0,l}function l(){}function u(){}var p=cr.plugins_.Sprite.prototype;p.Type=function(t){this.plugin=t,this.runtime=t.runtime};var d=p.Type.prototype;d.onCreate=function(){if(!this.is_family){var e,i,s,n,r,o,a,h,c,l;for(this.all_frames=[],this.has_loaded_textures=!1,e=0,i=this.animations.length;i>e;e++){for(r=this.animations[e],a={},a.name=r[0],a.speed=r[1],a.loop=r[2],a.repeatcount=r[3],a.repeatto=r[4],a.pingpong=r[5],a.sid=r[6],a.frames=[],s=0,n=r[7].length;n>s;s++)o=r[7][s],h={},h.texture_file=o[0],h.texture_filesize=o[1],h.offx=o[2],h.offy=o[3],h.width=o[4],h.height=o[5],h.duration=o[6],h.hotspotX=o[7],h.hotspotY=o[8],h.image_points=o[9],h.poly_pts=o[10],h.pixelformat=o[11],h.spritesheeted=0!==h.width,h.datauri="",h.getDataUri=t,l={},l.left=0,l.top=0,l.right=1,l.bottom=1,h.sheetTex=l,h.webGL_texture=null,c=this.runtime.findWaitingTexture(o[0]),c?h.texture_img=c:(h.texture_img=new Image,h.texture_img.idtkLoadDisposed=!0,h.texture_img.src=o[0],h.texture_img.cr_src=o[0],h.texture_img.cr_filesize=o[1],h.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(h.texture_img)),cr.seal(h),a.frames.push(h),this.all_frames.push(h);cr.seal(a),this.animations[e]=a}}},d.updateAllCurrentTexture=function(){var t,e,i;for(t=0,e=this.instances.length;e>t;t++)i=this.instances[t],i.curWebGLTexture=i.curFrame.webGL_texture},d.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(t=0,e=this.all_frames.length;e>t;++t)i=this.all_frames[t],i.texture_img.c2webGL_texture=null,i.webGL_texture=null;this.has_loaded_textures=!1,this.updateAllCurrentTexture()}},d.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){var t,e,i;for(t=0,e=this.all_frames.length;e>t;++t)i=this.all_frames[t],i.webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);this.updateAllCurrentTexture()}},d.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var t,e,i;for(t=0,e=this.all_frames.length;e>t;++t)i=this.all_frames[t],i.webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);this.has_loaded_textures=!0}},d.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var t,e,i;for(t=0,e=this.all_frames.length;e>t;++t)i=this.all_frames[t],this.runtime.glwrap.deleteTexture(i.webGL_texture),i.webGL_texture=null;this.has_loaded_textures=!1}};var f=[];d.preloadCanvas2D=function(t){var e,i,s;for(f.length=0,e=0,i=this.all_frames.length;i>e;++e)s=this.all_frames[e].texture_img,-1===f.indexOf(s)&&(t.drawImage(s,0,0),f.push(s))},p.Instance=function(t){this.type=t,this.runtime=t.runtime;var e=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(e):this.collision_poly=new cr.CollisionPoly(e)};var g=p.Instance.prototype;g.onCreate=function(){this.visible=0===this.properties[0],this.isTicking=!1,this.inAnimTrigger=!1,this.collisionsEnabled=0!==this.properties[3],1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.type.animations[0].speed||(this.runtime.tickMe(this),this.isTicking=!0),this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0],this.cur_frame=this.properties[2],this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var t=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(t.poly_pts),this.hotspotX=t.hotspotX,this.hotspotY=t.hotspotY,this.cur_anim_speed=this.cur_animation.speed,this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder,this.frameStart=this.getNowTime(),this.animPlaying=!0,this.animRepeats=0,this.animForwards=!0,this.animTriggerName="",this.changeAnimName="",this.changeAnimFrom=0,this.changeAnimFrame=-1,this.type.loadTextures();var e,i,s,n,r,o,a,h;for(e=0,i=this.type.animations.length;i>e;e++)for(r=this.type.animations[e],s=0,n=r.frames.length;n>s;s++)o=r.frames[s],0===o.width&&(o.width=o.texture_img.width,o.height=o.texture_img.height),o.spritesheeted&&(h=o.texture_img,a=o.sheetTex,a.left=o.offx/h.width,a.top=o.offy/h.height,a.right=(o.offx+o.width)/h.width,a.bottom=(o.offy+o.height)/h.height,0===o.offx&&0===o.offy&&o.width===h.width&&o.height===h.height&&(o.spritesheeted=!1));this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture},g.saveToJSON=function(){var t={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum};return this.animPlaying||(t.ap=this.animPlaying),this.animForwards||(t.af=this.animForwards),t},g.loadFromJSON=function(t){var e=this.getAnimationBySid(t.a);e&&(this.cur_animation=e),this.cur_frame=t.f,this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),this.cur_anim_speed=t.cas,this.frameStart=t.fs,this.animRepeats=t.ar,this.animTimer.reset(),this.animTimer.sum=t.at,this.animPlaying=t.hasOwnProperty("ap")?t.ap:!0,this.animForwards=t.hasOwnProperty("af")?t.af:!0,this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture,this.collision_poly.set_pts(this.curFrame.poly_pts),this.hotspotX=this.curFrame.hotspotX,this.hotspotY=this.curFrame.hotspotY},g.animationFinish=function(t){this.cur_frame=t?0:this.cur_animation.frames.length-1,this.animPlaying=!1,this.animTriggerName=this.cur_animation.name,this.inAnimTrigger=!0,this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this),this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this),this.inAnimTrigger=!1,this.animRepeats=0},g.getNowTime=function(){return this.animTimer.sum},g.tick=function(){this.animTimer.add(this.runtime.getDt(this)),this.changeAnimName.length&&this.doChangeAnim(),this.changeAnimFrame>=0&&this.doChangeAnimFrame();var t,e=this.getNowTime(),i=this.cur_animation,s=i.frames[this.cur_frame],n=s.duration/this.cur_anim_speed;this.animPlaying&&e>=this.frameStart+n&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=n,this.cur_frame>=i.frames.length&&(i.pingpong?(this.animForwards=!1,this.cur_frame=i.frames.length-2):i.loop?this.cur_frame=i.repeatto:(this.animRepeats++,this.animRepeats>=i.repeatcount?this.animationFinish(!1):this.cur_frame=i.repeatto)),this.cur_frame<0&&(i.pingpong?(this.cur_frame=1,this.animForwards=!0,i.loop||(this.animRepeats++,this.animRepeats>=i.repeatcount&&this.animationFinish(!0))):i.loop?this.cur_frame=i.repeatto:(this.animRepeats++,this.animRepeats>=i.repeatcount?this.animationFinish(!0):this.cur_frame=i.repeatto)),this.cur_frame<0?this.cur_frame=0:this.cur_frame>=i.frames.length&&(this.cur_frame=i.frames.length-1),e>this.frameStart+i.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=e),t=i.frames[this.cur_frame],this.OnFrameChanged(s,t),this.runtime.redraw=!0)},g.getAnimationByName=function(t){var e,i,s;for(e=0,i=this.type.animations.length;i>e;e++)if(s=this.type.animations[e],cr.equals_nocase(s.name,t))return s;return null},g.getAnimationBySid=function(t){var e,i,s;for(e=0,i=this.type.animations.length;i>e;e++)if(s=this.type.animations[e],s.sid===t)return s;return null},g.doChangeAnim=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.getAnimationByName(this.changeAnimName);this.changeAnimName="",e&&(cr.equals_nocase(e.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=e,this.cur_anim_speed=e.speed,this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.animForwards=!0,this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0))},g.doChangeAnimFrame=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame),this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),e!==this.cur_frame&&(this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0),this.changeAnimFrame=-1},g.OnFrameChanged=function(t,e){var i=t.width,s=t.height,n=e.width,r=e.height;i!=n&&(this.width*=n/i),s!=r&&(this.height*=r/s),this.hotspotX=e.hotspotX,this.hotspotY=e.hotspotY,this.collision_poly.set_pts(e.poly_pts),this.set_bbox_changed(),this.curFrame=e,this.curWebGLTexture=e.webGL_texture;var o,a,h;for(o=0,a=this.behavior_insts.length;a>o;o++)h=this.behavior_insts[o],h.onSpriteFrameChanged&&h.onSpriteFrameChanged(t,e);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)},g.draw=function(t){t.globalAlpha=this.opacity;var e=this.curFrame,i=e.spritesheeted,s=e.texture_img,n=this.x,r=this.y,o=this.width,a=this.height;if(0===this.angle&&o>=0&&a>=0)n-=this.hotspotX*o,r-=this.hotspotY*a,this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),i?t.drawImage(s,e.offx,e.offy,e.width,e.height,n,r,o,a):t.drawImage(s,n,r,o,a);else{this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),t.save();var h=o>0?1:-1,c=a>0?1:-1;t.translate(n,r),(1!==h||1!==c)&&t.scale(h,c),t.rotate(this.angle*h*c);var l=0-this.hotspotX*cr.abs(o),u=0-this.hotspotY*cr.abs(a);i?t.drawImage(s,e.offx,e.offy,e.width,e.height,l,u,cr.abs(o),cr.abs(a)):t.drawImage(s,l,u,cr.abs(o),cr.abs(a)),t.restore()}},g.drawGL=function(t){t.setTexture(this.curWebGLTexture),t.setOpacity(this.opacity);var e=this.curFrame,i=this.bquad;if(this.runtime.pixel_rounding){var s=Math.round(this.x)-this.x,n=Math.round(this.y)-this.y;e.spritesheeted?t.quadTex(i.tlx+s,i.tly+n,i.trx+s,i.try_+n,i.brx+s,i.bry+n,i.blx+s,i.bly+n,e.sheetTex):t.quad(i.tlx+s,i.tly+n,i.trx+s,i.try_+n,i.brx+s,i.bry+n,i.blx+s,i.bly+n)}else e.spritesheeted?t.quadTex(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly,e.sheetTex):t.quad(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly)},g.getImagePointIndexByName=function(t){var e,i,s=this.curFrame;for(e=0,i=s.image_points.length;i>e;e++)if(cr.equals_nocase(t,s.image_points[e][0]))return e;return-1},g.getImagePoint=function(t,e){var i,s=this.curFrame,n=s.image_points;if(i=cr.is_string(t)?this.getImagePointIndexByName(t):t-1,i=cr.floor(i),0>i||i>=n.length)return e?this.x:this.y;var r=(n[i][1]-s.hotspotX)*this.width,o=n[i][2];o=(o-s.hotspotY)*this.height;var a=Math.cos(this.angle),h=Math.sin(this.angle),c=r*a-o*h;return o=o*a+r*h,r=c,r+=this.x,o+=this.y,e?r:o};var m=[],y=-2,_=[];e.prototype.OnCollision=function(t){if(!t)return!1;var e=this.runtime,i=e.getCurrentCondition(),s=i.type;i.extra.collmemory||(i.extra.collmemory={},e.addDestroyCallback(function(t){return function(e){a(t,e)}}(i.extra.collmemory)));{var n,c,l,u,p,d,f,g,m,v=i.extra.collmemory,b=s.getCurrentSol(),x=t.getCurrentSol(),w=b.getObjects(),S=this.runtime.tickcount,T=S-1,k=e.getCurrentEventStack().current_event;k.orblock}for(c=0;c<w.length;c++){for(l=w[c],x.select_all?(l.update_bbox(),this.runtime.getCollisionCandidates(l.layer,t,l.bbox,_),n=_):n=x.getObjects(),u=0;u<n.length;u++)p=n[u],e.testOverlap(l,p)||e.checkRegisteredCollision(l,p)?(g=h(v,l,p),m=!g||T>y,r(v,l,p,S),m&&(e.pushCopySol(k.solModifiers),d=s.getCurrentSol(),f=t.getCurrentSol(),d.select_all=!1,f.select_all=!1,s===t?(d.instances.length=2,d.instances[0]=l,d.instances[1]=p,s.applySolToContainer()):(d.instances.length=1,f.instances.length=1,d.instances[0]=l,f.instances[0]=p,s.applySolToContainer(),t.applySolToContainer()),k.retrigger(),e.popSol(k.solModifiers))):o(v,l,p);_.length=0}return!1};var v=null,b=new cr.ObjectSet,x=!1,w=[];d.finish=function(t){if(x){if(t){var e,i,s,n=this.runtime.getCurrentEventStack().current_event.orblock,r=v.getCurrentSol(),o=b.valuesRef();if(r.select_all){for(r.select_all=!1,r.instances.length=o.length,e=0,i=o.length;i>e;e++)r.instances[e]=o[e];if(n)for(r.else_instances.length=0,e=0,i=v.instances.length;i>e;e++)s=v.instances[e],b.contains(s)||r.else_instances.push(s)}else if(n){var a=r.instances.length;for(r.instances.length=a+o.length,e=0,i=o.length;i>e;e++)r.instances[a+e]=o[e],cr.arrayFindRemove(r.else_instances,o[e])}else cr.shallowAssignArray(r.instances,o);v.applySolToContainer()}b.clear(),x=!1}},e.prototype.IsOverlapping=function(t){return c.call(this,t,0,0)},e.prototype.IsOverlappingOffset=function(t,e,i){return c.call(this,t,e,i)},e.prototype.IsAnimPlaying=function(t){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,t):cr.equals_nocase(this.cur_animation.name,t)},e.prototype.CompareFrame=function(t,e){return cr.do_cmp(this.cur_frame,t,e)},e.prototype.CompareAnimSpeed=function(t,e){var i=this.animForwards?this.cur_anim_speed:-this.cur_anim_speed;return cr.do_cmp(i,t,e)},e.prototype.OnAnimFinished=function(t){return cr.equals_nocase(this.animTriggerName,t)},e.prototype.OnAnyAnimFinished=function(){return!0},e.prototype.OnFrameChanged=function(){return!0},e.prototype.IsMirrored=function(){return this.width<0},e.prototype.IsFlipped=function(){return this.height<0},e.prototype.OnURLLoaded=function(){return!0},e.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled},p.cnds=new e,l.prototype.Spawn=function(t,e,i){if(t&&e){var s=this.runtime.createInstance(t,e,this.getImagePoint(i,!0),this.getImagePoint(i,!1));if(s){"undefined"!=typeof s.angle&&(s.angle=this.angle,s.set_bbox_changed()),this.runtime.isInOnDestroy++;var n,r,o;if(this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,s),s.is_contained)for(n=0,r=s.siblings.length;r>n;n++)o=s.siblings[n],this.runtime.trigger(Object.getPrototypeOf(o.type.plugin).cnds.OnCreated,o);this.runtime.isInOnDestroy--;var a=this.runtime.getCurrentAction(),h=!1;(cr.is_undefined(a.extra.Spawn_LastExec)||a.extra.Spawn_LastExec<this.runtime.execcount)&&(h=!0,a.extra.Spawn_LastExec=this.runtime.execcount);var c;if(t!=this.type&&(c=t.getCurrentSol(),c.select_all=!1,h?(c.instances.length=1,c.instances[0]=s):c.instances.push(s),s.is_contained))for(n=0,r=s.siblings.length;r>n;n++)o=s.siblings[n],c=o.type.getCurrentSol(),c.select_all=!1,h?(c.instances.length=1,c.instances[0]=o):c.instances.push(o)}}},l.prototype.SetEffect=function(t){this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},l.prototype.StopAnim=function(){this.animPlaying=!1},l.prototype.StartAnim=function(t){this.animPlaying=!0,this.frameStart=this.getNowTime(),1===t&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame()),this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)},l.prototype.SetAnim=function(t,e){this.changeAnimName=t,this.changeAnimFrom=e,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0),this.inAnimTrigger||this.doChangeAnim()},l.prototype.SetAnimFrame=function(t){this.changeAnimFrame=t,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0),this.inAnimTrigger||this.doChangeAnimFrame()},l.prototype.SetAnimSpeed=function(t){this.cur_anim_speed=cr.abs(t),this.animForwards=t>=0,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)},l.prototype.SetMirrored=function(t){var e=cr.abs(this.width)*(0===t?-1:1);this.width!==e&&(this.width=e,this.set_bbox_changed())},l.prototype.SetFlipped=function(t){var e=cr.abs(this.height)*(0===t?-1:1);this.height!==e&&(this.height=e,this.set_bbox_changed())},l.prototype.SetScale=function(t){var e=this.curFrame,i=this.width<0?-1:1,s=this.height<0?-1:1,n=e.width*t*i,r=e.height*t*s;(this.width!==n||this.height!==r)&&(this.width=n,this.height=r,this.set_bbox_changed())},l.prototype.LoadURL=function(t,e){var i=new Image,s=this,n=this.curFrame;i.onload=function(){return n.texture_img.src===i.src?(s.runtime.glwrap&&s.curFrame===n&&(s.curWebGLTexture=n.webGL_texture),s.runtime.redraw=!0,void s.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,s)):(n.texture_img=i,n.offx=0,n.offy=0,n.width=i.width,n.height=i.height,n.spritesheeted=!1,n.datauri="",n.pixelformat=0,s.runtime.glwrap&&(n.webGL_texture&&s.runtime.glwrap.deleteTexture(n.webGL_texture),n.webGL_texture=s.runtime.glwrap.loadTexture(i,!1,s.runtime.linearSampling),s.curFrame===n&&(s.curWebGLTexture=n.webGL_texture),s.type.updateAllCurrentTexture()),0===e&&(s.width=i.width,s.height=i.height,s.set_bbox_changed()),s.runtime.redraw=!0,void s.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,s))},"data:"!==t.substr(0,5)&&(i.crossOrigin="anonymous"),i.src=t},l.prototype.SetCollisions=function(t){this.collisionsEnabled!==(0!==t)&&(this.collisionsEnabled=0!==t,this.collisionsEnabled?this.set_bbox_changed():(this.collcells.right>=this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))},p.acts=new l,u.prototype.AnimationFrame=function(t){t.set_int(this.cur_frame)},u.prototype.AnimationFrameCount=function(t){t.set_int(this.cur_animation.frames.length)},u.prototype.AnimationName=function(t){t.set_string(this.cur_animation.name)},u.prototype.AnimationSpeed=function(t){t.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)},u.prototype.ImagePointX=function(t,e){t.set_float(this.getImagePoint(e,!0))},u.prototype.ImagePointY=function(t,e){t.set_float(this.getImagePoint(e,!1))},u.prototype.ImagePointCount=function(t){t.set_int(this.curFrame.image_points.length)},u.prototype.ImageWidth=function(t){t.set_float(this.curFrame.width)},u.prototype.ImageHeight=function(t){t.set_float(this.curFrame.height)},p.exps=new u}(),cr.plugins_.Spritefont2=function(t){this.runtime=t},function(){function t(t){return t.replace(/\s\s*$/,"")}function e(t,e){return t.length?t.pop():new e}function i(t,e){t.length<v&&t.push(e)}function s(t,e,s){if(s){var n,r;for(n=0,r=e.length;r>n;n++)i(t,e[n]);e.length=0}else{var o;for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i(t,e[o]),delete e[o])}}function n(e,i,s){var n,o=e.lines;s=t(s),i>=o.length&&o.push(r()),n=o[i],n.text=s,n.width=e.measureWidth(s),e.textWidth=cr.max(e.textWidth,n.width)}function r(){return e(b,Object)}function o(t){i(b,t)}function a(t){s(b,t,!0)}function h(t,i,s,n,r,o){void 0===t[i]&&(t[i]=e(x,Object)),t[i].x=s,t[i].y=n,t[i].w=r,t[i].h=o}function c(t){s(x,t,!1)}function l(t,i,s,n,r,o){void 0===t[i]&&(t[i]=e(w,cr.rect)),t[i].left=s,t[i].top=n,t[i].right=r,t[i].bottom=o}function u(t){s(w,t,!1)}function p(t,e,i){var s;s=t.tlx*e-t.tly*i,t.tly=t.tly*e+t.tlx*i,t.tlx=s,s=t.trx*e-t.try_*i,t.try_=t.try_*e+t.trx*i,t.trx=s,s=t.blx*e-t.bly*i,t.bly=t.bly*e+t.blx*i,t.blx=s,s=t.brx*e-t.bry*i,t.bry=t.bry*e+t.brx*i,t.brx=s}function d(){}function f(){}function g(){}var m=cr.plugins_.Spritefont2.prototype;m.onCreate=function(){},m.Type=function(t){this.plugin=t,this.runtime=t.runtime};var y=m.Type.prototype;y.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.idtkLoadDisposed=!0,this.texture_img.src=this.texture_file,this.runtime.waitForImageLoad(this.texture_img),this.webGL_texture=null)},y.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)},y.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!1,this.runtime.linearSampling,this.texture_pixelformat));var t,e;for(t=0,e=this.instances.length;e>t;t++)this.instances[t].webGL_texture=this.webGL_texture}},y.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)},y.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},m.Instance=function(t){this.type=t,this.runtime=t.runtime};var _=m.Instance.prototype;_.onDestroy=function(){a(this.lines),c(this.clipList),u(this.clipUV),cr.wipe(this.characterWidthList)},_.onCreate=function(){this.texture_img=this.type.texture_img,this.characterWidth=this.properties[0],this.characterHeight=this.properties[1],this.characterSet=this.properties[2],this.text=this.properties[3],this.characterScale=this.properties[4],this.visible=0===this.properties[5],this.halign=this.properties[6]/2,this.valign=this.properties[7]/2,this.wrapbyword=0===this.properties[9],this.characterSpacing=this.properties[10],this.lineHeight=this.properties[11],this.textWidth=0,this.textHeight=0,this.recycled?(this.lines.length=0,cr.wipe(this.clipList),cr.wipe(this.clipUV),cr.wipe(this.characterWidthList)):(this.lines=[],this.clipList={},this.clipUV={},this.characterWidthList={}),this.text_changed=!0,this.lastwrapwidth=this.width,this.runtime.glwrap&&(this.type.webGL_texture||(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat)),this.webGL_texture=this.type.webGL_texture),this.SplitSheet()},_.saveToJSON=function(){var t={t:this.text,csc:this.characterScale,csp:this.characterSpacing,lh:this.lineHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick,cw:{}};for(var e in this.characterWidthList)t.cw[e]=this.characterWidthList[e];return t},_.loadFromJSON=function(t){this.text=t.t,this.characterScale=t.csc,this.characterSpacing=t.csp,this.lineHeight=t.lh,this.textWidth=t.tw,this.textHeight=t.th,this.last_render_tick=t.lrt;for(var e in t.cw)this.characterWidthList[e]=t.cw[e];this.text_changed=!0,this.lastwrapwidth=this.width};var v=1e3,b=[],x=[],w=[];_.SplitSheet=function(){for(var t=this.texture_img,e=t.width,i=t.height,s=this.characterWidth,n=this.characterHeight,r=s/e,o=n/i,a=this.characterSet,c=Math.floor(e/s),u=Math.floor(i/n),p=0;p<a.length&&!(p>=c*u);p++){var d=p%c,f=Math.floor(p/c),g=a.charAt(p);this.runtime.glwrap?l(this.clipUV,g,d*r,f*o,(d+1)*r,(f+1)*o):h(this.clipList,g,d*s,f*n,s,n)}};var S=[];m.TokeniseWords=function(t){S.length=0;for(var e,i="",s=0;s<t.length;)if(e=t.charAt(s),"\n"===e)i.length&&(S.push(i),i=""),S.push("\n"),++s;else if(" "===e||"	"===e||"-"===e){do i+=t.charAt(s),s++;while(s<t.length&&(" "===t.charAt(s)||"	"===t.charAt(s)));S.push(i),i=""}else s<t.length&&(i+=e,s++);i.length&&S.push(i)},m.WordWrap=function(t){var e=t.text,i=t.lines;if(!e||!e.length)return void a(i);var s=t.width;if(2>=s)return void a(i);var n=t.characterWidth,o=t.characterScale,h=t.characterSpacing;if(e.length*(n*o+h)-h<=s&&-1===e.indexOf("\n")){var c=t.measureWidth(e);if(s>=c)return a(i),i.push(r()),i[0].text=e,i[0].width=c,t.textWidth=c,void(t.textHeight=t.characterHeight*o+t.lineHeight)}t.wrapbyword;this.WrapText(t),t.textHeight=i.length*(t.characterHeight*o+t.lineHeight)},m.WrapText=function(e){var i,s=e.wrapbyword,r=e.text,a=e.lines,h=e.width;s?(this.TokeniseWords(r),i=S):i=r;var c,l,u,p="",d=0,f=!1;for(u=0;u<i.length;u++)"\n"!==i[u]?(f=!1,c=p,p+=i[u],l=e.measureWidth(t(p)),l>h&&(""===c?(n(e,d,p),p="",f=!0):(n(e,d,c),p=i[u]),d++,s||" "!==p||(p=""))):(f===!0?f=!1:(n(e,d,p),d++),p="");for(t(p).length&&(n(e,d,p),d++),u=d;u<a.length;u++)o(a[u]);a.length=d},_.measureWidth=function(t){for(var e=this.characterSpacing,i=t.length,s=0,n=0;i>n;n++)s+=this.getCharacterWidth(t.charAt(n))*this.characterScale+e;return s-=s>0?e:0},_.getCharacterWidth=function(t){var e=this.characterWidthList;return void 0!==e[t]?e[t]:this.characterWidth},_.rebuildText=function(){(this.text_changed||this.width!==this.lastwrapwidth)&&(this.textWidth=0,this.textHeight=0,this.type.plugin.WordWrap(this),this.text_changed=!1,this.lastwrapwidth=this.width)};var T=1e-5;_.draw=function(t){var e=this.texture_img;if(""!==this.text&&null!=e){if(this.rebuildText(),this.height<this.characterHeight*this.characterScale+this.lineHeight)return;t.globalAlpha=this.opacity;var i=this.x,s=this.y;this.runtime.pixel_rounding&&(i=Math.round(i),s=Math.round(s));var n=this.layer.viewLeft,r=this.layer.viewTop,o=this.layer.viewRight,a=this.layer.viewBottom;t.save(),t.translate(i,s),t.rotate(this.angle);var h,c,l=this.halign,u=this.valign,p=this.characterScale,d=this.characterHeight*p,f=this.lineHeight,g=this.characterSpacing,m=this.lines,y=this.textHeight,_=u*cr.max(0,this.height-y),v=-(this.hotspotX*this.width),b=-(this.hotspotY*this.height);b+=_;for(var x,w,S,k=b,C=0;C<m.length;C++){var O=m[C].text,A=m[C].width;if(c=l*cr.max(0,this.width-A),x=v+c,k+=f,r>s+k+d)k+=d;else{for(var E=0;E<O.length;E++){var P=O.charAt(E);h=this.getCharacterWidth(P);var B=this.clipList[P];if(n>i+x+h*p+g)x+=h*p+g;else{if(x+h*p>this.width+T)break;if(void 0!==B&&(w=x,S=k,0===this.angle&&(w=Math.round(w),S=Math.round(S)),t.drawImage(this.texture_img,B.x,B.y,B.w,B.h,w,S,B.w*p,B.h*p)),x+=h*p+g,i+x>o)break}}if(k+=d,k+d+f>this.height||s+k>a)break}}t.restore()}};var k=new cr.quad;_.drawGL=function(t){if(t.setTexture(this.webGL_texture),t.setOpacity(this.opacity),this.text&&(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight))){this.update_bbox();var e=this.bquad,i=0,s=0;this.runtime.pixel_rounding&&(i=Math.round(this.x)-this.x,s=Math.round(this.y)-this.y);var n,r,o,a=this.layer.viewLeft,h=this.layer.viewTop,c=this.layer.viewRight,l=this.layer.viewBottom,u=this.angle,d=this.halign,f=this.valign,g=this.characterScale,m=this.characterHeight*g,y=this.lineHeight,_=this.characterSpacing,v=this.lines,b=this.textHeight;0!==u&&(r=Math.cos(u),o=Math.sin(u));for(var x,w,S,C,O=f*cr.max(0,this.height-b),A=e.tlx+i,E=e.tly+s,P=O,B=0;B<v.length;B++){var R=v[B].text,I=v[B].width;if(x=d*cr.max(0,this.width-I),w=x,P+=y,h>E+P+m)P+=m;else{for(var N=0;N<R.length;N++){var M=R.charAt(N);n=this.getCharacterWidth(M);var L=this.clipUV[M];if(a>A+w+n*g+_)w+=n*g+_;else{if(w+n*g>this.width+T)break;if(void 0!==L){var D=this.characterWidth*g,F=this.characterHeight*g;S=w,C=P,0===u&&(S=Math.round(S),C=Math.round(C)),k.tlx=S,k.tly=C,k.trx=S+D,k.try_=C,k.blx=S,k.bly=C+F,k.brx=S+D,k.bry=C+F,0!==u&&p(k,r,o),k.offset(A,E),t.quadTex(k.tlx,k.tly,k.trx,k.try_,k.brx,k.bry,k.blx,k.bly,L)}if(w+=n*g+_,A+w>c)break}}if(P+=m,P+m+y>this.height||E+P>l)break}}}},d.prototype.CompareText=function(t,e){return e?this.text==t:cr.equals_nocase(this.text,t)},m.cnds=new d,f.prototype.SetText=function(t){cr.is_number(t)&&1e9>t&&(t=Math.round(1e10*t)/1e10);var e=t.toString();this.text!==e&&(this.text=e,this.text_changed=!0,this.runtime.redraw=!0)},f.prototype.AppendText=function(t){cr.is_number(t)&&(t=Math.round(1e10*t)/1e10);var e=t.toString();e&&(this.text+=e,this.text_changed=!0,this.runtime.redraw=!0)},f.prototype.SetScale=function(t){t!==this.characterScale&&(this.characterScale=t,this.text_changed=!0,this.runtime.redraw=!0)
},f.prototype.SetCharacterSpacing=function(t){t!==this.CharacterSpacing&&(this.characterSpacing=t,this.text_changed=!0,this.runtime.redraw=!0)},f.prototype.SetLineHeight=function(t){t!==this.lineHeight&&(this.lineHeight=t,this.text_changed=!0,this.runtime.redraw=!0)},_.SetCharWidth=function(t,e){var i=parseInt(e,10);this.characterWidthList[t]!==i&&(this.characterWidthList[t]=i,this.text_changed=!0,this.runtime.redraw=!0)},f.prototype.SetCharacterWidth=function(t,e){if(""!==t)for(var i=0;i<t.length;i++)this.SetCharWidth(t.charAt(i),e)},f.prototype.SetEffect=function(t){this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},f.prototype.SetHAlign=function(t){this.halign=t/2,this.text_changed=!0,this.runtime.redraw=!0},f.prototype.SetVAlign=function(t){this.valign=t/2,this.text_changed=!0,this.runtime.redraw=!0},m.acts=new f,g.prototype.CharacterWidth=function(t,e){t.set_int(this.getCharacterWidth(e))},g.prototype.CharacterHeight=function(t){t.set_int(this.characterHeight)},g.prototype.CharacterScale=function(t){t.set_float(this.characterScale)},g.prototype.CharacterSpacing=function(t){t.set_int(this.characterSpacing)},g.prototype.LineHeight=function(t){t.set_int(this.lineHeight)},g.prototype.Text=function(t){t.set_string(this.text)},g.prototype.TextWidth=function(t){this.rebuildText(),t.set_float(this.textWidth)},g.prototype.TextHeight=function(t){this.rebuildText(),t.set_float(this.textHeight)},m.exps=new g}(),cr.plugins_.Text=function(t){this.runtime=t},function(){function t(){return u.length?u.pop():{}}function e(t){u.push(t)}function i(t){var i,s;for(i=0,s=t.length;s>i;i++)e(t[i]);t.length=0}function s(){}function n(){}function r(){}var o=cr.plugins_.Text.prototype;o.onCreate=function(){o.acts.SetWidth=function(t){this.width!==t&&(this.width=t,this.text_changed=!0,this.set_bbox_changed())}},o.Type=function(t){this.plugin=t,this.runtime=t.runtime};var a=o.Type.prototype;a.onCreate=function(){},a.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(t=0,e=this.instances.length;e>t;t++)i=this.instances[t],i.mycanvas=null,i.myctx=null,i.mytex=null}},o.Instance=function(t){this.type=t,this.runtime=t.runtime,this.recycled?this.lines.length=0:this.lines=[],this.text_changed=!0};var h=o.Instance.prototype,c={};h.onCreate=function(){this.text=this.properties[0],this.visible=0===this.properties[1],this.font=this.properties[2],this.color=this.properties[3],this.halign=this.properties[4],this.valign=this.properties[5],this.wrapbyword=0===this.properties[7],this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height,this.line_height_offset=this.properties[8],this.facename="",this.fontstyle="",this.ptSize=0,this.textWidth=0,this.textHeight=0,this.parseFont(),this.mycanvas=null,this.myctx=null,this.mytex=null,this.need_text_redraw=!1,this.last_render_tick=this.runtime.tickcount,this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1),this.runtime.glwrap&&this.runtime.tickMe(this)},h.parseFont=function(){var t,e=this.font.split(" ");for(t=0;t<e.length;t++)if("pt"===e[t].substr(e[t].length-2,2)){for(this.ptSize=parseInt(e[t].substr(0,e[t].length-2)),this.pxHeight=Math.ceil(this.ptSize/72*96)+4,t>0&&(this.fontstyle=e[t-1]),this.facename=e[t+1],t+=2;t<e.length;t++)this.facename+=" "+e[t];break}},h.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}},h.loadFromJSON=function(t){this.text=t.t,this.font=t.f,this.color=t.c,this.halign=t.ha,this.valign=t.va,this.wrapbyword=t.wr,this.line_height_offset=t.lho,this.facename=t.fn,this.fontstyle=t.fs,this.ptSize=t.ps,this.pxHeight=t.pxh,this.textWidth=t.tw,this.textHeight=t.th,this.last_render_tick=t.lrt,this.text_changed=!0,this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height},h.tick=function(){if(this.runtime.glwrap&&this.mytex&&this.runtime.tickcount-this.last_render_tick>=300){var t=this.layer;this.update_bbox();var e=this.bbox;(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)&&(this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null,this.myctx=null,this.mycanvas=null)}},h.onDestroy=function(){this.myctx=null,this.mycanvas=null,this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null},h.updateFont=function(){this.font=this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename,this.text_changed=!0,this.runtime.redraw=!0},h.draw=function(t,e){t.font=this.font,t.textBaseline="top",t.fillStyle=this.color,t.globalAlpha=e?1:this.opacity;var i=1;e&&(i=this.layer.getScale(),t.save(),t.scale(i,i)),(this.text_changed||this.width!==this.lastwrapwidth)&&(this.type.plugin.WordWrap(this.text,this.lines,t,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width),this.update_bbox();var s=e?0:this.bquad.tlx,n=e?0:this.bquad.tly;this.runtime.pixel_rounding&&(s=s+.5|0,n=n+.5|0),0===this.angle||e||(t.save(),t.translate(s,n),t.rotate(this.angle),s=0,n=0);var r=n+this.height,o=this.pxHeight;o+=this.line_height_offset;var a,h;for(1===this.valign?n+=Math.max(this.height/2-this.lines.length*o/2,0):2===this.valign&&(n+=Math.max(this.height-this.lines.length*o-2,0)),h=0;h<this.lines.length&&(a=s,1===this.halign?a=s+(this.width-this.lines[h].width)/2:2===this.halign&&(a=s+(this.width-this.lines[h].width)),t.fillText(this.lines[h].text,a,n),n+=o,!(n>=r-o));h++);(0!==this.angle||e)&&t.restore(),this.last_render_tick=this.runtime.tickcount},h.drawGL=function(t){if(!(this.width<1||this.height<1)){var e=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var i=this.layer.getScale(),s=this.layer.getAngle(),n=this.rcTex,r=i*this.width,o=i*this.height,a=Math.ceil(r),h=Math.ceil(o),c=this.runtime.draw_width/2,l=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=a,this.mycanvas.height=h,this.lastwidth=a,this.lastheight=h,e=!0,this.myctx=this.mycanvas.getContext("2d")),(a!==this.lastwidth||h!==this.lastheight)&&(this.mycanvas.width=a,this.mycanvas.height=h,this.mytex&&(t.deleteTexture(this.mytex),this.mytex=null),e=!0),e&&(this.myctx.clearRect(0,0,a,h),this.draw(this.myctx,!0),this.mytex||(this.mytex=t.createEmptyTexture(a,h,this.runtime.linearSampling,this.runtime.isMobile)),t.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile)),this.lastwidth=a,this.lastheight=h,t.setTexture(this.mytex),t.setOpacity(this.opacity),t.resetModelView(),t.translate(-c,-l),t.updateModelView();var u=this.bquad,p=this.layer.layerToCanvas(u.tlx,u.tly,!0,!0),d=this.layer.layerToCanvas(u.tlx,u.tly,!1,!0),f=this.layer.layerToCanvas(u.trx,u.try_,!0,!0),g=this.layer.layerToCanvas(u.trx,u.try_,!1,!0),m=this.layer.layerToCanvas(u.brx,u.bry,!0,!0),y=this.layer.layerToCanvas(u.brx,u.bry,!1,!0),_=this.layer.layerToCanvas(u.blx,u.bly,!0,!0),v=this.layer.layerToCanvas(u.blx,u.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===s){var b=(p+.5|0)-p,x=(d+.5|0)-d;p+=b,d+=x,f+=b,g+=x,m+=b,y+=x,_+=b,v+=x}0===this.angle&&0===s?(f=p+a,g=d,m=f,y=d+h,_=p,v=y,n.right=1,n.bottom=1):(n.right=r/a,n.bottom=o/h),t.quadTex(p,d,f,g,m,y,_,v,n),t.resetModelView(),t.scale(i,i),t.rotateZ(-this.layer.getAngle()),t.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2),t.updateModelView(),this.last_render_tick=this.runtime.tickcount}};var l=[];o.TokeniseWords=function(t){l.length=0;for(var e,i="",s=0;s<t.length;)if(e=t.charAt(s),"\n"===e)i.length&&(l.push(i),i=""),l.push("\n"),++s;else if(" "===e||"	"===e||"-"===e){do i+=t.charAt(s),s++;while(s<t.length&&(" "===t.charAt(s)||"	"===t.charAt(s)));l.push(i),i=""}else s<t.length&&(i+=e,s++);i.length&&l.push(i)};var u=[];o.WordWrap=function(e,s,n,r,o){if(!e||!e.length)return void i(s);if(2>=r)return void i(s);if(e.length<=100&&-1===e.indexOf("\n")){var a=n.measureText(e).width;if(r>=a)return i(s),s.push(t()),s[0].text=e,void(s[0].width=a)}this.WrapText(e,s,n,r,o)},o.WrapText=function(i,s,n,r,o){var a;o?(this.TokeniseWords(i),a=l):a=i;var h,c,u,p,d="",f=0;for(u=0;u<a.length;u++)"\n"!==a[u]?(h=d,d+=a[u],c=n.measureText(d).width,c>=r&&(f>=s.length&&s.push(t()),p=s[f],p.text=h,p.width=n.measureText(h).width,f++,d=a[u],o||" "!==d||(d=""))):(f>=s.length&&s.push(t()),p=s[f],p.text=d,p.width=n.measureText(d).width,f++,d="");for(d.length&&(f>=s.length&&s.push(t()),p=s[f],p.text=d,p.width=n.measureText(d).width,f++),u=f;u<s.length;u++)e(s[u]);s.length=f},s.prototype.CompareText=function(t,e){return e?this.text==t:cr.equals_nocase(this.text,t)},o.cnds=new s,n.prototype.SetText=function(t){cr.is_number(t)&&1e9>t&&(t=Math.round(1e10*t)/1e10);var e=t.toString();this.text!==e&&(this.text=e,this.text_changed=!0,this.runtime.redraw=!0)},n.prototype.AppendText=function(t){cr.is_number(t)&&(t=Math.round(1e10*t)/1e10);var e=t.toString();e&&(this.text+=e,this.text_changed=!0,this.runtime.redraw=!0)},n.prototype.SetFontFace=function(t,e){var i="";switch(e){case 1:i="bold";break;case 2:i="italic";break;case 3:i="bold italic"}(t!==this.facename||i!==this.fontstyle)&&(this.facename=t,this.fontstyle=i,this.updateFont())},n.prototype.SetFontSize=function(t){this.ptSize!==t&&(this.ptSize=t,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())},n.prototype.SetFontColor=function(t){var e="rgb("+cr.GetRValue(t).toString()+","+cr.GetGValue(t).toString()+","+cr.GetBValue(t).toString()+")";e!==this.color&&(this.color=e,this.need_text_redraw=!0,this.runtime.redraw=!0)},n.prototype.SetWebFont=function(t,e){if(this.runtime.isDomFree)return void cr.logexport("[The Ruchi Game] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");var i=this,s=function(){i.runtime.redraw=!0,i.text_changed=!0};if(c.hasOwnProperty(e)){var n="'"+t+"'";if(this.facename===n)return;this.facename=n,this.updateFont();for(var r=1;10>r;r++)setTimeout(s,100*r),setTimeout(s,1e3*r)}else{var o=document.createElement("link");o.href=e,o.rel="stylesheet",o.type="text/css",o.onload=s,document.getElementsByTagName("head")[0].appendChild(o),c[e]=!0,this.facename="'"+t+"'",this.updateFont();for(var r=1;10>r;r++)setTimeout(s,100*r),setTimeout(s,1e3*r)}},n.prototype.SetEffect=function(t){this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},o.acts=new n,r.prototype.Text=function(t){t.set_string(this.text)},r.prototype.FaceName=function(t){t.set_string(this.facename)},r.prototype.FaceSize=function(t){t.set_int(this.ptSize)},r.prototype.TextWidth=function(t){var e,i,s,n=0;for(e=0,i=this.lines.length;i>e;e++)s=this.lines[e].width,s>n&&(n=s);t.set_int(n)},r.prototype.TextHeight=function(t){t.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)},o.exps=new r}(),cr.plugins_.Touch=function(t){this.runtime=t},function(){function t(t){u=t.x,p=t.y,d=t.z}function e(t){f=t.x,g=t.y,m=t.z}function i(t,e,i,s){var r;return r=_.length?_.pop():new n,r.init(t,e,i,s),r}function s(t){_.length<100&&_.push(t)}function n(){this.starttime=0,this.time=0,this.lasttime=0,this.startx=0,this.starty=0,this.x=0,this.y=0,this.lastx=0,this.lasty=0,this.id=0,this.startindex=0,this.triggeredHold=!1,this.tooFarForHold=!1}function r(){}function o(){}var a=cr.plugins_.Touch.prototype;a.Type=function(t){this.plugin=t,this.runtime=t.runtime};var h=a.Type.prototype;h.onCreate=function(){},a.Instance=function(t){this.type=t,this.runtime=t.runtime,this.touches=[],this.mouseDown=!1};var c=a.Instance.prototype,l={left:0,top:0};c.findTouch=function(t){var e,i;for(e=0,i=this.touches.length;i>e;e++)if(this.touches[e].id===t)return e;return-1};var u=0,p=0,d=0,f=0,g=0,m=0,y=null,_=[],v=15,b=500,x=333,w=25;n.prototype.init=function(t,e,i,s){var n=cr.performance_now();this.time=n,this.lasttime=n,this.starttime=n,this.startx=t,this.starty=e,this.x=t,this.y=e,this.lastx=t,this.lasty=e,this.id=i,this.startindex=s,this.triggeredHold=!1,this.tooFarForHold=!1},n.prototype.update=function(t,e,i){this.lasttime=this.time,this.time=t,this.lastx=this.x,this.lasty=this.y,this.x=e,this.y=i,!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)>=v&&(this.tooFarForHold=!0)},n.prototype.maybeTriggerHold=function(t,e){if(!this.triggeredHold){var i=cr.performance_now();i-this.starttime>=b&&!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)<v&&(this.triggeredHold=!0,t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,t),t.getTouchIndex=0)}};var S=-1e3,T=-1e3,k=-1e4;n.prototype.maybeTriggerTap=function(t,e){if(!this.triggeredHold){var i=cr.performance_now();i-this.starttime<=x&&!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)<v&&(t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,2*x>=i-k&&cr.distanceTo(S,T,this.x,this.y)<w?(t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,t),S=-1e3,T=-1e3,k=-1e4):(t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,t),S=this.x,T=this.y,k=i),t.getTouchIndex=0)}},c.onCreate=function(){y=this,this.isWindows8=!("undefined"==typeof window.c2isWindows8||!window.c2isWindows8),this.orient_alpha=0,this.orient_beta=0,this.orient_gamma=0,this.acc_g_x=0,this.acc_g_y=0,this.acc_g_z=0,this.acc_x=0,this.acc_y=0,this.acc_z=0,this.curTouchX=0,this.curTouchY=0,this.trigger_index=0,this.trigger_id=0,this.getTouchIndex=0,this.useMouseInput=0!==this.properties[0];var i=this.runtime.fullscreen_mode>0?document:this.runtime.canvas,s=document;this.runtime.isDirectCanvas?s=i=window.Canvas:this.runtime.isCocoonJs&&(s=i=window);var n=this;if(window.navigator.pointerEnabled?(i.addEventListener("pointerdown",function(t){n.onPointerStart(t)},!1),i.addEventListener("pointermove",function(t){n.onPointerMove(t)},!1),s.addEventListener("pointerup",function(t){n.onPointerEnd(t,!1)},!1),s.addEventListener("pointercancel",function(t){n.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(t){t.preventDefault()},!1),document.addEventListener("gesturehold",function(t){t.preventDefault()},!1))):window.navigator.msPointerEnabled?(i.addEventListener("MSPointerDown",function(t){n.onPointerStart(t)},!1),i.addEventListener("MSPointerMove",function(t){n.onPointerMove(t)},!1),s.addEventListener("MSPointerUp",function(t){n.onPointerEnd(t,!1)},!1),s.addEventListener("MSPointerCancel",function(t){n.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1))):(i.addEventListener("touchstart",function(t){n.onTouchStart(t)},!1),i.addEventListener("touchmove",function(t){n.onTouchMove(t)},!1),s.addEventListener("touchend",function(t){n.onTouchEnd(t,!1)},!1),s.addEventListener("touchcancel",function(t){n.onTouchEnd(t,!0)},!1)),this.isWindows8){var r=function(t){var e=t.reading;n.acc_x=e.accelerationX,n.acc_y=e.accelerationY,n.acc_z=e.accelerationZ},o=function(t){var e=t.reading;n.orient_alpha=e.yawDegrees,n.orient_beta=e.pitchDegrees,n.orient_gamma=e.rollDegrees},a=Windows.Devices.Sensors.Accelerometer.getDefault();a&&(a.reportInterval=Math.max(a.minimumReportInterval,16),a.addEventListener("readingchanged",r));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",o)),document.addEventListener("visibilitychange",function(){document.hidden||document.msHidden?(a&&a.removeEventListener("readingchanged",r),h&&h.removeEventListener("readingchanged",o)):(a&&a.addEventListener("readingchanged",r),h&&h.addEventListener("readingchanged",o))},!1)}else window.addEventListener("deviceorientation",function(t){n.orient_alpha=t.alpha||0,n.orient_beta=t.beta||0,n.orient_gamma=t.gamma||0},!1),window.addEventListener("devicemotion",function(t){t.accelerationIncludingGravity&&(n.acc_g_x=t.accelerationIncludingGravity.x||0,n.acc_g_y=t.accelerationIncludingGravity.y||0,n.acc_g_z=t.accelerationIncludingGravity.z||0),t.acceleration&&(n.acc_x=t.acceleration.x||0,n.acc_y=t.acceleration.y||0,n.acc_z=t.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(t){n.onMouseMove(t)}),jQuery(document).mousedown(function(t){n.onMouseDown(t)}),jQuery(document).mouseup(function(t){n.onMouseUp(t)})),this.runtime.isAppMobi&&!this.runtime.isDirectCanvas&&AppMobi.accelerometer.watchAcceleration(t,{frequency:40,adjustForRotation:!0}),this.runtime.isPhoneGap&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(e,null,{frequency:40}),this.runtime.tick2Me(this)},c.onPointerMove=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&t.preventDefault();var e=this.findTouch(t.pointerId),i=cr.performance_now();if(e>=0){var s=this.runtime.isDomFree?l:jQuery(this.runtime.canvas).offset(),n=this.touches[e];if(i-n.time<2)return;n.update(i,t.pageX-s.left,t.pageY-s.top)}}},c.onPointerStart=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();{var e=this.runtime.isDomFree?l:jQuery(this.runtime.canvas).offset(),s=t.pageX-e.left,n=t.pageY-e.top;cr.performance_now()}this.trigger_index=this.touches.length,this.trigger_id=t.pointerId,this.touches.push(i(s,n,t.pointerId,this.trigger_index)),this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=s,this.curTouchY=n,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this),this.runtime.isInUserInputEvent=!1}},c.onPointerEnd=function(t,e){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var i=this.findTouch(t.pointerId);this.trigger_index=i>=0?this.touches[i].startindex:-1,this.trigger_id=i>=0?this.touches[i].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),i>=0&&(e||this.touches[i].maybeTriggerTap(this,i),s(this.touches[i]),this.touches.splice(i,1)),this.runtime.isInUserInputEvent=!1}},c.onTouchMove=function(t){t.preventDefault&&t.preventDefault();var e,i,s,n,r=cr.performance_now();for(e=0,i=t.changedTouches.length;i>e;e++){s=t.changedTouches[e];var o=this.findTouch(s.identifier);if(o>=0){var a=this.runtime.isDomFree?l:jQuery(this.runtime.canvas).offset();if(n=this.touches[o],r-n.time<2)continue;n.update(r,s.pageX-a.left,s.pageY-a.top)}}},c.onTouchStart=function(t){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();{var e=this.runtime.isDomFree?l:jQuery(this.runtime.canvas).offset();cr.performance_now()}this.runtime.isInUserInputEvent=!0;var s,n,r,o;for(s=0,n=t.changedTouches.length;n>s;s++)if(r=t.changedTouches[s],o=this.findTouch(r.identifier),-1===o){var a=r.pageX-e.left,h=r.pageY-e.top;this.trigger_index=this.touches.length,this.trigger_id=r.identifier,this.touches.push(i(a,h,r.identifier,this.trigger_index)),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=a,this.curTouchY=h,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}this.runtime.isInUserInputEvent=!1},c.onTouchEnd=function(t,e){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault(),this.runtime.isInUserInputEvent=!0;var i,n,r,o;for(i=0,n=t.changedTouches.length;n>i;i++)r=t.changedTouches[i],o=this.findTouch(r.identifier),o>=0&&(this.trigger_index=this.touches[o].startindex,this.trigger_id=this.touches[o].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),e||this.touches[o].maybeTriggerTap(this,o),s(this.touches[o]),this.touches.splice(o,1));this.runtime.isInUserInputEvent=!1},c.getAlpha=function(){return this.runtime.isAppMobi&&0===this.orient_alpha&&0!==d?90*d:this.runtime.isPhoneGap&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha},c.getBeta=function(){return this.runtime.isAppMobi&&0===this.orient_beta&&0!==p?-90*p:this.runtime.isPhoneGap&&0===this.orient_beta&&0!==g?-90*g:this.orient_beta},c.getGamma=function(){return this.runtime.isAppMobi&&0===this.orient_gamma&&0!==u?90*u:this.runtime.isPhoneGap&&0===this.orient_gamma&&0!==f?90*f:this.orient_gamma};c.onMouseDown=function(t){t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault();var e={pageX:t.pageX,pageY:t.pageY,identifier:0},i={changedTouches:[e]};this.onTouchStart(i),this.mouseDown=!0},c.onMouseMove=function(t){if(this.mouseDown){var e={pageX:t.pageX,pageY:t.pageY,identifier:0},i={changedTouches:[e]};this.onTouchMove(i)}},c.onMouseUp=function(t){t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault(),this.runtime.had_a_click=!0;var e={pageX:t.pageX,pageY:t.pageY,identifier:0},i={changedTouches:[e]};this.onTouchEnd(i),this.mouseDown=!1},c.tick2=function(){var t,e,i,s=cr.performance_now();for(t=0,e=this.touches.length;e>t;++t)i=this.touches[t],i.time<=s-50&&(i.lasttime=s),i.maybeTriggerHold(this,t)},r.prototype.OnTouchStart=function(){return!0},r.prototype.OnTouchEnd=function(){return!0},r.prototype.IsInTouch=function(){return this.touches.length},r.prototype.OnTouchObject=function(t){return t?this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1):!1};var C=[];r.prototype.IsTouchingObject=function(t){if(!t)return!1;var e,i,s,n,r,o,a=t.getCurrentSol(),h=a.getObjects();for(s=0,n=h.length;n>s;s++){var c=h[s];for(c.update_bbox(),r=0,o=this.touches.length;o>r;r++){var l=this.touches[r];if(e=c.layer.canvasToLayer(l.x,l.y,!0),i=c.layer.canvasToLayer(l.x,l.y,!1),c.contains_pt(e,i)){C.push(c);break}}}return C.length?(a.select_all=!1,cr.shallowAssignArray(a.instances,C),t.applySolToContainer(),C.length=0,!0):!1},r.prototype.CompareTouchSpeed=function(t,e,i){if(t=Math.floor(t),0>t||t>=this.touches.length)return!1;var s=this.touches[t],n=cr.distanceTo(s.x,s.y,s.lastx,s.lasty),r=(s.time-s.lasttime)/1e3,o=0;return r>0&&(o=n/r),cr.do_cmp(o,e,i)},r.prototype.OrientationSupported=function(){return"undefined"!=typeof window.DeviceOrientationEvent},r.prototype.MotionSupported=function(){return"undefined"!=typeof window.DeviceMotionEvent},r.prototype.CompareOrientation=function(t,e,i){var s=0;return s=0===t?this.getAlpha():1===t?this.getBeta():this.getGamma(),cr.do_cmp(s,e,i)},r.prototype.CompareAcceleration=function(t,e,i){var s=0;return 0===t?s=this.acc_g_x:1===t?s=this.acc_g_y:2===t?s=this.acc_g_z:3===t?s=this.acc_x:4===t?s=this.acc_y:5===t&&(s=this.acc_z),cr.do_cmp(s,e,i)},r.prototype.OnNthTouchStart=function(t){return t=Math.floor(t),t===this.trigger_index},r.prototype.OnNthTouchEnd=function(t){return t=Math.floor(t),t===this.trigger_index},r.prototype.HasNthTouch=function(t){return t=Math.floor(t),this.touches.length>=t+1},r.prototype.OnHoldGesture=function(){return!0},r.prototype.OnTapGesture=function(){return!0},r.prototype.OnDoubleTapGesture=function(){return!0},r.prototype.OnHoldGestureObject=function(t){return t?this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1):!1},r.prototype.OnTapGestureObject=function(t){return t?this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1):!1},r.prototype.OnDoubleTapGestureObject=function(t){return t?this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1):!1},a.cnds=new r,o.prototype.TouchCount=function(t){t.set_int(this.touches.length)},o.prototype.X=function(t,e){var i=this.getTouchIndex;if(0>i||i>=this.touches.length)return void t.set_float(0);var s,n,r,o,a;cr.is_undefined(e)?(s=this.runtime.getLayerByNumber(0),n=s.scale,r=s.zoomRate,o=s.parallaxX,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxX=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[i].x,this.touches[i].y,!0)),s.scale=n,s.zoomRate=r,s.parallaxX=o,s.angle=a):(s=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e),t.set_float(s?s.canvasToLayer(this.touches[i].x,this.touches[i].y,!0):0))},o.prototype.XAt=function(t,e,i){if(e=Math.floor(e),0>e||e>=this.touches.length)return void t.set_float(0);var s,n,r,o,a;cr.is_undefined(i)?(s=this.runtime.getLayerByNumber(0),n=s.scale,r=s.zoomRate,o=s.parallaxX,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxX=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)),s.scale=n,s.zoomRate=r,s.parallaxX=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i),t.set_float(s?s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0):0))},o.prototype.XForID=function(t,e,i){var s=this.findTouch(e);if(0>s)return void t.set_float(0);var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(n=this.runtime.getLayerByNumber(0),r=n.scale,o=n.zoomRate,a=n.parallaxX,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxX=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!0)),n.scale=r,n.zoomRate=o,n.parallaxX=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i),t.set_float(n?n.canvasToLayer(c.x,c.y,!0):0))},o.prototype.Y=function(t,e){var i=this.getTouchIndex;if(0>i||i>=this.touches.length)return void t.set_float(0);var s,n,r,o,a;cr.is_undefined(e)?(s=this.runtime.getLayerByNumber(0),n=s.scale,r=s.zoomRate,o=s.parallaxY,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxY=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[i].x,this.touches[i].y,!1)),s.scale=n,s.zoomRate=r,s.parallaxY=o,s.angle=a):(s=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e),t.set_float(s?s.canvasToLayer(this.touches[i].x,this.touches[i].y,!1):0))},o.prototype.YAt=function(t,e,i){if(e=Math.floor(e),0>e||e>=this.touches.length)return void t.set_float(0);var s,n,r,o,a;cr.is_undefined(i)?(s=this.runtime.getLayerByNumber(0),n=s.scale,r=s.zoomRate,o=s.parallaxY,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxY=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)),s.scale=n,s.zoomRate=r,s.parallaxY=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i),t.set_float(s?s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1):0))},o.prototype.YForID=function(t,e,i){var s=this.findTouch(e);if(0>s)return void t.set_float(0);var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(n=this.runtime.getLayerByNumber(0),r=n.scale,o=n.zoomRate,a=n.parallaxY,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxY=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!1)),n.scale=r,n.zoomRate=o,n.parallaxY=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i),t.set_float(n?n.canvasToLayer(c.x,c.y,!1):0))},o.prototype.AbsoluteX=function(t){t.set_float(this.touches.length?this.touches[0].x:0)},o.prototype.AbsoluteXAt=function(t,e){return e=Math.floor(e),0>e||e>=this.touches.length?void t.set_float(0):void t.set_float(this.touches[e].x)},o.prototype.AbsoluteXForID=function(t,e){var i=this.findTouch(e);if(0>i)return void t.set_float(0);var s=this.touches[i];t.set_float(s.x)},o.prototype.AbsoluteY=function(t){t.set_float(this.touches.length?this.touches[0].y:0)},o.prototype.AbsoluteYAt=function(t,e){return e=Math.floor(e),0>e||e>=this.touches.length?void t.set_float(0):void t.set_float(this.touches[e].y)},o.prototype.AbsoluteYForID=function(t,e){var i=this.findTouch(e);if(0>i)return void t.set_float(0);var s=this.touches[i];t.set_float(s.y)},o.prototype.SpeedAt=function(t,e){if(e=Math.floor(e),0>e||e>=this.touches.length)return void t.set_float(0);var i=this.touches[e],s=cr.distanceTo(i.x,i.y,i.lastx,i.lasty),n=(i.time-i.lasttime)/1e3;t.set_float(0===n?0:s/n)},o.prototype.SpeedForID=function(t,e){var i=this.findTouch(e);if(0>i)return void t.set_float(0);var s=this.touches[i],n=cr.distanceTo(s.x,s.y,s.lastx,s.lasty),r=(s.time-s.lasttime)/1e3;t.set_float(0===r?0:n/r)},o.prototype.AngleAt=function(t,e){if(e=Math.floor(e),0>e||e>=this.touches.length)return void t.set_float(0);var i=this.touches[e];t.set_float(cr.to_degrees(cr.angleTo(i.lastx,i.lasty,i.x,i.y)))},o.prototype.AngleForID=function(t,e){var i=this.findTouch(e);if(0>i)return void t.set_float(0);var s=this.touches[i];t.set_float(cr.to_degrees(cr.angleTo(s.lastx,s.lasty,s.x,s.y)))},o.prototype.Alpha=function(t){t.set_float(this.getAlpha())},o.prototype.Beta=function(t){t.set_float(this.getBeta())},o.prototype.Gamma=function(t){t.set_float(this.getGamma())},o.prototype.AccelerationXWithG=function(t){t.set_float(this.acc_g_x)},o.prototype.AccelerationYWithG=function(t){t.set_float(this.acc_g_y)},o.prototype.AccelerationZWithG=function(t){t.set_float(this.acc_g_z)},o.prototype.AccelerationX=function(t){t.set_float(this.acc_x)},o.prototype.AccelerationY=function(t){t.set_float(this.acc_y)},o.prototype.AccelerationZ=function(t){t.set_float(this.acc_z)},o.prototype.TouchIndex=function(t){t.set_int(this.trigger_index)},o.prototype.TouchID=function(t){t.set_float(this.trigger_id)},a.exps=new o}(),cr.behaviors.Bullet=function(t){this.runtime=t},function(){function t(){}function e(){}function i(){}var s=cr.behaviors.Bullet.prototype;s.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var n=s.Type.prototype;n.onCreate=function(){},s.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var r=s.Instance.prototype;r.onCreate=function(){var t=this.properties[0];this.acc=this.properties[1],this.g=this.properties[2],this.bounceOffSolid=0!==this.properties[3],this.setAngle=0!==this.properties[4],this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t,this.lastx=this.inst.x,this.lasty=this.inst.y,this.lastKnownAngle=this.inst.angle,this.travelled=0,this.enabled=0!==this.properties[5]},r.saveToJSON=function(){return{acc:this.acc,g:this.g,dx:this.dx,dy:this.dy,lx:this.lastx,ly:this.lasty,lka:this.lastKnownAngle,t:this.travelled,e:this.enabled}},r.loadFromJSON=function(t){this.acc=t.acc,this.g=t.g,this.dx=t.dx,this.dy=t.dy,this.lastx=t.lx,this.lasty=t.ly,this.lastKnownAngle=t.lka,this.travelled=t.t,this.enabled=t.e},r.tick=function(){if(this.enabled){var t,e,i,s,n=this.runtime.getDt(this.inst);this.inst.angle!==this.lastKnownAngle&&(this.setAngle&&(t=cr.distanceTo(0,0,this.dx,this.dy),this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t),this.lastKnownAngle=this.inst.angle),0!==this.acc&&(t=cr.distanceTo(0,0,this.dx,this.dy),e=0===this.dx&&0===this.dy?this.inst.angle:cr.angleTo(0,0,this.dx,this.dy),t+=this.acc*n,0>t&&(t=0),this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t),0!==this.g&&(this.dy+=this.g*n),this.lastx=this.inst.x,this.lasty=this.inst.y,(0!==this.dx||0!==this.dy)&&(this.inst.x+=this.dx*n,this.inst.y+=this.dy*n,this.travelled+=cr.distanceTo(0,0,this.dx*n,this.dy*n),this.setAngle&&(this.inst.angle=cr.angleTo(0,0,this.dx,this.dy),this.inst.set_bbox_changed(),this.lastKnownAngle=this.inst.angle),this.inst.set_bbox_changed(),this.bounceOffSolid&&(i=this.runtime.testOverlapSolid(this.inst),i&&(this.runtime.registerCollision(this.inst,i),t=cr.distanceTo(0,0,this.dx,this.dy),s=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.dx=Math.cos(s)*t,this.dy=Math.sin(s)*t,this.inst.x+=this.dx*n,this.inst.y+=this.dy*n,this.inst.set_bbox_changed(),this.setAngle&&(this.inst.angle=s,this.lastKnownAngle=s,this.inst.set_bbox_changed()),this.runtime.pushOutSolid(this.inst,this.dx/t,this.dy/t,Math.max(2.5*t*n,30))||this.runtime.pushOutSolidNearest(this.inst,100))))
}},t.prototype.CompareSpeed=function(t,e){return cr.do_cmp(cr.distanceTo(0,0,this.dx,this.dy),t,e)},t.prototype.CompareTravelled=function(t,e){return cr.do_cmp(this.travelled,t,e)},s.cnds=new t,e.prototype.SetSpeed=function(t){var e=cr.angleTo(0,0,this.dx,this.dy);this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t},e.prototype.SetAcceleration=function(t){this.acc=t},e.prototype.SetGravity=function(t){this.g=t},e.prototype.SetAngleOfMotion=function(t){t=cr.to_radians(t);var e=cr.distanceTo(0,0,this.dx,this.dy);this.dx=Math.cos(t)*e,this.dy=Math.sin(t)*e},e.prototype.Bounce=function(t){if(t){var e=t.getFirstPicked(this.inst);if(e){var i=this.runtime.getDt(this.inst),s=cr.distanceTo(0,0,this.dx,this.dy),n=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty,e);this.dx=Math.cos(n)*s,this.dy=Math.sin(n)*s,this.inst.x+=this.dx*i,this.inst.y+=this.dy*i,this.inst.set_bbox_changed(),this.setAngle&&(this.inst.angle=n,this.lastKnownAngle=n,this.inst.set_bbox_changed()),this.bounceOffSolid?this.runtime.pushOutSolid(this.inst,this.dx/s,this.dy/s,Math.max(2.5*s*i,30))||this.runtime.pushOutSolidNearest(this.inst,100):this.runtime.pushOut(this.inst,this.dx/s,this.dy/s,Math.max(2.5*s*i,30),e)}}},e.prototype.SetEnabled=function(t){this.enabled=1===t},s.acts=new e,i.prototype.Speed=function(t){var e=cr.distanceTo(0,0,this.dx,this.dy);e=cr.round6dp(e),t.set_float(e)},i.prototype.Acceleration=function(t){t.set_float(this.acc)},i.prototype.AngleOfMotion=function(t){t.set_float(cr.to_degrees(cr.angleTo(0,0,this.dx,this.dy)))},i.prototype.DistanceTravelled=function(t){t.set_float(this.travelled)},s.exps=new i}(),cr.behaviors.EightDir=function(t){this.runtime=t},function(){function t(){}function e(){}function i(){}var s=cr.behaviors.EightDir.prototype;s.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var n=s.Type.prototype;n.onCreate=function(){},s.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1,this.ignoreInput=!1,this.simup=!1,this.simdown=!1,this.simleft=!1,this.simright=!1,this.lastuptick=-1,this.lastdowntick=-1,this.lastlefttick=-1,this.lastrighttick=-1,this.dx=0,this.dy=0};var r=s.Instance.prototype;r.onCreate=function(){this.maxspeed=this.properties[0],this.acc=this.properties[1],this.dec=this.properties[2],this.directions=this.properties[3],this.angleMode=this.properties[4],this.defaultControls=1===this.properties[5],this.enabled=0!==this.properties[6],this.defaultControls&&!this.runtime.isDomFree&&(jQuery(document).keydown(function(t){return function(e){t.onKeyDown(e)}}(this)),jQuery(document).keyup(function(t){return function(e){t.onKeyUp(e)}}(this)))},r.saveToJSON=function(){return{dx:this.dx,dy:this.dy,enabled:this.enabled,maxspeed:this.maxspeed,acc:this.acc,dec:this.dec,ignoreInput:this.ignoreInput}},r.loadFromJSON=function(t){this.dx=t.dx,this.dy=t.dy,this.enabled=t.enabled,this.maxspeed=t.maxspeed,this.acc=t.acc,this.dec=t.dec,this.ignoreInput=t.ignoreInput,this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1,this.simup=!1,this.simdown=!1,this.simleft=!1,this.simright=!1,this.lastuptick=-1,this.lastdowntick=-1,this.lastlefttick=-1,this.lastrighttick=-1},r.onKeyDown=function(t){var e=this.runtime.tickcount;switch(t.which){case 37:t.preventDefault(),this.lastlefttick<e&&(this.leftkey=!0);break;case 38:t.preventDefault(),this.lastuptick<e&&(this.upkey=!0);break;case 39:t.preventDefault(),this.lastrighttick<e&&(this.rightkey=!0);break;case 40:t.preventDefault(),this.lastdowntick<e&&(this.downkey=!0)}},r.onKeyUp=function(t){var e=this.runtime.tickcount;switch(t.which){case 37:t.preventDefault(),this.leftkey=!1,this.lastlefttick=e;break;case 38:t.preventDefault(),this.upkey=!1,this.lastuptick=e;break;case 39:t.preventDefault(),this.rightkey=!1,this.lastrighttick=e;break;case 40:t.preventDefault(),this.downkey=!1,this.lastdowntick=e}},r.tick=function(){var t=this.runtime.getDt(this.inst),e=this.leftkey||this.simleft,i=this.rightkey||this.simright,s=this.upkey||this.simup,n=this.downkey||this.simdown;if(this.simleft=!1,this.simright=!1,this.simup=!1,this.simdown=!1,this.enabled){var r=this.runtime.testOverlapSolid(this.inst);if(!r||(this.runtime.registerCollision(this.inst,r),this.runtime.pushOutSolidNearest(this.inst))){this.ignoreInput&&(e=!1,i=!1,s=!1,n=!1),0===this.directions?(e=!1,i=!1):1===this.directions&&(s=!1,n=!1),2===this.directions&&(s||n)&&(e=!1,i=!1),e==i&&(this.dx<0?(this.dx+=this.dec*t,this.dx>0&&(this.dx=0)):this.dx>0&&(this.dx-=this.dec*t,this.dx<0&&(this.dx=0))),s==n&&(this.dy<0?(this.dy+=this.dec*t,this.dy>0&&(this.dy=0)):this.dy>0&&(this.dy-=this.dec*t,this.dy<0&&(this.dy=0))),e&&!i&&(this.dx-=this.dx>0?(this.acc+this.dec)*t:this.acc*t),i&&!e&&(this.dx+=this.dx<0?(this.acc+this.dec)*t:this.acc*t),s&&!n&&(this.dy-=this.dy>0?(this.acc+this.dec)*t:this.acc*t),n&&!s&&(this.dy+=this.dy<0?(this.acc+this.dec)*t:this.acc*t);var o,a;if(0!==this.dx||0!==this.dy){var h=Math.sqrt(this.dx*this.dx+this.dy*this.dy);if(h>this.maxspeed){var c=Math.atan2(this.dy,this.dx);this.dx=this.maxspeed*Math.cos(c),this.dy=this.maxspeed*Math.sin(c)}var l=this.inst.x,u=this.inst.y,p=this.inst.angle;this.inst.x+=this.dx*t,this.inst.set_bbox_changed(),r=this.runtime.testOverlapSolid(this.inst),r&&(this.inst.x=l,this.dx=0,this.inst.set_bbox_changed(),this.runtime.registerCollision(this.inst,r)),this.inst.y+=this.dy*t,this.inst.set_bbox_changed(),r=this.runtime.testOverlapSolid(this.inst),r&&(this.inst.y=u,this.dy=0,this.inst.set_bbox_changed(),this.runtime.registerCollision(this.inst,r)),o=cr.round6dp(this.dx),a=cr.round6dp(this.dy),(0!==o||0!==a)&&(1===this.angleMode?this.inst.angle=cr.to_clamped_radians(90*Math.round(cr.to_degrees(Math.atan2(a,o))/90)):2===this.angleMode?this.inst.angle=cr.to_clamped_radians(45*Math.round(cr.to_degrees(Math.atan2(a,o))/45)):3===this.angleMode&&(this.inst.angle=Math.atan2(a,o))),this.inst.set_bbox_changed(),this.inst.angle!=p&&(r=this.runtime.testOverlapSolid(this.inst),r&&(this.inst.angle=p,this.inst.set_bbox_changed(),this.runtime.registerCollision(this.inst,r)))}}}},t.prototype.IsMoving=function(){return 0!==this.dx||0!==this.dy},t.prototype.CompareSpeed=function(t,e){var i=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return cr.do_cmp(i,t,e)},s.cnds=new t,e.prototype.Stop=function(){this.dx=0,this.dy=0},e.prototype.Reverse=function(){this.dx*=-1,this.dy*=-1},e.prototype.SetIgnoreInput=function(t){this.ignoreInput=t},e.prototype.SetSpeed=function(t){0>t&&(t=0),t>this.maxspeed&&(t=this.maxspeed);var e=Math.atan2(this.dy,this.dx);this.dx=t*Math.cos(e),this.dy=t*Math.sin(e)},e.prototype.SetMaxSpeed=function(t){this.maxspeed=t,this.maxspeed<0&&(this.maxspeed=0)},e.prototype.SetAcceleration=function(t){this.acc=t,this.acc<0&&(this.acc=0)},e.prototype.SetDeceleration=function(t){this.dec=t,this.dec<0&&(this.dec=0)},e.prototype.SimulateControl=function(t){switch(t){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simup=!0;break;case 3:this.simdown=!0}},e.prototype.SetEnabled=function(t){this.enabled=1===t},e.prototype.SetVectorX=function(t){this.dx=t},e.prototype.SetVectorY=function(t){this.dy=t},s.acts=new e,i.prototype.Speed=function(t){t.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))},i.prototype.MaxSpeed=function(t){t.set_float(this.maxspeed)},i.prototype.Acceleration=function(t){t.set_float(this.acc)},i.prototype.Deceleration=function(t){t.set_float(this.dec)},i.prototype.MovingAngle=function(t){t.set_float(cr.to_degrees(Math.atan2(this.dy,this.dx)))},i.prototype.VectorX=function(t){t.set_float(this.dx)},i.prototype.VectorY=function(t){t.set_float(this.dy)},s.exps=new i}(),cr.behaviors.Fade=function(t){this.runtime=t},function(){function t(){}function e(){}var i=cr.behaviors.Fade.prototype;i.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var s=i.Type.prototype;s.onCreate=function(){},i.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var n=i.Instance.prototype;n.onCreate=function(){var t=1===this.properties[0];this.fadeInTime=this.properties[1],this.waitTime=this.properties[2],this.fadeOutTime=this.properties[3],this.destroy=this.properties[4],this.stage=t?0:3,this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder,this.maxOpacity=this.inst.opacity?this.inst.opacity:1,t&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))},n.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}},n.loadFromJSON=function(t){this.fadeInTime=t.fit,this.waitTime=t.wt,this.fadeOutTime=t.fot,this.stage=t.s,this.stageTime.reset(),this.stageTime.sum=t.st,this.maxOpacity=t.mo},n.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst)),0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset())),1===this.stage&&this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset()),2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity<0&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),1===this.destroy&&this.runtime.DestroyInstance(this.inst)))},n.doStart=function(){this.stage=0,this.stageTime.reset(),0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)},t.prototype.OnFadeOutEnd=function(){return!0},i.cnds=new t,e.prototype.StartFade=function(){3===this.stage&&this.doStart()},e.prototype.RestartFade=function(){this.doStart()},i.acts=new e}(),cr.behaviors.bound=function(t){this.runtime=t},function(){var t=cr.behaviors.bound.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.mode=0};var i=t.Instance.prototype;i.onCreate=function(){this.mode=this.properties[0]},i.tick=function(){},i.tick2=function(){this.inst.update_bbox();var t=this.inst.bbox,e=this.inst.layer.layout,i=!1;0===this.mode?(this.inst.x<0&&(this.inst.x=0,i=!0),this.inst.y<0&&(this.inst.y=0,i=!0),this.inst.x>e.width&&(this.inst.x=e.width,i=!0),this.inst.y>e.height&&(this.inst.y=e.height,i=!0)):(t.left<0&&(this.inst.x-=t.left,i=!0),t.top<0&&(this.inst.y-=t.top,i=!0),t.right>e.width&&(this.inst.x-=t.right-e.width,i=!0),t.bottom>e.height&&(this.inst.y-=t.bottom-e.height,i=!0)),i&&this.inst.set_bbox_changed()}}(),cr.behaviors.destroy=function(t){this.runtime=t},function(){var t=cr.behaviors.destroy.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var i=t.Instance.prototype;i.onCreate=function(){},i.tick=function(){this.inst.update_bbox();var t=this.inst.bbox,e=this.inst.layer.layout;(t.right<0||t.bottom<0||t.left>e.width||t.top>e.height)&&this.runtime.DestroyInstance(this.inst)}}(),cr.behaviors.solid=function(t){this.runtime=t},function(){function t(){}function e(){}var i=cr.behaviors.solid.prototype;i.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var s=i.Type.prototype;s.onCreate=function(){},i.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var n=i.Instance.prototype;n.onCreate=function(){this.inst.extra.solidEnabled=0!==this.properties[0]},n.tick=function(){},t.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled},i.cnds=new t,e.prototype.SetEnabled=function(t){this.inst.extra.solidEnabled=!!t},i.acts=new e}(),cr.behaviors.wrap=function(t){this.runtime=t},function(){var t=cr.behaviors.wrap.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var i=t.Instance.prototype;i.onCreate=function(){this.mode=this.properties[0]},i.tick=function(){var t=this.inst;t.update_bbox();var e=t.bbox,i=t.layer,s=i.layout,n=0,r=0,o=0,a=0;0===this.mode?(r=s.width,a=s.height):(n=i.viewLeft,r=i.viewRight,o=i.viewTop,a=i.viewBottom),e.right<n?(t.x=r-1+(t.x-e.left),t.set_bbox_changed()):e.left>r?(t.x=n+1-(e.right-t.x),t.set_bbox_changed()):e.bottom<o?(t.y=a-1+(t.y-e.top),t.set_bbox_changed()):e.top>a&&(t.y=o+1-(e.bottom-t.y),t.set_bbox_changed())}}(),cr.getProjectModel=function(){return[null,null,[[cr.plugins_.AJAX,!0,!1,!1,!1,!1,!1,!1,!1,!1],[cr.plugins_.Button,!1,!0,!0,!0,!1,!1,!1,!1,!1],[cr.plugins_.Audio,!0,!1,!1,!1,!1,!1,!1,!1,!1],[cr.plugins_.Browser,!0,!1,!1,!1,!1,!1,!1,!1,!1],[cr.plugins_.Facebook,!0,!1,!1,!1,!1,!1,!1,!1,!1],[cr.plugins_.Touch,!0,!1,!1,!1,!1,!1,!1,!1,!1],[cr.plugins_.Sprite,!1,!0,!0,!0,!0,!0,!0,!0,!1],[cr.plugins_.Text,!1,!0,!0,!0,!0,!0,!0,!0,!1],[cr.plugins_.Spritefont2,!1,!0,!0,!0,!0,!0,!0,!0,!0]],[["t0",cr.plugins_.Sprite,!1,[7079564076989158],2,0,null,[["Default",5,!1,1,0,!1,632856153301667,[["images/goru-sheet0.png",60117,0,0,395,229,1,.501265823841095,.6768559217453003,[["Imagepoint 1",.501265823841095,-.07423580437898636]],[-.001265823841094971,-.6768559217453003,.498734176158905,.3231440782546997,-.501265823841095,.3231440782546997],0]]]],[["BoundToLayout",cr.behaviors.bound,0x747c37abcefd6],["8Direction",cr.behaviors.EightDir,0xf8c9ce7bf0224]],!1,!1,670239979709171,[],null],["t1",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,4982503847138693,[["images/knife-sheet0.png",11801,0,0,180,126,1,.5333333611488342,.5714285969734192,[],[-.4666666686534882,-.4285715818405151,.3999996185302734,-.4285715818405151,.3999996185302734,.2857143878936768,-.4666666686534882,.2857143878936768],0]]]],[["DestroyOutsideLayout",cr.behaviors.destroy,9636228299840312],["Bullet",cr.behaviors.Bullet,0x9ee5d2ee176b1]],!1,!1,0xac16da1095c07,[],null],["t2",cr.plugins_.Touch,!1,[],0,0,null,null,[],!1,!1,8457187686607688,[],null,[1]],["t3",cr.plugins_.Sprite,!1,[6586720252313805],1,0,null,[["Default",5,!1,1,0,!1,9263494895949080,[["images/lungiguy-sheet0.png",30180,0,0,166,124,1,.5,.3467741906642914,[["Imagepoint 1",.5,1.096774220466614]],[.5,.6532257795333862,-.5,.6532257795333862,-.5,-.3467741906642914,.5,-.3467741906642914],0]]]],[["Bullet",cr.behaviors.Bullet,5844627746382091]],!1,!1,627917145628622,[],null],["t4",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,6881374919738825,[["images/enemybullet-sheet0.png",123,0,0,12,5,1,.5,.6000000238418579,[],[.4166669845581055,-.4000000357627869,.4166669845581055,.199999988079071,-.4166666865348816,.199999988079071,-.4166666865348816,-.4000000357627869],0]]]],[["Bullet",cr.behaviors.Bullet,9873502264127064],["DestroyOutsideLayout",cr.behaviors.destroy,8425394522629614]],!1,!1,6343008270770109,[],null],["t5",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,9315775622761128,[],null],["t6",cr.plugins_.Sprite,!1,[],3,0,null,[["Default",5,!1,1,0,!1,9349922387108912,[["images/roadboundary-sheet0.png",196,0,0,411,254,1,.5012165307998657,.5,[],[],1]]]],[["BoundToLayout",cr.behaviors.bound,8873402687778058],["Wrap",cr.behaviors.wrap,7871036802609334],["Solid",cr.behaviors.solid,7210644663069398]],!1,!1,0x948b6562f81b5,[],null],["t7",cr.plugins_.Facebook,!1,[],0,0,null,null,[],!1,!1,7266527615722132,[],null,["317856409206230","40c28bce9f3761871a8e8c3a5575ae6d"]],["t8",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,9173770851894052,[],null],["t9",cr.plugins_.Sprite,!1,[],1,0,null,[["Default",5,!1,1,0,!1,0x5c4fa22c1ec28,[["images/lungiguy2-sheet0.png",30397,0,0,166,124,1,.5,.5,[],[-.3012049794197083,.2338709831237793,-.3734939992427826,0,-.3855420053005219,-.3467739820480347,0,-.4838710129261017,.2530120015144348,-.1693550050258637,.4879519939422607,0,.3012049794197083,.2338709831237793,0,.4274190068244934],0]]]],[["Bullet",cr.behaviors.Bullet,0x7be67944f399e]],!1,!1,0xed6f3bde5f8d1,[],null],["t10",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,5160484795094929,[["images/road-sheet0.png",1169,0,0,1980,380,1,.5,.5,[],[.5,-.5,.5,.5,-.5,.5,-.5,-.5],1]]]],[["Bullet",cr.behaviors.Bullet,7212043794361944],["Wrap",cr.behaviors.wrap,7315162616666496]],!1,!1,0xa65c58d1b5ca1,[],null],["t11",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,5130869190436418,[["images/grass-sheet0.png",473644,0,0,1980,924,1,.5,.5,[],[.5,-.5,.5,.5,-.5,.5,-.5,-.5],1]]]],[["Wrap",cr.behaviors.wrap,7154372689356313],["Bullet",cr.behaviors.Bullet,8560956926506022]],!1,!1,7502399154438271,[],null],["t12",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,8032049765024454,[["images/treeleft-sheet0.png",134643,0,0,346,304,1,.5,.5,[],[.3121389746665955,.2861840128898621,0,.496711015701294,-.3352600038051605,.3125,-.4508671164512634,0,-.3381499946117401,-.3157889842987061,0,-.4769737124443054,.3670520186424255,-.3486840128898621,.4450870156288147,0],0]]]],[["Wrap",cr.behaviors.wrap,0x54ec194577d1e],["Bullet",cr.behaviors.Bullet,5253661448284623]],!1,!1,5327883078030902,[],null],["t13",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,5454027430072205,[["images/treeright-sheet0.png",134904,0,0,346,304,1,.5,.5,[],[-.3121390044689179,-.2861840128898621,0,-.4967105388641357,.3352599740028381,-.3125,.4508669972419739,0,.3381500244140625,.3157889842987061,0,.4769740104675293,-.3670520186424255,.3486840128898621,-.4450866878032684,0],0]]]],[["Wrap",cr.behaviors.wrap,0x508dc7c59a7ce],["Bullet",cr.behaviors.Bullet,0xd6006f3e6b1f2]],!1,!1,0xe8904594f5ab8,[],null],["t14",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,0xc4e2d2ff1d383,[["images/bush-sheet0.png",57094,0,0,181,160,1,.5027624368667603,.5,[],[-.3425414562225342,-.3187499940395355,-.005524426698684692,-.481249988079071,.2486185431480408,-.21875,.4917125701904297,0,.3701655864715576,.356249988079071,-.005524426698684692,.3687499761581421,-.3756904304027557,.356249988079071,-.3867404460906982,0],0]]]],[["Wrap",cr.behaviors.wrap,9613300563190380],["Bullet",cr.behaviors.Bullet,5633759813913023]],!1,!1,0x7ac17f0ecfe55,[],null],["t15",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,0xe45510af26057,[["images/boardleft-sheet0.png",14989,0,0,326,220,1,.5,.5,[],[.1181820034980774,.2423310279846191,0,.2975460290908814,-.4818181991577148,.4877300262451172,-.5,0,-.06363600492477417,-.2055209875106812,0,-.4846630096435547,.3409090042114258,-.3926379978656769,.5,0],0]]]],[["Bullet",cr.behaviors.Bullet,0x851647bba8b9d],["Wrap",cr.behaviors.wrap,7575046627090058]],!1,!1,0x5d0b517be2b3f,[],null],["t16",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,0x7454fd1410c20,[["images/boardright-sheet0.png",14789,0,0,326,220,1,.5,.5,[],[.4818180203437805,.4877300262451172,0,.2975460290908814,-.1181820034980774,.2423310279846191,-.5,0,-.3409090042114258,-.3926379978656769,0,-.4877299964427948,.06363600492477417,-.2055209875106812,.5,0],0]]]],[["Wrap",cr.behaviors.wrap,0x448a2bc237a36],["Bullet",cr.behaviors.Bullet,0xf2964fd182d2f]],!1,!1,388077057830554,[],null],["t17",cr.plugins_.Sprite,!1,[],2,0,null,[["Default",5,!1,1,0,!1,5923486648350804,[["images/sprite-sheet0.png",22108,0,0,214,252,1,.5,.5,[],[-.4719626009464264,-.4761905074119568,0,-.1865079998970032,.05607497692108154,-.1230159997940064,.355139970779419,0,.3644859790802002,.3849210143089294,0,.3968250155448914,-.02336400747299194,.09523797035217285,0,0],0]]]],[["Bullet",cr.behaviors.Bullet,9923947572093892],["DestroyOutsideLayout",cr.behaviors.destroy,6869827235135618]],!1,!1,4539656239303212,[],null],["t18",cr.plugins_.Sprite,!1,[],1,0,null,[["Default",5,!1,1,0,!1,5880468237846598,[["images/sprite2-sheet0.png",7958,0,0,101,118,1,.5049505233764648,.508474588394165,[],[.148514449596405,-.2118645906448364,.2574254870414734,-.008474588394165039,.2277224659919739,.2627114057540894,4.76837158203125e-7,.4745764136314392,-.2871285080909729,.3050844073295593,-.3564355373382568,-.008474588394165039,-.2673265337944031,-.3050845861434937,4.76837158203125e-7,-.3559325933456421],0]]]],[["Fade",cr.behaviors.Fade,0x6f6b6a9a2d735]],!1,!1,0xe5396e0fe3059,[],null],["t19",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,9169661005756378,[],null],["t20",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,5195024066107903,[],null],["t21",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,9480440092401544,[],null],["t22",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,7236032076323375,[],null],["t23",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,699686147520454,[],null],["t24",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,4718964318824709,[],null],["t25",cr.plugins_.AJAX,!1,[],0,0,null,null,[],!1,!1,0x8104d0bf91470,[],null,[]],["t26",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,5840767074322433,[],null],["t27",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,0x3d9da95ffe7a1,[],null],["t28",cr.plugins_.Sprite,!1,[],0,0,null,[["Default",5,!1,1,0,!1,9455392925656776,[["images/sprite3-sheet0.png",712142,0,0,924,1980,1,.5,.5,[],[],1]]]],[],!1,!1,991630394538839,[],null],["t29",cr.plugins_.Spritefont2,!1,[],0,0,["images/spritefont.png",1427,3],null,[],!1,!1,0x644fc0cd08a73,[],null],["t30",cr.plugins_.Sprite,!1,[],0,0,null,[["Default",5,!1,1,0,!1,835653967050566,[["images/sprite4-sheet0.png",9848,0,0,306,111,1,.5,.5045045018196106,[],[-.4117647111415863,-.261261522769928,0,-.4054054021835327,.2189540266990662,.2702705264091492,.01307201385498047,-.009009510278701782,.4738559722900391,.4234234690666199,0,.3873875141143799,-.4313724935054779,.3063064813613892,-.4411765038967133,-.009009510278701782],0]]]],[],!1,!1,4753775838015845,[],null],["t31",cr.plugins_.Sprite,!1,[],0,0,null,[["Default",5,!1,1,0,!1,0x7a690b18a46e7,[["images/sprite5-sheet0.png",62008,0,0,473,1051,1,.5010570883750916,.5004757642745972,[],[-.3957940936088562,-.430596262216568,-.001964092254638672,-.4980661273002625,.4408668875694275,-.4619215726852417,.3682709336280823,-.000475764274597168,.3846049308776856,.4236202239990234,-.001964092254638672,.4910902380943298,-.4302766919136047,.4525362253189087,-.3740150928497315,-.000475764274597168],0]]]],[],!1,!1,5095487319091682,[],null],["t32",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,473478807311298,[],null],["t33",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0xa8c9d60a19e0a,[],null],["t34",cr.plugins_.Sprite,!1,[],0,0,null,[["Default",5,!1,1,0,!1,0xc91097af67ddd,[["images/sprite2-sheet0.png",7958,0,0,101,118,1,.4950495064258575,.508474588394165,[],[-.1386134922504425,.1864404082298279,-.277227520942688,-.008474588394165039,-.1980195045471191,-.2542375922203064,-5.066394805908203e-7,-.3220335841178894,.1881184875965118,-.2372885942459106,.2871284782886505,-.008474588394165039,.1980194747447968,.2288134098052979,-5.066394805908203e-7,.3305084109306335],0]]]],[],!1,!1,5862809562317274,[],null],["t35",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0x52c676944153e,[],null],["t36",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,5969115198444426,[],null],["t37",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,7854065441396718,[],null],["t38",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,7213803658971756,[],null],["t39",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0x735d0997a7e63,[],null],["t40",cr.plugins_.Button,!1,[],0,0,null,null,[],!1,!1,0xff878bafd55a7,[],null],["t41",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0x5cdc88e7b3d39,[],null],["t42",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0x990e1f644a05b,[],null],["t43",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,9454864706719584,[],null],["t44",cr.plugins_.Text,!1,[],0,0,null,null,[],!1,!1,0x71823f41a0d2c,[],null],["t45",cr.plugins_.Sprite,!1,[],0,0,null,[["Default",5,!1,1,0,!1,4557303677358501,[["images/insbg-sheet0.png",155,0,0,250,250,1,.5,.5,[],[],4]]]],[],!1,!1,9427020876103292,[],null],["t46",cr.plugins_.Browser,!1,[],0,0,null,null,[],!1,!1,6844854493217283,[],null,[]],["t47",cr.plugins_.Audio,!1,[],0,0,null,null,[],!1,!1,0xaf8f901064c9c,[],null,[0,0,0,1,1,600,600,1e4,1,5e3,1]]],[],[["Menu Screen",480,640,!1,"Menu Events",5737273360250451,[["Layer 0",0,0x9b78754e4e45d,!0,[255,255,255],!1,1,1,1,!1,1,0,0,[[[238,556,0,492,1130,0,0,1,.5,.5,0,0,[]],28,50,[],[],[0,"Default",0,1]],[[121,431,0,231,24,0,0,1,0,0,0,0,[]],19,41,[],[],[0,"Login With Facebook","",1,1,1,"",0]],[[122,473,0,228,24,0,0,1,0,0,0,0,[]],26,48,[],[],[0,"Play Now","",1,1,1,"",0]],[[123,515,0,227,24,0,0,1,0,0,0,0,[]],27,49,[],[],[0,"Instructions","",1,1,1,"",0]],[[231,225,0,174.4267883300781,387.5740966796875,0,0,1,.5010570883750916,.5004757642745972,0,0,[]],31,52,[],[],[0,"Default",0,1]],[[143.5710906982422,598,0,121,30,0,0,1,0,0,0,0,[]],41,5,[],[],["Made by",0,"10pt MS Sans Serif","rgb(255,255,255)",0,0,0,0,0]],[[212.6918640136719,598,0,200,30,0,0,1,0,0,0,0,[]],42,9,[],[],[" Faisal",0,"bold 10pt MS Sans Serif","rgb(255,255,255)",0,0,0,0,0]]],[]]],[],[]],["Game Screen",480,640,!1,"Game Events",435196737766793,[["Background",0,9357255182246124,!0,[0,0,17],!1,1,1,1,!1,1,0,0,[[[-125.1128997802734,-11,0,78,58,0,1.570796370506287,1,.5,.3467741906642914,0,0,[]],3,0,[[1]],[[60,0,0,0,1,1]],[0,"Default",0,1]]],[]],["Game",1,0xd1f986193501b,!0,[255,255,255],!0,1,1,1,!1,1,0,0,[[[426,100,0,195,156,0,1.570796370506287,1,.5,.5,0,0,[]],11,19,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[428,22,0,128,159,0,1.570796370506287,1,.5,.5,0,0,[]],11,20,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[425,363,0,158,154.7322387695313,0,1.570796370506287,1,.5,.5,0,0,[]],11,21,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[426,263,0,195,156,0,1.570796370506287,1,.5,.5,0,0,[]],11,23,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[425,456,0,158,155.4150390625,0,1.570796370506287,1,.5,.5,0,0,[]],11,25,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[427,604,0,131,157,0,1.570796370506287,1,.5,.5,0,0,[]],11,27,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[427,684,0,131,157,0,1.570796370506287,1,.5,.5,0,0,[]],11,29,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[58,96,0,195,156,0,1.570796370506287,1,.5,.5,0,0,[]],11,24,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[60,18,0,128,159,0,1.570796370506287,1,.5,.5,0,0,[]],11,26,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[57,359,0,158,154.7322387695313,0,1.570796370506287,1,.5,.5,0,0,[]],11,17,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[58,259,0,195,156,0,1.570796370506287,1,.5,.5,0,0,[]],11,18,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[57,452,0,158,155.4150390625,0,1.570796370506287,1,.5,.5,0,0,[]],11,16,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[58.55653381347656,599.614990234375,0,131,157,0,1.570796370506287,1,.5,.5,0,0,[]],11,14,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[59,680,0,131,157,0,1.570796370506287,1,.5,.5,0,0,[]],11,28,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[426,547,0,158,155.4150390625,0,1.570796370506287,1,.5,.5,0,0,[]],11,22,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[58,543,0,158,155.4150390625,0,1.570796370506287,1,.5,.5,0,0,[]],11,15,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[239,-72,0,455,203,0,1.570796370506287,1,.5,.5,0,0,[]],10,13,[],[[40,0,0,0,1,1],[0]],[0,"Default",0,1]],[[239,268,0,455,203,0,1.570796370506287,1,.5,.5,0,0,[]],10,12,[],[[40,0,0,0,1,1],[0]],[0,"Default",0,1]],[[239,703,0,513,203,0,1.570796370506287,1,.5,.5,0,0,[]],10,11,[],[[40,0,0,0,1,1],[0]],[0,"Default",0,1]],[[211.6115875244141,553.521484375,0,117.0000076293945,79.48760223388672,0,-1.570796489715576,1,.501265823841095,.6768559217453003,0,0,[]],0,3,[[1]],[[1],[300,600,500,2,0,1,1]],[0,"Default",0,1]],[[138.6930236816406,314.7330627441406,0,646,13,0,1.570796370506287,1,.5012165307998657,.5,0,0,[]],6,2,[],[[1],[0],[1]],[0,"Default",0,1]],[[346.2746887207031,318.0898132324219,0,654,13,0,1.570796370506287,1,.5012165307998657,.5,0,0,[]],6,7,[],[[1],[0],[1]],[0,"Default",0,1]],[[529,-10,0,80,56,0,1.570796370506287,1,.5,.5,0,0,[]],9,10,[],[[60,0,0,0,1,1]],[0,"Default",0,1]],[[-102.9047546386719,97.88571166992188,0,38,33,0,1.570796370506287,1,.5333333611488342,.5714285969734192,0,0,[]],1,4,[],[[],[200,0,0,0,1,1]],[0,"Default",0,1]],[[44,543,0,83,71,0,1.570796370506287,1,.5,.5,0,0,[]],12,30,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[49,410,0,83,71,0,1.570796370506287,1,.5,.5,0,0,[]],12,31,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[38,40,0,83,71,0,1.570796370506287,1,.5,.5,0,0,[]],12,32,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[442,170,0,79,67,0,1.570796370506287,1,.5,.5,0,0,[]],13,33,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[442,593,0,79,67,0,1.570796370506287,1,.5,.5,0,0,[]],13,34,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[440,249,0,79,67,0,1.570796370506287,1,.5,.5,0,0,[]],13,35,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[48,121,0,62,54,0,1.570796370506287,1,.5027624368667603,.5,0,0,[]],14,36,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[440,86,0,62,54,0,1.570796370506287,1,.5027624368667603,.5,0,0,[]],14,37,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[47.5,258,0,100,70,0,1.570796370506287,1,.5,.5,0,0,[]],15,38,[],[[40,0,0,0,1,1],[0]],[0,"Default",0,1]],[[440,398,0,96,73,0,1.570796370506287,1,.5,.5,0,0,[]],16,39,[],[[0],[40,0,0,0,1,1]],[0,"Default",0,1]],[[-105,175,0,51,51,0,0,1,.5,.5,0,0,[]],17,40,[],[[200,0,0,0,1,1],[]],[0,"Default",0,1]],[[-277,225,0,101,118,0,0,1,.5049505233764648,.508474588394165,0,0,[]],18,1,[],[[1,0,0,1,1]],[0,"Default",0,1]],[[-262,369,0,101,118,0,0,1,.4950495064258575,.508474588394165,0,0,[]],34,58,[],[],[0,"Default",0,1]],[[366,11,0,132,85,0,0,1,0,0,0,0,[]],20,42,[],[],["",0,"bold 18pt MS Sans Serif","rgb(255,255,255)",0,0,0,0,0]]],[]],["UI",2,575587475183491,!0,[255,255,255],!0,0,0,1,!1,1,0,0,[],[]]],[],[]],["Score Screen",480,640,!1,"Score Events",7309387571815577,[["Layer 0",0,0xf123a3d0d991e,!0,[255,255,255],!1,1,1,1,!1,1,0,0,[[[252,502,0,569,1105,0,0,1,.5,.5,0,0,[]],28,57,[],[],[0,"Default",0,1]],[[129,393,0,200,54,0,0,1,0,0,0,0,[]],21,43,[],[],["Score",0,"bold 14pt MS Sans Serif","rgb(255,255,255)",1,0,0,0,0]],[[99,366,0,200,30,0,0,1,0,0,0,0,[]],22,45,[],[],["",0,"12pt Arial","rgb(0,0,0)",0,0,0,0,0]],[[149,260,0,200,30,0,0,1,0,0,0,0,[]],23,44,[],[],["",0,"12pt Arial","rgb(0,0,0)",0,0,0,0,0]],[[141,509,0,183,24,0,0,1,0,0,0,0,[]],24,46,[],[],[0,"Share & Publish","",1,1,1,"",0]],[[232.7339782714844,194.3125,0,154.4571838378906,343.201904296875,0,0,1,.5010570883750916,.5004757642745972,0,0,[]],31,54,[],[],[0,"Default",0,1]],[[143,546,0,180,24,0,0,1,0,0,0,0,[]],32,55,[],[],[0,"Play Again","",1,1,1,"",0]],[[91,441,0,271,53,0,0,1,0,0,0,0,[]],33,56,[],[],["yourid",0,"bold 14pt MS Sans Serif","rgb(255,255,255)",1,0,0,0,0]]],[]]],[],[]],["Instructions Screen",480,640,!1,"Event sheet 1",8691100112028224,[["Layer 0",0,7081165736410745,!0,[255,255,255],!1,1,1,1,!1,1,0,0,[[[244,468,0,569,1105,0,0,1,.5,.5,0,0,[]],28,59,[],[],[0,"Default",0,1]],[[238.6350708007813,107.5572052001953,0,82.92603302001953,184.2605743408203,0,0,1,.5010570883750916,.5004757642745972,0,0,[]],31,60,[],[],[0,"Default",0,1]],[[187,391,0,102,26,0,0,1,0,0,0,0,[]],36,63,[],[],["INSTRUCTION",0,"bold 9pt Segoe UI","rgb(255,255,255)",0,0,0,0,0]],[[150,413,0,178,30,0,0,1,0,0,0,0,[]],37,64,[],[],["Plunge in and run the cow! ",0,"9pt Segoe UI","rgb(255,255,255)",1,0,0,0,0]],[[121,436,0,241,53,0,0,1,0,0,0,0,[]],38,65,[],[],["Dodge the knives, and ropes from wicked butchers and thieves!",0,"9pt Segoe UI","rgb(255,255,255)",1,0,0,0,0]],[[94,476,0,299,120,0,0,1,0,0,0,0,[]],39,66,[],[],["Use controllers, left/right/up/down keys on the keyboard or the mouse cursor to alter directions and take your cow home, safely. ",0,"9pt Segoe UI","rgb(255,255,255)",1,0,0,0,0]],[[114,547,0,255,24,0,0,1,0,0,0,0,[]],40,67,[],[],[0,"Back to Menu","",1,1,1,"",0]],[[41,241,0,402,78,0,0,1,0,0,0,0,[]],35,62,[],[],["Eid, a widely celebrated occasion across the world! On Eid-Ul-Adha we come together and sacrifice animals and thereby carry forth the age old ritual on the eve of Qurbani.",0,"9pt Segoe UI","rgb(255,255,255)",1,0,0,0,0]],[[30,297,0,427,89,0,0,1,0,0,0,0,[]],43,51,[],[],["Qurbani means sacrifice.We're meant to sacrifice in the name of God.Therefore its is crucial for us to have love and affection towards the souls being sacrificed. This Eid , let's show our utmost love and affection to the animals, save them from those don't sacrifice meaningfully. So, hop in and save thy cow!",0,"9pt Segoe UI","rgb(255,255,255)",1,0,0,0,0]],[[208,221,0,60,30,0,0,1,0,0,0,0,[]],44,53,[],[],["STORY",0,"bold 9pt Segoe UI","rgb(255,255,255)",0,0,0,0,0]]],[]]],[],[]]],[["Game Events",[[1,"Score",0,0,!1,!1,0xa2eaae5fe6b13,!1],[0,null,!1,null,8224580648773078,[[2,cr.plugins_.Touch.prototype.cnds.IsInTouch,null,0,!1,!1,!1,7293056260838581,!1],[-1,cr.system_object.prototype.cnds.Compare,null,0,!1,!1,!1,0x590dac7499752,!1,[[7,[19,cr.system_object.prototype.exps.distance,[[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null],[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null],[20,2,cr.plugins_.Touch.prototype.exps.X,!1,null],[20,2,cr.plugins_.Touch.prototype.exps.Y,!1,null]]]],[8,5],[7,[6,[0,300],[19,cr.system_object.prototype.exps.dt]]]]]],[[0,cr.plugins_.Sprite.prototype.acts.MoveAtAngle,null,0x3d0eb1b9747e3,!1,[[0,[19,cr.system_object.prototype.exps.angle,[[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null],[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null],[20,2,cr.plugins_.Touch.prototype.exps.X,!1,null],[20,2,cr.plugins_.Touch.prototype.exps.Y,!1,null]]]],[0,[6,[0,300],[19,cr.system_object.prototype.exps.dt]]]]]]],[0,null,!1,null,6209718591339969,[[-1,cr.system_object.prototype.cnds.Every,null,0,!1,!1,!1,7457015053063365,!1,[[0,[0,2]]]],[-1,cr.system_object.prototype.cnds.PickRandom,null,0,!1,!1,!1,8839401941510974,!1,[[4,3]]],[-1,cr.system_object.prototype.cnds.PickRandom,null,0,!1,!1,!1,4733684177715869,!1,[[4,9]]]],[[3,cr.plugins_.Sprite.prototype.acts.Spawn,null,8810264969616564,!1,[[4,1],[5,[2,"Game"]],[7,[0,1]]]],[1,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,null,0xca5c709c7b413,!1,[[0,[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null]],[0,[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null]]]],[9,cr.plugins_.Sprite.prototype.acts.Spawn,null,6757658156594223,!1,[[4,1],[5,[2,"Game"]],[7,[0,1]]]],[1,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,null,0x7ffb9cb7df59e,!1,[[0,[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null]],[0,[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null]]]]]],[0,null,!1,null,0x98d53790e95fe,[[-1,cr.system_object.prototype.cnds.Every,null,0,!1,!1,!1,0xe2e0e89834830,!1,[[0,[0,5]]]]],[[-1,cr.system_object.prototype.acts.CreateObject,null,0xc3bbf83868183,!1,[[4,3],[5,[2,"Game"]],[0,[0,115]],[0,[0,-20]]]],[-1,cr.system_object.prototype.acts.Wait,null,0xcd1f7e7c5b77f,!1,[[0,[1,2.5]]]],[-1,cr.system_object.prototype.acts.CreateObject,null,5079605703964288,!1,[[4,9],[5,[2,"Game"]],[0,[0,385]],[0,[0,-20]]]]]],[0,null,!1,null,0x587d3816df15f,[[1,cr.plugins_.Sprite.prototype.cnds.OnCollision,null,0,!1,!1,!0,8849642824737158,!1,[[4,0]]]],[[0,cr.plugins_.Sprite.prototype.acts.SubInstanceVar,null,7333080805778596,!1,[[10,0],[7,[0,1]]]],[1,cr.plugins_.Sprite.prototype.acts.Destroy,null,0xb808f2c708672,!1]]],[0,null,!1,null,0x7b5f8c8c83b03,[[3,cr.plugins_.Sprite.prototype.cnds.CompareY,null,0,!1,!1,!1,6632846982733693,!1,[[8,5],[0,[19,cr.system_object.prototype.exps.layoutheight]]]],[3,cr.plugins_.Sprite.prototype.cnds.IsOutsideLayout,null,0,!1,!1,!1,5855441870983216,!1]],[[3,cr.plugins_.Sprite.prototype.acts.Destroy,null,6202097042651134,!1]]],[0,null,!1,null,9925882878100202,[[0,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,null,0,!1,!1,!1,485799337197134,!1,[[10,0],[8,0],[7,[0,0]]]]],[[0,cr.plugins_.Sprite.prototype.acts.Destroy,null,0xba2ce375f6a29,!1],[47,cr.plugins_.Audio.prototype.acts.SetPaused,null,0xcb2f2e4db166b,!1,[[1,[2,"background-music"]],[3,0]]],[47,cr.plugins_.Audio.prototype.acts.Play,null,7676329209373538,!1,[[2,["253886_3169537-lq",!1]],[3,0],[0,[0,0]],[1,[2,"die-cow"]]]],[0,cr.plugins_.Sprite.prototype.acts.Spawn,null,7105819634428161,!1,[[4,18],[5,[2,"Game"]],[7,[0,0]]]],[20,cr.plugins_.Text.prototype.acts.SetText,null,9057828947072940,!1,[[7,[10,[2,"Score\n"],[23,"Score"]]]]],[-1,cr.system_object.prototype.acts.Wait,null,0xdfb6e5a29c123,!1,[[0,[1,1]]]],[18,cr.plugins_.Sprite.prototype.acts.Destroy,null,8494533520479065,!1],[-1,cr.system_object.prototype.acts.Wait,null,6838575078083631,!1,[[0,[1,1]]]],[-1,cr.system_object.prototype.acts.GoToLayout,null,7616133512384711,!1,[[6,"Score Screen"]]]]],[0,null,!1,null,5577198653764447,[[7,cr.plugins_.Facebook.prototype.cnds.OnNameAvailable,null,1,!1,!1,!1,9788472638931708,!1]],[[8,cr.plugins_.Text.prototype.acts.SetText,null,0x7dd9e376669e,!1,[[7,[10,[20,7,cr.plugins_.Facebook.prototype.exps.FullName,!0,null],[2,"currently playing!"]]]]]]],[0,null,!1,null,0xf4c6a46b9462a,[[-1,cr.system_object.prototype.cnds.Every,null,0,!1,!1,!1,4870310794381113,!1,[[0,[1,4.5]]]],[-1,cr.system_object.prototype.cnds.PickRandom,null,0,!1,!1,!1,7914138794516985,!1,[[4,12]]],[-1,cr.system_object.prototype.cnds.PickRandom,null,0,!1,!1,!1,8691511906612724,!1,[[4,13]]]],[[12,cr.plugins_.Sprite.prototype.acts.Spawn,null,8342581277902826,!1,[[4,17],[5,[2,"Game"]],[7,[0,0]]]],[17,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,null,5114739729667902,!1,[[0,[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null]],[0,[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null]]]],[-1,cr.system_object.prototype.acts.Wait,null,9359231935480424,!1,[[0,[1,2.5]]]],[13,cr.plugins_.Sprite.prototype.acts.Spawn,null,0xd769ad7884575,!1,[[4,17],[5,[2,"Game"]],[7,[0,0]]]],[17,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,null,0x79eb27f62165,!1,[[0,[20,0,cr.plugins_.Sprite.prototype.exps.X,!1,null]],[0,[20,0,cr.plugins_.Sprite.prototype.exps.Y,!1,null]]]]]],[0,null,!1,null,0xc4f5f9bc5bad5,[[17,cr.plugins_.Sprite.prototype.cnds.OnCollision,null,0,!1,!1,!0,8902762487176576,!1,[[4,0]]]],[[17,cr.plugins_.Sprite.prototype.acts.Destroy,null,6991904352949766,!1],[0,cr.plugins_.Sprite.prototype.acts.Destroy,null,9239657944125666,!1],[47,cr.plugins_.Audio.prototype.acts.SetPaused,null,0xdd277532b203f,!1,[[1,[2,"background-music"]],[3,0]]],[47,cr.plugins_.Audio.prototype.acts.Play,null,0xd49543d79af,!1,[[2,["253886_3169537-lq",!1]],[3,0],[0,[0,0]],[1,[2,"die-cow"]]]],[0,cr.plugins_.Sprite.prototype.acts.Spawn,null,4867768032612622,!1,[[4,34],[5,[2,"Game"]],[7,[0,0]]]],[20,cr.plugins_.Text.prototype.acts.SetText,null,6570544526150224,!1,[[7,[10,[2,"Score\n"],[23,"Score"]]]]],[-1,cr.system_object.prototype.acts.Wait,null,4662186813394978,!1,[[0,[1,1]]]],[34,cr.plugins_.Sprite.prototype.acts.Destroy,null,0x4775c4b200a17,!1],[-1,cr.system_object.prototype.acts.Wait,null,8300551206102747,!1,[[0,[1,1]]]],[-1,cr.system_object.prototype.acts.GoToLayout,null,5677946766537992,!1,[[6,"Score Screen"]]]]],[0,null,!1,null,5275634910044818,[[-1,cr.system_object.prototype.cnds.Every,null,0,!1,!1,!1,0xbebb2ca81cc65,!1,[[0,[0,1]]]],[0,cr.plugins_.Sprite.prototype.cnds.IsVisible,null,0,!1,!1,!1,6774640618124148,!1]],[[-1,cr.system_object.prototype.acts.AddVar,null,5911327720016138,!1,[[11,"Score"],[7,[0,5]]]],[20,cr.plugins_.Text.prototype.acts.SetText,null,8681848727188809,!1,[[7,[10,[2,"Score\n"],[23,"Score"]]]]]]]]],["Menu Events",[[0,null,!1,null,0x58217a5d21842,[[19,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,5644049088322931,!1]],[[7,cr.plugins_.Facebook.prototype.acts.LogIn,null,0xd06ae13e5de2f,!1,[[3,0],[3,0]]]]],[0,null,!1,null,9087010633105096,[[7,cr.plugins_.Facebook.prototype.cnds.OnLogIn,null,1,!1,!1,!1,7982162627311404,!1]],[[19,cr.plugins_.Button.prototype.acts.Destroy,null,6905466051002338,!1],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,5984853212283737,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,5064428405681186,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,6191483820267363,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[26,cr.plugins_.Button.prototype.acts.SetVisible,null,628572516682424,!1,[[3,1]]]]],[0,null,!1,null,0xb032a9c2da90a,[[-1,cr.system_object.prototype.cnds.OnLayoutStart,null,1,!1,!1,!1,9615386619524824,!1]],[[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,5705442404541926,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0x474ca736a87a4,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,8923455609572451,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,5467832758502647,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xa93585c816da7,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[19,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,8076716048597829,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,749114868256789,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0x51bcca5a69172,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xe28d922a925a6,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,71365541183631,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,5938100597863571,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[27,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0x399c6534d6aeb,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,7351807909463122,!1,[[1,[2,"color"]],[1,[2,"white"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,7341811010507434,!1,[[1,[2,"background"]],[1,[2,"grey"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,639433447237004,!1,[[1,[2,"border-color"]],[1,[2,"grey"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xdd03d259aa827,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,401846168520134,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[26,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,7275503933299476,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]],[26,cr.plugins_.Button.prototype.acts.SetVisible,null,0x7ef34fb118f73,!1,[[3,0]]]]],[0,null,!1,null,6364916565975871,[[26,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,590345888292581,!1],[7,cr.plugins_.Facebook.prototype.cnds.IsLoggedIn,null,0,!1,!1,!1,0x56c6f0ac380af,!1]],[[-1,cr.system_object.prototype.acts.GoToLayout,null,0xbfa583e23fd7b,!1,[[6,"Game Screen"]]]]],[0,null,!1,null,8089874960466921,[[27,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,9091762348865192,!1]],[[-1,cr.system_object.prototype.acts.GoToLayout,null,8072026505361477,!1,[[6,"Instructions Screen"]]]]],[0,null,!1,null,7952326686728328,[[-1,cr.system_object.prototype.cnds.OnLoadFinished,null,1,!1,!1,!1,7391955003944236,!1]],[[47,cr.plugins_.Audio.prototype.acts.Play,null,0xb243c8cdc0e3a,!1,[[2,["funnyfarm30_mo_no1_38",!1]],[3,1],[0,[0,0]],[1,[2,"background-music"]]]]]]]],["Score Events",[[0,null,!1,null,6917801267148826,[[-1,cr.system_object.prototype.cnds.OnLayoutStart,null,1,!1,!1,!1,9864944943689498,!1]],[[21,cr.plugins_.Text.prototype.acts.SetText,null,475168752554287,!1,[[7,[10,[2,"Your Score \n"],[23,"Score"]]]]],[33,cr.plugins_.Text.prototype.acts.SetText,null,9695836320802372,!1,[[7,[10,[2,"Your ID\n"],[20,7,cr.plugins_.Facebook.prototype.exps.UserID,!1,null]]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xeab2fe363bd02,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,8758267000974955,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,907673603959215,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,4630270865356095,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xbccafa5abc19d,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[32,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,810779382724915,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,8633164610450097,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0x8ffff7c2e3a8c,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0x3959ed36bbfab,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xf8d5707842c6a,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,8003059778994424,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[24,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,9305839844272528,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]],[47,cr.plugins_.Audio.prototype.acts.Play,null,7442613150215828,!1,[[2,["funnyfarm30_mo_no1_38",!1]],[3,1],[0,[0,0]],[1,[2,"background-music"]]]]]],[0,null,!1,null,5952480417599966,[[24,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,7739738640576905,!1]],[[25,cr.plugins_.AJAX.prototype.acts.Request,null,0xafd39ddb1679b,!1,[[1,[2,"Posting Score"]],[1,[10,[10,[10,[10,[10,[2,"https://script.google.com/macros/s/AKfycbyYcSZtgotlMK1XwaWSEo6-BNV8UNnBdhURMmqPL3WFchgqUpU/exec?username="],[20,7,cr.plugins_.Facebook.prototype.exps.FullName,!0,null]],[2,"&userid="]],[20,7,cr.plugins_.Facebook.prototype.exps.UserID,!1,null]],[2,"&score="]],[23,"Score"]]]]],[46,cr.plugins_.Browser.prototype.acts.GoToURLWindow,null,0xceec6e166504,!1,[[1,[10,[2,"https://www.facebook.com/sharer/sharer.php?u=http://theruchigame.com/share.php?score="],[23,"Score"]]],[1,[2,"Share Your Score | The Ruchi Game"]]]],[24,cr.plugins_.Button.prototype.acts.Destroy,null,6655846357474629,!1]]],[0,null,!1,null,653518107210092,[[25,cr.plugins_.AJAX.prototype.cnds.OnComplete,null,1,!1,!1,!1,0x617b7f1e2711f,!1,[[1,[2,"On Complete"]]]]],[[24,cr.plugins_.Button.prototype.acts.SetText,null,6345191070662485,!1,[[1,[2,"Done"]]]]]],[0,null,!1,null,0xb69262ffd74cb,[[25,cr.plugins_.AJAX.prototype.cnds.OnError,null,1,!1,!1,!1,0xc42b551d16860,!1,[[1,[2,"On Error"]]]]],[[24,cr.plugins_.Button.prototype.acts.SetText,null,4946962837018258,!1,[[1,[2,"Error"]]]]]],[0,null,!1,null,0xb15b863214c97,[[32,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,0xb1c2705a25259,!1]],[[-1,cr.system_object.prototype.acts.SetVar,null,0xe0171be9438df,!1,[[11,"Score"],[7,[0,0]]]],[-1,cr.system_object.prototype.acts.GoToLayout,null,5404175636102597,!1,[[6,"Game Screen"]]]]]]],["Event sheet 1",[[0,null,!1,null,4949435566484511,[[-1,cr.system_object.prototype.cnds.OnLayoutStart,null,1,!1,!1,!1,4853647068119767,!1]],[[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,786431749475793,!1,[[1,[2,"color"]],[1,[2,"red"]]]],[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,7675745777938721,!1,[[1,[2,"background"]],[1,[2,"white"]]]],[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xd1274c024403f,!1,[[1,[2,"border-color"]],[1,[2,"white"]]]],[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,9946484353568734,!1,[[1,[2,"font-size"]],[1,[2,"17px"]]]],[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xd182720047685,!1,[[1,[2,"border-radius"]],[1,[2,"10px"]]]],[40,cr.plugins_.Button.prototype.acts.SetCSSStyle,null,0xd84a24ca2549b,!1,[[1,[2,"font-weight"]],[1,[2,"bold"]]]]]],[0,null,!1,null,0x4d178123dd748,[[40,cr.plugins_.Button.prototype.cnds.OnClicked,null,1,!1,!1,!1,0x506e7066453fc,!1]],[[-1,cr.system_object.prototype.acts.GoToLayout,null,0xd832764231820,!1,[[6,"Menu Screen"]]]]]]]],[["funnyfarm30_mo_no1_38.ogg",1001112],["253886_3169537-lq.ogg",13547]],"media/",!1,480,640,4,!0,!0,!0,"1.0",!0,!1,0,0,69,!1,!0,1,!0,"New project",[]]
};